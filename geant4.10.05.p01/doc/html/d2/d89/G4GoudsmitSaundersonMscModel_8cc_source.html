<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: source/processes/electromagnetic/standard/src/G4GoudsmitSaundersonMscModel.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_96b5e251a6c7bf545e29a6d690bd16f1.html">processes</a></li><li class="navelem"><a class="el" href="../../dir_898611be2bc563ee90afc74244eb81de.html">electromagnetic</a></li><li class="navelem"><a class="el" href="../../dir_8b252669d9cb3fe49412dfa576c2b42a.html">standard</a></li><li class="navelem"><a class="el" href="../../dir_91adba5f2fdbcdd52281b78ab49076db.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">G4GoudsmitSaundersonMscModel.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// ********************************************************************</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// * License and Disclaimer                                           *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// *                                                                  *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// * The  Geant4 software  is  copyright of the Copyright Holders  of *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// * the Geant4 Collaboration.  It is provided  under  the terms  and *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// * conditions of the Geant4 Software License,  included in the file *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// * LICENSE and available at  http://cern.ch/geant4/license .  These *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// * include a list of copyright holders.                             *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// *                                                                  *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// * Neither the authors of this software system, nor their employing *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// * institutes,nor the agencies providing financial support for this *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// * work  make  any representation or  warranty, express or implied, *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// * regarding  this  software system or assume any liability for its *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// * use.  Please see the license in the file  LICENSE  and URL above *</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// * for the full disclaimer and the limitation of liability.         *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// *                                                                  *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// * This  code  implementation is the result of  the  scientific and *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// * technical work of the GEANT4 collaboration.                      *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// * By using,  copying,  modifying or  distributing the software (or *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// * any work based  on the software)  you  agree  to acknowledge its *</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// * use  in  resulting  scientific  publications,  and indicate your *</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// * acceptance of all terms of the Geant4 Software license.          *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// ********************************************************************</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// ----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// GEANT4 Class implementation file</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// File name:     G4GoudsmitSaundersonMscModel</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// Author:        Mihaly Novak / (Omrane Kadri)</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// Creation date: 20.02.2009</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// Modifications:</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// 04.03.2009 V.Ivanchenko cleanup and format according to Geant4 EM style</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// 12.05.2010 O.Kadri: adding Qn1 and Qn12 as private doubles</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// 18.05.2015 M. Novak provide PRELIMINARY verison of the revised class</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//            This class has been revised and updated, new methods added.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//            A new version of Kawrakow-Bielajew Goudsmit-Saunderson MSC model</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//            based on the screened Rutherford DCS for elastic scattering of</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//            electrons/positrons has been introduced[1,2]. The corresponding MSC</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//            angular distributions over a 2D parameter grid have been recomputed</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//            and the CDFs are now stored in a variable transformed (smooth) form[2,3]</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//            together with the corresponding rational interpolation parameters.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//            These angular distributions are handled by the new</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//            G4GoudsmitSaundersonTable class that is responsible to sample if</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//            it was no, single, few or multiple scattering case and delivers the</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//            angular deflection (i.e. cos(theta) and sin(theta)).</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//            Two screening options are provided:</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//             - if fIsUsePWATotalXsecData=TRUE i.e. SetOptionPWAScreening(TRUE)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//               was called before initialisation: screening parameter value A is</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//               determined such that the first transport coefficient G1(A)</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//               computed according to the screened Rutherford DCS for elastic</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//               scattering will reproduce the one computed from the PWA elastic</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//               and first transport mean free paths[4].</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//             - if fIsUsePWATotalXsecData=FALSE i.e. default value or</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//               SetOptionPWAScreening(FALSE) was called before initialisation:</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//               screening parameter value A is computed according to Moliere&#39;s</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//               formula (by using material dependent parameters \chi_cc2 and b_c</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//               precomputed for each material used at initialization in</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//               G4GoudsmitSaundersonTable) [3]</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//            Elastic and first trasport mean free paths are used consistently.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//            The new version is self-consistent, several times faster, more</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//            robust and accurate compared to the earlier version.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//            Spin effects as well as a more accurate energy loss correction and</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//            computations of Lewis moments will be implemented later on.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">// 02.09.2015 M. Novak: first version of new step limit is provided.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//            fUseSafetyPlus corresponds to Urban fUseSafety (default)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//            fUseDistanceToBoundary corresponds to Urban fUseDistanceToBoundary</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//            fUseSafety  corresponds to EGSnrc error-free stepping algorithm</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">//            Range factor can be significantly higher at each case than in Urban.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">// 23.08.2017 M. Novak: added corrections to account spin effects (Mott-correction).</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//            It can be activated by setting the fIsMottCorrection flag to be true</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//            before initialization using the SetOptionMottCorrection() public method.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//            The fMottCorrection member is responsible to handle pre-computed Mott</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//            correction (rejection) functions obtained by numerically computing</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">//            Goudsmit-Saunderson agnular distributions based on a DCS accounting spin</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//            effects and screening corrections. The DCS used to compute the accurate</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">//            GS angular distributions is: DCS_{cor} = DCS_{SR}x[ DCS_{R}/DCS_{Mott}] where :</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//               # DCS_{SR} is the relativistic Screened-Rutherford DCS (first Born approximate</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//                 solution of the Klein-Gordon i.e. relativistic Schrodinger equation =&gt;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//                 scattering of spinless e- on exponentially screened Coulomb potential)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">//                 note: the default (without using Mott-correction) GS angular distributions</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//                 are based on this DCS_{SR} with Moliere&#39;s screening parameter!</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">//               # DCS_{R} is the Rutherford DCS which is the same as above but without</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">//                 screening</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">//               # DCS_{Mott} is the Mott DCS i.e. solution of the Dirac equation with a bare</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">//                 Coulomb potential i.e. scattering of particles with spin (e- or e+) on a</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">//                 point-like unscreened Coulomb potential</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">//               # moreover, the screening parameter of the DCS_{cor} was determined such that</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//                 the DCS_{cor} with this corrected screening parameter reproduce the first</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">//                 transport cross sections obtained from the corresponding most accurate DCS</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//                 (i.e. from elsepa [4])</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">//            Unlike the default GS, the Mott-corrected angular distributions are particle type</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">//            (different for e- and e+ &lt;= the DCS_{Mott} and the screening correction) and target</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">//            (Z and material) dependent.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// 27.10.2017 M. Novak:</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//            - Mott-correction flag is set now through the G4EmParameters</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//            - new form of PWA correction to integrated quantities and screening (default)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//            - changed step limit flag conventions:</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//               # fUseSafety corresponds to Urban&#39;s fUseSafety</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//               # fUseDistanceToBoundary corresponds to Urban&#39;s fUseDistanceToBoundary</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//               # fUseSafetyPlus corresponds to the error-free stepping algorithm</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// 02.02.2018 M. Novak: implemented CrossSectionPerVolume interface method (used only for testing)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">// Class description:</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//   Kawrakow-Bielajew Goudsmit-Saunderson MSC model based on the screened Rutherford DCS</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//   for elastic scattering of e-/e+. Option, to include (Mott) correction (see above), is</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//   also available now (SetOptionMottCorrection(true)). An EGSnrc like error-free stepping</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//   algorithm (UseSafety) is available beyond the usual Geant4 step limitation algorithms</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">//   and true to geomerty and geometry to true step length computations that were adopted</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">//   from the Urban model[5]. The most accurate setting: error-free stepping i.e. the</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">//   UseSafetyPlus MSC step limit with Mott-correction (SetOptionMottCorrection(true)). Both</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">//   are expected to be set through the G4EmParameters singleton before initialisation:</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">//    # G4EmParameters::Instance()-&gt;SetMscStepLimitType(fUseSafetyPlus);</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">//    # G4EmParameters::Instance()-&gt;SetUseMottCorrection(true);</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// References:</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">//   [1] A.F.Bielajew, NIMB 111 (1996) 195-208</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//   [2] I.Kawrakow, A.F.Bielajew, NIMB 134(1998) 325-336</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//   [3] I.Kawrakow, E.Mainegra-Hing, D.W.O.Rogers, F.Tessier,B.R.B.Walters, NRCC</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">//       Report PIRS-701 (2013)</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">//   [4] F.Salvat, A.Jablonski, C.J. Powell, CPC 165(2005) 157-190</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">//   [5] L.Urban, Preprint CERN-OPEN-2006-077 (2006)</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">// -----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh.html">G4GoudsmitSaundersonMscModel.hh</a>&quot;</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh.html">G4GoudsmitSaundersonTable.hh</a>&quot;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dd0/G4GSPWACorrections_8hh.html">G4GSPWACorrections.hh</a>&quot;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d2b/G4PhysicalConstants_8hh.html">G4PhysicalConstants.hh</a>&quot;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d91/G4SystemOfUnits_8hh.html">G4SystemOfUnits.hh</a>&quot;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d63/G4ParticleChangeForMSC_8hh.html">G4ParticleChangeForMSC.hh</a>&quot;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/dab/G4DynamicParticle_8hh.html">G4DynamicParticle.hh</a>&quot;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d69/G4Electron_8hh.html">G4Electron.hh</a>&quot;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d5f/G4Positron_8hh.html">G4Positron.hh</a>&quot;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d97/G4LossTableManager_8hh.html">G4LossTableManager.hh</a>&quot;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d30/G4EmParameters_8hh.html">G4EmParameters.hh</a>&quot;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d83/G4Track_8hh.html">G4Track.hh</a>&quot;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4b/G4PhysicsTable_8hh.html">G4PhysicsTable.hh</a>&quot;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/de9/Randomize_8hh.html">Randomize.hh</a>&quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dfe/G4Log_8hh.html">G4Log.hh</a>&quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/dcc/G4Exp_8hh.html">G4Exp.hh</a>&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/db6/G4Pow_8hh.html">G4Pow.hh</a>&quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">// set accurate energy loss and dispalcement sampling to be always on now</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#adc66322b5328e4c3ed3038bc9f19f6f1">G4bool</a> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7da3cc8c1e26a662323f1b0ef823809c">G4GoudsmitSaundersonMscModel::gIsUseAccurate</a>    = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">// set the usual optimization to be always active now</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#adc66322b5328e4c3ed3038bc9f19f6f1">G4bool</a> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae4132d7075d870497622b7029bcd8d78">G4GoudsmitSaundersonMscModel::gIsOptimizationOn</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3df868431631edc329befeb06c443d4c">  163</a></span>&#160;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3df868431631edc329befeb06c443d4c">G4GoudsmitSaundersonMscModel::G4GoudsmitSaundersonMscModel</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d72/classG4String.html">G4String</a>&amp; nam)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  : <a class="code" href="../../d0/d99/classG4VMscModel.html">G4VMscModel</a>(nam) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae5a41d2d61e6f24460c3d691a2ed4886">charge</a>                 = 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac65577da8ca624dfeea91faeb501f0df">currentMaterialIndex</a>   = -1;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a031d7e2fbc91141c08b57a5f232b6e1b">lambdalimit</a>            = 1.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#a95b12ad94a86320bdf0a38c3e67ad604">mm</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa8f39452436597a0358d6d5a22b411b8">fr</a>                     = 0.1;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a>              = 1.e+21;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">geombig</a>                = 1.e+50*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#a95b12ad94a86320bdf0a38c3e67ad604">mm</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>              = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">geombig</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3e5b9a35af1ce864f7d36c232da71256">tgeom</a>                  = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">geombig</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a>                 = 1.e+10*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#a95b12ad94a86320bdf0a38c3e67ad604">mm</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>              = 0.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#a95b12ad94a86320bdf0a38c3e67ad604">mm</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">particle</a>               = 0;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af988cae764d49c9d98b8e9695a0e8d55">theManager</a>             = <a class="code" href="../../d9/d78/classG4LossTableManager.html#a2f26d6edfd1d62ac3a714ac9f6bd6b9c">G4LossTableManager::Instance</a>();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a>              = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>       = 0.0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>           = 0.0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa5a764c9fe2cecfa79939f956ef84c25">tlimitminfix2</a>          = 1.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#a60e2c8909c5361ab2436856d3d7d9f7e">nm</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7c2ba8f29691d5a7471e0f71fa41c657">tausmall</a>               = 1.e-16;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad77ba4a828bd1aeaa2c0e4358c55e88d">mass</a>                   = electron_mass_c2;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a1778149540068158b10e85a557342de2">taulim</a>                 = 1.e-6;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="../../d0/d99/classG4VMscModel.html#ad6a9fc1399bdc67fce0bf84a7ab60c91">facsafety</a>              = 0.6;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>          = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b542be7cec7d369810ebfca6b1255a9">fParticleChange</a>        = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b929b4a540635e9a850a1f330a70dfa">fZeff</a>                  = 1.;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>                   = 0.;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aff7737c4ceee8f5f193301fcaf396a11">par2</a>                   = 0.;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>                   = 0.;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// Moliere screeing parameter will be used and (by default) corrections are</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// appalied to the integrated quantities (screeing parameter, elastic mfp, first</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// and second moments) derived from the corresponding PWA quantities</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="comment">// this PWA correction is ignored if Mott-correction is set to true because</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// Mott-correction contains all these corrections as well</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a>    = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a>   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>               = 0.0; <span class="comment">// elastic mean free path</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>               = 0.0; <span class="comment">// first transport mean free path</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>                  = 0.0; <span class="comment">// screening parameter</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>                    = 0.0; <span class="comment">// first transport coef.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>              = 1.0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>                = 1.0;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>           = 1.0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>     = 0.;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af9f313ceedd3b3013723cc8a3e70cd08">fTheTransportDistance</a>  = 0.;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>        = 0.;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>.set(0.,0.,0.);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.set(0.,0.,1.);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">fIsSingleScattering</a>    = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a102ee0534dcf08f34ce0ef39d70c7f25">fIsEndedUpOnBoundary</a>   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">fIsNoScatteringInMSC</a>   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">fIsNoDisplace</a>          = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d10da21d2b8dc11665428a0fd55a4cc">fIsInsideSkin</a>          = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e28f34faea2aba8c2c9cf964ad5dba4">fIsWasOnBoundary</a>       = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a272359d551edaf0eee77e485607af8ad">fIsFirstRealStep</a>       = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a600e9b362c8f5e4925a5ef7c93691522">rndmEngineMod</a>          = G4Random::getTheEngine();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>               = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>         = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae8bfe11ee7e3e1eb5d2d80dcae5c6834">  240</a></span>&#160;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae8bfe11ee7e3e1eb5d2d80dcae5c6834">G4GoudsmitSaundersonMscModel::~G4GoudsmitSaundersonMscModel</a>() {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/dc1/classG4VEmModel.html#a451a8533c04280ef903052c654328902">IsMaster</a>()) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a64c8133d1fc62dc58148c163622d4123">  254</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a64c8133d1fc62dc58148c163622d4123">G4GoudsmitSaundersonMscModel::Initialise</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d38/classG4ParticleDefinition.html">G4ParticleDefinition</a>* p, <span class="keyword">const</span> <a class="code" href="../../de/d4e/classG4DataVector.html">G4DataVector</a>&amp;) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a65d86facbe89c41743f891b216b82d90">SetParticle</a>(p);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// -create GoudsmitSaundersonTable and init its Mott-correction member if</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">//  Mott-correction was required</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/dc1/classG4VEmModel.html#a451a8533c04280ef903052c654328902">IsMaster</a>()) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// get the Mott-correction flag from EmParameters</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/d54/classG4EmParameters.html#a1d95771d48a26806a1bc223eec74367c">G4EmParameters::Instance</a>()-&gt;UseMottCorrection()) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// Mott-correction includes other way of PWA x-section corrections so deactivate it even if it was true</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// when Mott-correction is activated by the user</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// clear GS-table</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// clear PWA corrections table if any</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// create GS-table</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="../../de/d29/G4Types_8hh.html#adc66322b5328e4c3ed3038bc9f19f6f1">G4bool</a> <a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a6e517fd44afc752751635505062dea27">isElectron</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (p-&gt;<a class="code" href="../../d5/d38/classG4ParticleDefinition.html#a803f7e0537bd1c3baa8a4c3ddb69c7f5">GetPDGCharge</a>()&gt;0.) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a6e517fd44afc752751635505062dea27">isElectron</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a> = <span class="keyword">new</span> <a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html">G4GoudsmitSaundersonTable</a>(<a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a6e517fd44afc752751635505062dea27">isElectron</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// G4GSTable will be initialised:</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// - Screened-Rutherford DCS based GS angular distributions will be loaded only if they are not there yet</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// - Mott-correction will be initialised if Mott-correction was requested to be used</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#af6cfcd49f2934ffb38e35bf8c15da7d0">SetOptionMottCorrection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// - set PWA correction (correction to integrated quantites from Dirac-PWA)</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a6125bcf1649e2efd57b5a70b6acce545">SetOptionPWACorrection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// init</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#aa7cced1d3f2f63626f2c1af963e06863">Initialise</a>(<a class="code" href="../../d3/dc1/classG4VEmModel.html#a35474c08f31b0e8d40fcb95b22068236">LowEnergyLimit</a>(),<a class="code" href="../../d3/dc1/classG4VEmModel.html#a76749999644bdee227e1c27db9e823d1">HighEnergyLimit</a>());</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// create PWA corrections table if it was requested (and not disactivated because active Mott-correction)</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a>) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a> = <span class="keyword">new</span> <a class="code" href="../../dd/d45/classG4GSPWACorrections.html">G4GSPWACorrections</a>(<a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a6e517fd44afc752751635505062dea27">isElectron</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>-&gt;<a class="code" href="../../dd/d45/classG4GSPWACorrections.html#abe44b021c1f92046e76261da4ea56e4d">Initialise</a>();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b542be7cec7d369810ebfca6b1255a9">fParticleChange</a> = <a class="code" href="../../d0/d99/classG4VMscModel.html#a46dc2095f99aa583d34e0609a8223d4b">GetParticleChangeForMSC</a>(p);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acbf3eb70119f07e5b7d9fa045667965c">  302</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acbf3eb70119f07e5b7d9fa045667965c">G4GoudsmitSaundersonMscModel::InitialiseLocal</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d38/classG4ParticleDefinition.html">G4ParticleDefinition</a>*, <a class="code" href="../../d3/dc1/classG4VEmModel.html">G4VEmModel</a>* masterModel) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>               = static_cast&lt;G4GoudsmitSaundersonMscModel*&gt;(masterModel)-&gt;GetGSTable();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a>   = static_cast&lt;G4GoudsmitSaundersonMscModel*&gt;(masterModel)-&gt;GetOptionMottCorrection();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a>    = static_cast&lt;G4GoudsmitSaundersonMscModel*&gt;(masterModel)-&gt;GetOptionPWACorrection();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>         = static_cast&lt;G4GoudsmitSaundersonMscModel*&gt;(masterModel)-&gt;GetPWACorrection();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">// computes macroscopic first transport cross section: used only in testing not during mc transport</span></div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa87c45a31c3edb131304ca710f1f39b7">  311</a></span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa87c45a31c3edb131304ca710f1f39b7">G4GoudsmitSaundersonMscModel::CrossSectionPerVolume</a>(<span class="keyword">const</span> <a class="code" href="../../d5/de4/classG4Material.html">G4Material</a>* mat,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="../../d5/d38/classG4ParticleDefinition.html">G4ParticleDefinition</a>*,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                         <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> kineticEnergy,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                         <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a>,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                         <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a>) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> xsecTr1  = 0.; <span class="comment">// cross section per volume i.e. macroscopic 1st transport cross section</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> efEnergy = kineticEnergy;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a> = 0.0; <span class="comment">// elastic mean free path</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a> = 0.0; <span class="comment">// first transport mean free path</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>    = 0.0; <span class="comment">// screening parameter</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>      = 0.0; <span class="comment">// first transport coef.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// use Moliere&#39;s screening (with Mott-corretion if it was requested)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span>  (efEnergy&lt;10.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#aa515e5d787460f9c978a23bd22140482">CLHEP::eV</a>) efEnergy = 10.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#aa515e5d787460f9c978a23bd22140482">CLHEP::eV</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">// total mometum square</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> pt2     = efEnergy*(efEnergy+2.0*electron_mass_c2);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// beta square</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> beta2   = pt2/(pt2+electron_mass_c2*electron_mass_c2);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// current material index</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#abe302bce7537dc7036cb11d827505004">G4int</a>    matindx = mat-&gt;<a class="code" href="../../d5/de4/classG4Material.html#ad50823f82efe0e1798ac4e34d6829828">GetIndex</a>();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// Moliere&#39;s b_c</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> bc      = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a6e98e87f5d6a109938468f2830e93431">GetMoliereBc</a>(matindx);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// get the Mott-correcton factors if Mott-correcton was requested by the user</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>       = 1.0;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>         = 1.0;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>    = 1.0;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> scpCor = 1.0;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a>) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a276fd7be0fe9c6517eb395d6418e13d0">GetMottCorrectionFactors</a>(<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(efEnergy), beta2, matindx, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// ! no scattering power correction since the current couple is not set before this interface method is called</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// scpCor = fGSTable-&gt;ComputeScatteringPowerCorrection(currentCouple, efEnergy);</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a>) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>-&gt;<a class="code" href="../../dd/d45/classG4GSPWACorrections.html#adb8b21defb84149a64fa08a2aa7a9255">GetPWACorrectionFactors</a>(<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(efEnergy), beta2, matindx, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// scpCor = fGSTable-&gt;ComputeScatteringPowerCorrection(currentCouple, efEnergy);</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">// screening parameter:</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// - if Mott-corretioncorrection: the Screened-Rutherford times Mott-corretion DCS with this</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">//   screening parameter gives back the (elsepa) PWA first transport cross section</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// - if PWA correction: he Screened-Rutherford DCS with this screening parameter</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">//   gives back the (elsepa) PWA first transport cross section</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>    = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#adf07a51e4ad0b2b98777b1632d8bbbef">GetMoliereXc2</a>(matindx)/(4.0*pt2*bc)*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">// elastic mean free path in Geant4 internal lenght units: the neglected (1+screening parameter) term is corrected</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// (if Mott-corretion: the corrected screening parameter is used for this (1+A) correction + Moliere b_c is also</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// corrected with the screening parameter correction)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a> = beta2*(1.+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>/bc/scpCor;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// first transport coefficient (if Mott-corretion: the corrected screening parameter is used (it will be fully</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// consistent with the one used during the pre-computation of the Mott-correted GS angular distributions))</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>      = 2.0*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>*((1.0+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)*<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(1.0/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>+1.0)-1.0);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// first transport mean free path</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  xsecTr1  = 1./<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">return</span> xsecTr1;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">// gives back the first transport mean free path in internal G4 units</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a></div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac89f6edb92868d772811035e07d49a3c">  368</a></span>&#160;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac89f6edb92868d772811035e07d49a3c">G4GoudsmitSaundersonMscModel::GetTransportMeanFreePath</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d38/classG4ParticleDefinition.html">G4ParticleDefinition</a>* <span class="comment">/*partdef*/</span>,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                                       <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> kineticEnergy) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">// kinetic energy is assumed to be in Geant4 internal energy unit which is MeV</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> efEnergy = kineticEnergy;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d5/de4/classG4Material.html">G4Material</a>*  mat = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>-&gt;<a class="code" href="../../d9/dc9/classG4MaterialCutsCouple.html#a46a21e5876859b24c702d7bd61aa8723">GetMaterial</a>();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a> = 0.0; <span class="comment">// elastic mean free path</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a> = 0.0; <span class="comment">// first transport mean free path</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>    = 0.0; <span class="comment">// screening parameter</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>      = 0.0; <span class="comment">// first transport coef.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">// use Moliere&#39;s screening (with Mott-corretion if it was requested)</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">if</span>  (efEnergy&lt;10.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#aa515e5d787460f9c978a23bd22140482">CLHEP::eV</a>) efEnergy = 10.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#aa515e5d787460f9c978a23bd22140482">CLHEP::eV</a>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">// total mometum square</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> pt2     = efEnergy*(efEnergy+2.0*electron_mass_c2);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="comment">// beta square</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> beta2   = pt2/(pt2+electron_mass_c2*electron_mass_c2);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// current material index</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#abe302bce7537dc7036cb11d827505004">G4int</a>    matindx = mat-&gt;<a class="code" href="../../d5/de4/classG4Material.html#ad50823f82efe0e1798ac4e34d6829828">GetIndex</a>();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// Moliere&#39;s b_c</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> bc      = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a6e98e87f5d6a109938468f2830e93431">GetMoliereBc</a>(matindx);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// get the Mott-correcton factors if Mott-correcton was requested by the user</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>       = 1.0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>         = 1.0;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>    = 1.0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> scpCor = 1.0;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a>) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a276fd7be0fe9c6517eb395d6418e13d0">GetMottCorrectionFactors</a>(<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(efEnergy), beta2, matindx, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    scpCor = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a254f0b3dbe00ed848487074e6c656c63">ComputeScatteringPowerCorrection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>, efEnergy);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a>) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>-&gt;<a class="code" href="../../dd/d45/classG4GSPWACorrections.html#adb8b21defb84149a64fa08a2aa7a9255">GetPWACorrectionFactors</a>(<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(efEnergy), beta2, matindx, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// scpCor = fGSTable-&gt;ComputeScatteringPowerCorrection(currentCouple, efEnergy);</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// screening parameter:</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// - if Mott-corretioncorrection: the Screened-Rutherford times Mott-corretion DCS with this</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">//   screening parameter gives back the (elsepa) PWA first transport cross section</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// - if PWA correction: he Screened-Rutherford DCS with this screening parameter</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">//   gives back the (elsepa) PWA first transport cross section</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>    = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#adf07a51e4ad0b2b98777b1632d8bbbef">GetMoliereXc2</a>(matindx)/(4.0*pt2*bc)*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// elastic mean free path in Geant4 internal lenght units: the neglected (1+screening parameter) term is corrected</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// (if Mott-corretion: the corrected screening parameter is used for this (1+A) correction + Moliere b_c is also</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// corrected with the screening parameter correction)</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a> = beta2*(1.+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">fMCtoScrA</a>/bc/scpCor;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// first transport coefficient (if Mott-corretion: the corrected screening parameter is used (it will be fully</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// consistent with the one used during the pre-computation of the Mott-correted GS angular distributions))</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>      = 2.0*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>*((1.0+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)*<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(1.0/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>+1.0)-1.0);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// first transport mean free path</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;}</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a></div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7ebf1fa9cf19d4b0416b2b4ca7421d59">  423</a></span>&#160;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7ebf1fa9cf19d4b0416b2b4ca7421d59">G4GoudsmitSaundersonMscModel::GetTransportMeanFreePathOnly</a>(<span class="keyword">const</span> <a class="code" href="../../d5/d38/classG4ParticleDefinition.html">G4ParticleDefinition</a>* <span class="comment">/*partdef*/</span>,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                                       <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> kineticEnergy) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// kinetic energy is assumed to be in Geant4 internal energy unit which is MeV</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> efEnergy = kineticEnergy;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d5/de4/classG4Material.html">G4Material</a>*  mat = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>-&gt;<a class="code" href="../../d9/dc9/classG4MaterialCutsCouple.html#a46a21e5876859b24c702d7bd61aa8723">GetMaterial</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> lambda0 = 0.0; <span class="comment">// elastc mean free path</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> lambda1 = 0.0; <span class="comment">// first transport mean free path</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> scrA    = 0.0; <span class="comment">// screening parametr</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> g1      = 0.0; <span class="comment">// first transport mean free path</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// use Moliere&#39;s screening (with Mott-corretion if it was requested)</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">if</span>  (efEnergy&lt;10.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#aa515e5d787460f9c978a23bd22140482">CLHEP::eV</a>) efEnergy = 10.*<a class="code" href="../../d8/df2/G4SIunits_8hh.html#aa515e5d787460f9c978a23bd22140482">CLHEP::eV</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// total mometum square in Geant4 internal energy2 units which is MeV2</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> pt2     = efEnergy*(efEnergy+2.0*electron_mass_c2);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> beta2   = pt2/(pt2+electron_mass_c2*electron_mass_c2);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#abe302bce7537dc7036cb11d827505004">G4int</a>    matindx = mat-&gt;<a class="code" href="../../d5/de4/classG4Material.html#ad50823f82efe0e1798ac4e34d6829828">GetIndex</a>();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> bc      = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a6e98e87f5d6a109938468f2830e93431">GetMoliereBc</a>(matindx);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// get the Mott-correcton factors if Mott-correcton was requested by the user</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> mctoScrA    = 1.0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> mctoQ1      = 1.0;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> mctoG2PerG1 = 1.0;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> scpCor      = 1.0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">fIsUseMottCorrection</a>) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a276fd7be0fe9c6517eb395d6418e13d0">GetMottCorrectionFactors</a>(<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(efEnergy), beta2, matindx, mctoScrA, mctoQ1, mctoG2PerG1);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    scpCor = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a254f0b3dbe00ed848487074e6c656c63">ComputeScatteringPowerCorrection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>, efEnergy);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">fIsUsePWACorrection</a>) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">fPWACorrection</a>-&gt;<a class="code" href="../../dd/d45/classG4GSPWACorrections.html#adb8b21defb84149a64fa08a2aa7a9255">GetPWACorrectionFactors</a>(<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(efEnergy), beta2, matindx, mctoScrA, mctoQ1, mctoG2PerG1);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// scpCor = fGSTable-&gt;ComputeScatteringPowerCorrection(currentCouple, efEnergy);</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  scrA    = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#adf07a51e4ad0b2b98777b1632d8bbbef">GetMoliereXc2</a>(matindx)/(4.0*pt2*bc)*mctoScrA;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// total elastic mean free path in Geant4 internal lenght units</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  lambda0 = beta2*(1.+scrA)*mctoScrA/bc/scpCor;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  g1      = 2.0*scrA*((1.0+scrA)*<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(1.0/scrA+1.0)-1.0);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  lambda1 = lambda0/g1;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="keywordflow">return</span> lambda1;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5cc6974c7e1e888a5b06a1396f5ed696">  464</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5cc6974c7e1e888a5b06a1396f5ed696">G4GoudsmitSaundersonMscModel::StartTracking</a>(<a class="code" href="../../d1/d33/classG4Track.html">G4Track</a>* track) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a65d86facbe89c41743f891b216b82d90">SetParticle</a>(track-&gt;<a class="code" href="../../d1/d33/classG4Track.html#a07133cbb02b55a84c77ceed42ad387c6">GetDynamicParticle</a>()-&gt;<a class="code" href="../../d7/d5c/classG4DynamicParticle.html#a43d8d4d455904da067b031e60f46c220">GetDefinition</a>());</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a>    = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3e5b9a35af1ce864f7d36c232da71256">tgeom</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">geombig</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a> = 1.e+21;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0de90a47374946419b4f1d4d37521b3c">  472</a></span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0de90a47374946419b4f1d4d37521b3c">G4GoudsmitSaundersonMscModel::ComputeTruePathLengthLimit</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d33/classG4Track.html">G4Track</a>&amp; track,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                                                                    <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a>&amp; currentMinimalStep) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> skindepth = 0.;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d7/d5c/classG4DynamicParticle.html">G4DynamicParticle</a>* dp = track.<a class="code" href="../../d1/d33/classG4Track.html#a07133cbb02b55a84c77ceed42ad387c6">GetDynamicParticle</a>();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="../../df/d47/classG4StepPoint.html">G4StepPoint</a>* <a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a5712b6fd75643c96893b8ccba2c866bea9ccbad167e57928ae157f0033c2f44bc">sp</a>             = track.<a class="code" href="../../d1/d33/classG4Track.html#a9c38785aa1341e6bd9a268e49cb32884">GetStep</a>()-&gt;<a class="code" href="../../d9/d7a/classG4Step.html#abf249a440580353af39c451b956a3123">GetPreStepPoint</a>();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75">G4StepStatus</a> stepStatus     = <a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a5712b6fd75643c96893b8ccba2c866bea9ccbad167e57928ae157f0033c2f44bc">sp</a>-&gt;GetStepStatus();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>               = track.<a class="code" href="../../d1/d33/classG4Track.html#a2b0222eb822b6b55224e379fd5813100">GetMaterialCutsCouple</a>();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <a class="code" href="../../d3/dc1/classG4VEmModel.html#a51adf718819d0e4194e5b003f6b7f0c4">SetCurrentCouple</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac65577da8ca624dfeea91faeb501f0df">currentMaterialIndex</a>        = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>-&gt;<a class="code" href="../../d9/dc9/classG4MaterialCutsCouple.html#a46a21e5876859b24c702d7bd61aa8723">GetMaterial</a>()-&gt;<a class="code" href="../../d5/de4/classG4Material.html#ad50823f82efe0e1798ac4e34d6829828">GetIndex</a>();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>            = dp-&gt;<a class="code" href="../../d7/d5c/classG4DynamicParticle.html#a8e748b292817a46bc4f7e2ad2fdad2bc">GetKineticEnergy</a>();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>                = <a class="code" href="../../d0/d99/classG4VMscModel.html#a74d0f20f6c9d895fc08e8c37135176cd">GetRange</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">particle</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// elastic and first transport mfp, screening parameter and G1 are also set</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// (Mott-correction will be used if it was requested by the user)</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac89f6edb92868d772811035e07d49a3c">GetTransportMeanFreePath</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">particle</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// Set initial values:</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">//  : lengths are initialised to currentMinimalStep  which is the true, minimum</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">//    step length from all other physics</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>    = currentMinimalStep;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af9f313ceedd3b3013723cc8a3e70cd08">fTheTransportDistance</a> = currentMinimalStep;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>       = currentMinimalStep;  <span class="comment">// will need to be converted</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>.set(0.,0.,0.);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.set(0.,0.,1.);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Can everything be done in the step limit phase ?</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// Multiple scattering needs to be sample ?</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// Single scattering needs to be sample ?</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">fIsSingleScattering</a>   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// Was zero deflection in multiple scattering sampling ?</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">fIsNoScatteringInMSC</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// Do not care about displacement in MSC sampling</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// ( used only in the case of gIsOptimizationOn = true)</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">fIsNoDisplace</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// get pre-step point safety</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a> = <a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a5712b6fd75643c96893b8ccba2c866bea9ccbad167e57928ae157f0033c2f44bc">sp</a>-&gt;GetSafety();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b929b4a540635e9a850a1f330a70dfa">fZeff</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>-&gt;<a class="code" href="../../d9/dc9/classG4MaterialCutsCouple.html#a46a21e5876859b24c702d7bd61aa8723">GetMaterial</a>()-&gt;<a class="code" href="../../d5/de4/classG4Material.html#a8acdb1b96f971b091d8dfaa4c998346d">GetIonisation</a>()-&gt;<a class="code" href="../../d6/d69/classG4IonisParamMat.html#a93f8394221b85fc063ba355b0a99a886">GetZeffective</a>();</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// distance will take into account max-fluct.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> distance = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  distance *= (1.20-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b929b4a540635e9a850a1f330a70dfa">fZeff</a>*(1.62e-2-9.22e-5*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b929b4a540635e9a850a1f330a70dfa">fZeff</a>));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// Possible optimization : if the distance is samller than the safety -&gt; the</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// particle will never leave this volume -&gt; dispalcement</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// as the effect of multiple elastic scattering can be skipped</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// Important : this optimization can cause problems if one does scoring</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// in a bigger volume since MSC won&#39;t be done deep inside the volume when</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// distance &lt; safety so don&#39;t use optimized-mode in such case.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae4132d7075d870497622b7029bcd8d78">gIsOptimizationOn</a> &amp;&amp; (distance&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>)) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;     <span class="comment">// Indicate that we need to do MSC after transportation and no dispalcement.</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;     <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;     <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">fIsNoDisplace</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d99/classG4VMscModel.html#a82642fc90fca0e907249d79e6292e770">steppingAlgorithm</a>==<a class="code" href="../../d6/dec/G4MscStepLimitType_8hh.html#a803174723dad550db3c7e4048e78c8b1ad4dc6dff8e78fa177567a42c154116e0">fUseDistanceToBoundary</a>) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">//Compute geomlimit (and presafety) :</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// - geomlimit will be:</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">//    == the straight line distance to the boundary if currentRange is</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">//       longer than that</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">//    == a big value [geombig = 1.e50*mm] if currentRange is shorter than</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">//       the straight line distance to the boundary</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// - presafety will be updated as well</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// So the particle can travell &#39;gemlimit&#39; distance (along a straight</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// line!) in its current direction:</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">//  (1) before reaching a boundary (geomlimit &lt; geombig) OR</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">//  (2) before reaching its current range (geomlimit == geombig)</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a> = <a class="code" href="../../d0/d99/classG4VMscModel.html#a2c0f2785a378171f0230bc1103e8ced8">ComputeGeomLimit</a>(track, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// Record that the particle is on a boundary</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> ( (stepStatus==<a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a>) || (stepStatus==<a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a8375e7611f8dfb67c4e088f311afc082">fUndefined</a> &amp;&amp; <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>==0.0)) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e28f34faea2aba8c2c9cf964ad5dba4">fIsWasOnBoundary</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// Set skin depth = skin x elastic_mean_free_path</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    skindepth     = <a class="code" href="../../d0/d99/classG4VMscModel.html#a370b5cbccbbb384607400c528aade1e7">skin</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// Init the flag that indicates that the particle are within a skindepth</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// distance from a boundary</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d10da21d2b8dc11665428a0fd55a4cc">fIsInsideSkin</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// Check if we can try Single Scattering because we are within skindepth</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// distance from/to a boundary OR the current minimum true-step-length is</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// shorter than skindepth. NOTICE: the latest has only efficieny reasons</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// because the MSC angular sampling is fine for any short steps but much</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// faster to try single scattering in case of short steps.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> ((stepStatus==<a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a>) || (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>&lt;skindepth) || (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>&lt;skindepth)) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="comment">// check if we are within skindepth distance from a boundary</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordflow">if</span> ((stepStatus == <a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a>) || (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a> &lt; skindepth)) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d10da21d2b8dc11665428a0fd55a4cc">fIsInsideSkin</a>    = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e28f34faea2aba8c2c9cf964ad5dba4">fIsWasOnBoundary</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="comment">//Try single scattering:</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="comment">// - sample distance to next single scattering interaction (sslimit)</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="comment">// - compare to current minimum length</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="comment">//      == if sslimit is the shorter:</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="comment">//          - set the step length to sslimit</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="comment">//          - indicate that single scattering needs to be done</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="comment">//      == else : nothing to do</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="comment">//- in both cases, the step length was very short so geometrical and</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">//  true path length are the same</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> sslimit = -1.*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>*<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>());</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="comment">// compare to current minimum step length</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      <span class="keywordflow">if</span> (sslimit&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>  = sslimit;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">fIsSingleScattering</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="comment">// short step -&gt; true step length equal to geometrical path length</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>       = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="comment">// Set taht everything is done in step-limit phase so no MSC call</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="comment">// We will check if we need to perform the single-scattering angular</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">// sampling i.e. if single elastic scattering was the winer!</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>  = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="comment">// After checking we know that we cannot try single scattering so we will</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="comment">// need to make an MSC step</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="comment">// Indicate that we need to make and MSC step. We do not check if we can</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="comment">// do it now i.e. if presafety&gt;final_true_step_length so we let the</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="comment">// fIsEverythingWasDone = false which indicates that we will perform</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="comment">// MSC after transportation.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">// Init the first-real-step falg: it will indicate if we do the first</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="comment">// non-single scattering step in this volume with this particle</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a272359d551edaf0eee77e485607af8ad">fIsFirstRealStep</a>      = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="comment">// If previously the partcile was on boundary it was within skin as</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="comment">// well. When it is not within skin anymore it has just left the skin</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="comment">// so we make the first real MSC step with the particle.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e28f34faea2aba8c2c9cf964ad5dba4">fIsWasOnBoundary</a> &amp;&amp; !<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d10da21d2b8dc11665428a0fd55a4cc">fIsInsideSkin</a>) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">// reset the &#39;was on boundary&#39; indicator flag</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e28f34faea2aba8c2c9cf964ad5dba4">fIsWasOnBoundary</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a272359d551edaf0eee77e485607af8ad">fIsFirstRealStep</a>  = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="comment">// If this is the first-real msc step (the partcile has just left the</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="comment">// skin) or this is the first step with the particle (was born or</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">// primary):</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">//   - set the initial range that will be used later to limit its step</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="comment">//     (only in this volume, because after boundary crossing at the</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="comment">//     first-real MSC step we will reset)</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="comment">//  - don&#39;t let the partcile to cross the volume just in one step</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a> || <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a272359d551edaf0eee77e485607af8ad">fIsFirstRealStep</a> || <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a>&gt;1.e+20) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">// If geomlimit &lt; geombig than the particle might reach the boundary</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">// along its initial direction before losing its energy (in this step)</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// Otherwise we can be sure that the particle will lose it energy</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment">// before reaching the boundary along a starigth line so there is no</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">// geometrical limit appalied. [However, tgeom is set only in the</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">// first or the first-real MSC step. After the first or first real</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">// MSC step the direction will change tgeom won&#39;t guaranty anything!</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">// But we will try to end up within skindepth from the boundary using</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">// the actual value of geomlimit(See later at step reduction close to</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">// boundary).]</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">geombig</a>) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="comment">// transfrom straight line distance to the boundary to real step</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <span class="comment">// length based on the mean values (using the prestep point</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          <span class="comment">// first-transport mean free path i.e. no energy loss correction)</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;          <span class="keywordflow">if</span> ((1.-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>)&gt; 0.) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a> = -<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>*<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(1.-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          <span class="comment">// the 2-different case that could lead us here</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a>) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3e5b9a35af1ce864f7d36c232da71256">tgeom</a> = 2.*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>/<a class="code" href="../../d0/d99/classG4VMscModel.html#ae65c331bb91c0ceaa7e62a95a2befff5">facgeom</a>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3e5b9a35af1ce864f7d36c232da71256">tgeom</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>/<a class="code" href="../../d0/d99/classG4VMscModel.html#ae65c331bb91c0ceaa7e62a95a2befff5">facgeom</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3e5b9a35af1ce864f7d36c232da71256">tgeom</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">geombig</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="comment">// True step length limit from range factor. Noteice, that the initial</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="comment">// range is used that was set at the first step or first-real MSC step</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="comment">// in this volume with this particle.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a> = <a class="code" href="../../d0/d99/classG4VMscModel.html#a2af7f0c2bd13a5b31d4a8e7ccc687aee">facrange</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="comment">// Take the minimum of the true step length limits coming from</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// geometrical constraint or range-factor limitation</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3e5b9a35af1ce864f7d36c232da71256">tgeom</a>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">// Step reduction close to boundary: we try to end up within skindepth</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">// from the boundary ( Notice: in case of mag. field it might not work</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">// because geomlimit is the straigth line distance to the boundary in</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="comment">// the currect direction (if geomlimit&lt;geombig) and mag. field can</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="comment">// change the initial direction. So te particle might hit some boundary</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="comment">// before in a different direction. However, here we restrict the true</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="comment">// path length to this (straight line) lenght so the corresponding</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="comment">// transport distance (straight line) will be even shorter than</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="comment">// geomlimit-0.999*skindepth after the change of true-&gt;geom.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">geombig</a>) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a>-0.999*skindepth);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="comment">// randomize 1st step or 1st &#39;normal&#39; step in volume</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a> || <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a272359d551edaf0eee77e485607af8ad">fIsFirstRealStep</a>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8f9f5cba3f054410d4b9ef3187bd9cff">Randomizetlimit</a>());</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d99/classG4VMscModel.html#a82642fc90fca0e907249d79e6292e770">steppingAlgorithm</a>==<a class="code" href="../../d6/dec/G4MscStepLimitType_8hh.html#a803174723dad550db3c7e4048e78c8b1a9561f7b73ec8f83e13780ddf70c0b9c5">fUseSafetyPlus</a>) { <span class="comment">// THE ERROR_FREE stepping alg.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a> =  <a class="code" href="../../d0/d99/classG4VMscModel.html#ad6478b61c17da3935a41df21931062f1">ComputeSafety</a>(<a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a5712b6fd75643c96893b8ccba2c866bea9ccbad167e57928ae157f0033c2f44bc">sp</a>-&gt;GetPosition(),<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">geomlimit</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// Set skin depth = skin x elastic_mean_free_path</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    skindepth = <a class="code" href="../../d0/d99/classG4VMscModel.html#a370b5cbccbbb384607400c528aade1e7">skin</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// Check if we can try Single Scattering because we are within skindepth</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// distance from/to a boundary OR the current minimum true-step-length is</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// shorter than skindepth. NOTICE: the latest has only efficieny reasons</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// because the MSC angular sampling is fine for any short steps but much</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// faster to try single scattering in case of short steps.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">if</span> ((stepStatus==<a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a>) || (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>&lt;skindepth) || (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>&lt;skindepth)) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="comment">//Try single scattering:</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="comment">// - sample distance to next single scattering interaction (sslimit)</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="comment">// - compare to current minimum length</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="comment">//      == if sslimit is the shorter:</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="comment">//          - set the step length to sslimit</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="comment">//          - indicate that single scattering needs to be done</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="comment">//      == else : nothing to do</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="comment">//- in both cases, the step length was very short so geometrical and</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="comment">//  true path length are the same</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> sslimit = -1.*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>*<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>());</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="comment">// compare to current minimum step length</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordflow">if</span> (sslimit&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>  = sslimit;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">fIsSingleScattering</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="comment">// short step -&gt; true step length equal to geometrical path length</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>       = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="comment">// Set taht everything is done in step-limit phase so no MSC call</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">// We will check if we need to perform the single-scattering angular</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <span class="comment">// sampling i.e. if single elastic scattering was the winer!</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>  = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="comment">// After checking we know that we cannot try single scattering so we will</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="comment">// need to make an MSC step</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="comment">// Indicate that we need to make and MSC step.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>  = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="comment">// limit from range factor</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>    = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d0/d99/classG4VMscModel.html#a2af7f0c2bd13a5b31d4a8e7ccc687aee">facrange</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="comment">// never let the particle go further than the safety if we are out of the skin</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="comment">// if we are here we are out of the skin, presafety &gt; 0.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>&gt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="comment">// make sure that we are still within the aplicability of condensed histry model</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="comment">// i.e. true step length is not longer than first transport mean free path.</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="comment">// We schould take into account energy loss along 0.5x lambda_transport1</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="comment">// step length as well. So let it 0.5 x lambda_transport1</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>*0.5);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// This is the default stepping algorithm: the fastest but the least</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// accurate that corresponds to fUseSafety in Urban model. Note, that GS</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// model can handle any short steps so we do not need the minimum limits</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// NO single scattering in case of skin or short steps (by defult the MSC</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">// model will be single or even no scattering in case of short steps</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">// compared to the elastic mean free path.)</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// indicate that MSC needs to be done (always and always after transportation)</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">if</span> (stepStatus!=<a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a>) {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a> = <a class="code" href="../../d0/d99/classG4VMscModel.html#ad6478b61c17da3935a41df21931062f1">ComputeSafety</a>(<a class="code" href="../../db/d32/namespaceG4InuclParticleNames.html#a5712b6fd75643c96893b8ccba2c866bea9ccbad167e57928ae157f0033c2f44bc">sp</a>-&gt;GetPosition(),<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// Far from boundary-&gt; in optimized mode do not sample dispalcement.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">if</span> ((distance&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>) &amp;&amp; (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae4132d7075d870497622b7029bcd8d78">gIsOptimizationOn</a>)) {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">fIsNoDisplace</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="comment">// Urban like</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a> || (stepStatus==<a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a>) || <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a>&gt;1.e+20) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa8f39452436597a0358d6d5a22b411b8">fr</a>        = <a class="code" href="../../d0/d99/classG4VMscModel.html#a2af7f0c2bd13a5b31d4a8e7ccc687aee">facrange</a>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">// We don&#39;t use this: we won&#39;t converge to the single scattering results with</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">//                    decreasing range-factor.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">//              rangeinit = std::max(rangeinit, fLambda1);</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">//              if(fLambda1 &gt; lambdalimit) {</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">//                fr *= (0.75+0.25*fLambda1/lambdalimit);</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">//              }</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="comment">//step limit</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a053a361bf37b11d9d1b3eba566dac26f">std::max</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa8f39452436597a0358d6d5a22b411b8">fr</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">rangeinit</a>, <a class="code" href="../../d0/d99/classG4VMscModel.html#ad6a9fc1399bdc67fce0bf84a7ab60c91">facsafety</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">presafety</a>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="comment">// first step randomization</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a> || stepStatus==<a class="code" href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a>) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8f9f5cba3f054410d4b9ef3187bd9cff">Randomizetlimit</a>());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">tlimit</a>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="comment">// unset first-step</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">firstStep</a> =<span class="keyword">false</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="comment">// performe single scattering, multiple scattering if this later can be done safely here</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">fIsSingleScattering</a>) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="comment">// sample single scattering</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="comment">//G4double ekin   = 0.5*(currentKinEnergy + GetEnergy(particle,currentRange-fTheTrueStepLenght,currentCouple));</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> lekin  = <a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> pt2    = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>*(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>+2.0*CLHEP::electron_mass_c2);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> beta2  = pt2/(pt2+CLHEP::electron_mass_c2*CLHEP::electron_mass_c2);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> cost   = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a2bbac730b3592079b08aa522b7464c08">SingleScattering</a>(1., <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>, lekin, beta2, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac65577da8ca624dfeea91faeb501f0df">currentMaterialIndex</a>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="comment">// protection</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">if</span> (cost&lt;-1.) cost = -1.;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">if</span> (cost&gt; 1.) cost =  1.;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="comment">// compute sint</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> dum    = 1.-cost;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> sint   = std::sqrt(dum*(2.-dum));</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> phi    = <a class="code" href="../../d8/df2/G4SIunits_8hh.html#a4cbb5c4d46f05bf0db49503fb906cb34">CLHEP::twopi</a>*<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> sinPhi = std::sin(phi);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> cosPhi = std::cos(phi);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.set(sint*cosPhi,sint*sinPhi,cost);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a>) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="comment">// sample multiple scattering</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a748872bf7f725a7c0e18f2150bd2b05d">SampleMSC</a>(); <span class="comment">// fTheZPathLenght, fTheDisplacementVector and fTheNewDirection will be set</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    } <span class="comment">// and if single scattering but it was longer =&gt; nothing to do</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  } <span class="comment">//else { do nothing here but after transportation</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d0/d99/classG4VMscModel.html#ac85e2508fa24259a19b0735b60cc02b9">ConvertTrueToGeom</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>,currentMinimalStep);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;}</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad46fe4e0e306f62759c70e32c3a6de49">  783</a></span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad46fe4e0e306f62759c70e32c3a6de49">G4GoudsmitSaundersonMscModel::ComputeGeomPathLength</a>(<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a>) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">// convert true -&gt;geom</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="comment">// It is called from the step limitation ComputeTruePathLengthLimit if</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="comment">// !fIsEverythingWasDone but protect:</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a> = -1.;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aff7737c4ceee8f5f193301fcaf396a11">par2</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a> = 0.;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="comment">// if fIsEverythingWasDone = TRUE  =&gt; fTheZPathLenght is already set</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="comment">// so return with the already known value</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="comment">// Otherwise:</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>) {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">// this correction needed to run MSC with eIoni and eBrem inactivated</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">// and makes no harm for a normal run</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">//  do the true -&gt; geom transformation</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// z = t for very small true-path-length</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa5a764c9fe2cecfa79939f956ef84c25">tlimitminfix2</a>) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> tau = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">if</span> (tau&lt;=<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7c2ba8f29691d5a7471e0f71fa41c657">tausmall</a>) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    } <span class="keywordflow">else</span>  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>*<a class="code" href="../../d0/d99/classG4VMscModel.html#a0f68e6a113b58712c64501fcd5a99d2c">dtrl</a>) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordflow">if</span> (tau&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a1778149540068158b10e85a557342de2">taulim</a>) <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>*(1.-0.5*tau) ;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">else</span>            <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>*(1.-<a class="code" href="../../d0/dcc/G4Exp_8hh.html#a224eb86aa032b59b4fa6398ea1eb566a">G4Exp</a>(-tau));</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad77ba4a828bd1aeaa2c0e4358c55e88d">mass</a> || <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>==<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>)  {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a> = 1./<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a> ;     <span class="comment">// alpha =1/range_init for Ekin&lt;mass</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aff7737c4ceee8f5f193301fcaf396a11">par2</a> = 1./(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>) ;  <span class="comment">// 1/(alphaxlambda01)</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a> = 1.+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aff7737c4ceee8f5f193301fcaf396a11">par2</a> ;             <span class="comment">// 1+1/</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = 1./(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>) * (1.-std::pow(1.-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>));</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = 1./(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> rfin    = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a053a361bf37b11d9d1b3eba566dac26f">std::max</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>, 0.01*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> T1      = <a class="code" href="../../d0/d99/classG4VMscModel.html#a6540d9e4f3ce8e6f0f1cecdc0be227fa">GetEnergy</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">particle</a>,rfin,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> lambda1 = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7ebf1fa9cf19d4b0416b2b4ca7421d59">GetTransportMeanFreePathOnly</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">particle</a>,T1);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a> = (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>-lambda1)/(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>);  <span class="comment">// alpha</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aff7737c4ceee8f5f193301fcaf396a11">par2</a> = 1./(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a> = 1.+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aff7737c4ceee8f5f193301fcaf396a11">par2</a> ;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <a class="code" href="../../de/d0f/classG4Pow.html">G4Pow</a> *g4calc = <a class="code" href="../../de/d0f/classG4Pow.html#a1606c8b5588e4236b12b03470dbf3b06">G4Pow::GetInstance</a>();</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = 1./(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>) * (1.-g4calc-&gt;<a class="code" href="../../de/d0f/classG4Pow.html#acc4e5905a9f7978839b7c4f89a738d50">powA</a>(1.-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>));</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">std::min</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a884d80e9485723510bf7b6aed43b6b9e">  835</a></span>&#160;<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a884d80e9485723510bf7b6aed43b6b9e">G4GoudsmitSaundersonMscModel::ComputeTrueStepLength</a>(<a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> geomStepLength) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// init</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a102ee0534dcf08f34ce0ef39d70c7f25">fIsEndedUpOnBoundary</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">// step defined other than transportation</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span> (geomStepLength==<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">// else ::</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// - set the flag that transportation was the winer so DoNothin in DOIT !!</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="comment">// - convert geom -&gt; true by using the mean value</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a102ee0534dcf08f34ce0ef39d70c7f25">fIsEndedUpOnBoundary</a> = <span class="keyword">true</span>; <span class="comment">// OR LAST STEP</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>      = geomStepLength;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">// was a short single scattering step</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a> &amp;&amp; !<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a>) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = geomStepLength;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// t = z for very small step</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">if</span> (geomStepLength&lt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa5a764c9fe2cecfa79939f956ef84c25">tlimitminfix2</a>) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = geomStepLength;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">// recalculation</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> tlength = geomStepLength;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (geomStepLength&gt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7c2ba8f29691d5a7471e0f71fa41c657">tausmall</a>) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>&lt; 0.) {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        tlength = -<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>*<a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(1.-geomStepLength/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a>) ;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>*geomStepLength&lt;1.) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          <a class="code" href="../../de/d0f/classG4Pow.html">G4Pow</a> *g4calc = <a class="code" href="../../de/d0f/classG4Pow.html#a1606c8b5588e4236b12b03470dbf3b06">G4Pow::GetInstance</a>();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          tlength = (1.-g4calc-&gt;<a class="code" href="../../de/d0f/classG4Pow.html#acc4e5905a9f7978839b7c4f89a738d50">powA</a>( 1.-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>*geomStepLength,1./<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">par3</a>))/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">par1</a>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          tlength = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">if</span> (tlength&lt;geomStepLength || tlength&gt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        tlength = geomStepLength;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a> = tlength;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<a class="code" href="../../d8/dbe/G4ThreeVector_8hh.html#a8a40941423af41c97f26abe9ccfe2bdd">G4ThreeVector</a>&amp;</div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdb6037f27b8a2e863ff1c04f006cd05">  880</a></span>&#160;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdb6037f27b8a2e863ff1c04f006cd05">G4GoudsmitSaundersonMscModel::SampleScattering</a>(<span class="keyword">const</span> <a class="code" href="../../d8/dbe/G4ThreeVector_8hh.html#a8a40941423af41c97f26abe9ccfe2bdd">G4ThreeVector</a>&amp; oldDirection, <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a>) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d0/d99/classG4VMscModel.html#a82642fc90fca0e907249d79e6292e770">steppingAlgorithm</a>==<a class="code" href="../../d6/dec/G4MscStepLimitType_8hh.html#a803174723dad550db3c7e4048e78c8b1ad4dc6dff8e78fa177567a42c154116e0">fUseDistanceToBoundary</a> &amp;&amp; <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a> &amp;&amp; <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">fIsSingleScattering</a>) {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// single scattering was and scattering happend</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.rotateUz(oldDirection);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b542be7cec7d369810ebfca6b1255a9">fParticleChange</a>-&gt;<a class="code" href="../../d7/d2c/classG4ParticleChangeForMSC.html#ab9fc294e979f3289b1ff49d41b4ad47a">ProposeMomentumDirection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d99/classG4VMscModel.html#a82642fc90fca0e907249d79e6292e770">steppingAlgorithm</a>==<a class="code" href="../../d6/dec/G4MscStepLimitType_8hh.html#a803174723dad550db3c7e4048e78c8b1a9561f7b73ec8f83e13780ddf70c0b9c5">fUseSafetyPlus</a>) {  <span class="comment">// error-free stepping</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a102ee0534dcf08f34ce0ef39d70c7f25">fIsEndedUpOnBoundary</a>) { <span class="comment">// do nothing on the boundary</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>) { <span class="comment">// evrything is done if not optimizations case !!!</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="comment">// check single scattering and see if it happened</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">fIsSingleScattering</a>) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.rotateUz(oldDirection);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b542be7cec7d369810ebfca6b1255a9">fParticleChange</a>-&gt;<a class="code" href="../../d7/d2c/classG4ParticleChangeForMSC.html#ab9fc294e979f3289b1ff49d41b4ad47a">ProposeMomentumDirection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="comment">// check if multiple scattering happened and do things only if scattering was really happening</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">fIsMultipleSacettring</a> &amp;&amp; !<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">fIsNoScatteringInMSC</a>) {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;           <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.rotateUz(oldDirection);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;           <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>.rotateUz(oldDirection);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;           <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b542be7cec7d369810ebfca6b1255a9">fParticleChange</a>-&gt;<a class="code" href="../../d7/d2c/classG4ParticleChangeForMSC.html#ab9fc294e979f3289b1ff49d41b4ad47a">ProposeMomentumDirection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="comment">// The only thing that could happen if we are here (fUseSafety and fIsEverythingWasDone)</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="comment">// is that  single scattering was tried but did not win so scattering did not happen.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="comment">// So no displacement and no scattering</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">// The only thing that could still happen with fUseSafetyPlus is that we are in the</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// optimization branch: so sample MSC angle here (no displacement)</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">//else MSC needs to be done here</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a748872bf7f725a7c0e18f2150bd2b05d">SampleMSC</a>();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">fIsNoScatteringInMSC</a>) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.rotateUz(oldDirection);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b542be7cec7d369810ebfca6b1255a9">fParticleChange</a>-&gt;<a class="code" href="../../d7/d2c/classG4ParticleChangeForMSC.html#ab9fc294e979f3289b1ff49d41b4ad47a">ProposeMomentumDirection</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">fIsNoDisplace</a>) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>.rotateUz(oldDirection);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;}</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a748872bf7f725a7c0e18f2150bd2b05d">  925</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a748872bf7f725a7c0e18f2150bd2b05d">G4GoudsmitSaundersonMscModel::SampleMSC</a>() {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">fIsNoScatteringInMSC</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// kinetic energy is assumed to be in Geant4 internal energy unit which is MeV</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> kineticEnergy = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">currentKinEnergy</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">// Energy loss correction: 2 version</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> eloss  = 0.0;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">//  if (fTheTrueStepLenght &gt; currentRange*dtrl) {</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  eloss = kineticEnergy - <a class="code" href="../../d0/d99/classG4VMscModel.html#a6540d9e4f3ce8e6f0f1cecdc0be227fa">GetEnergy</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">particle</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">currentRange</a>-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>,<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">currentCouple</a>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">//  } else {</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">//    eloss = fTheTrueStepLenght*GetDEDX(particle,kineticEnergy,currentCouple);</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> tau  = 0.;<span class="comment">//    = kineticEnergy/electron_mass_c2; // where kinEnergy is the mean kinetic energy</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> tau2 = 0.;<span class="comment">//   = tau*tau;</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> eps0 = 0.;<span class="comment">//   = eloss/kineticEnergy0; // energy loss fraction to the begin step energy</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> epsm = 0.;<span class="comment">//   = eloss/kineticEnergy;  // energy loss fraction to the mean step energy</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">// - init.</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> efEnergy = kineticEnergy;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> efStep   = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> kineticEnergy0 = kineticEnergy;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7da3cc8c1e26a662323f1b0ef823809c">gIsUseAccurate</a>) {    <span class="comment">// - use accurate energy loss correction</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    kineticEnergy  -= 0.5*eloss;  <span class="comment">// mean energy along the full step</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">// other parameters for energy loss corrections</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    tau             = kineticEnergy/electron_mass_c2; <span class="comment">// where kinEnergy is the mean kinetic energy</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    tau2            = tau*tau;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    eps0            = eloss/kineticEnergy0; <span class="comment">// energy loss fraction to the begin step energy</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    epsm            = eloss/kineticEnergy;  <span class="comment">// energy loss fraction to the mean step energy</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    efEnergy        = kineticEnergy * (1.-epsm*epsm*(6.+10.*tau+5.*tau2)/(24.*tau2+48.*tau+72.));</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> dum    = 0.166666*(4.+tau*(6.+tau*(7.+tau*(4.+tau))))*(epsm/((tau+1.)*(tau+2.)))*(epsm/((tau+1.)*(tau+2.)));</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    efStep          = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>*(1.-dum);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  } <span class="keywordflow">else</span> {                              <span class="comment">// - take only mean energy</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    kineticEnergy  -= 0.5*eloss;  <span class="comment">// mean energy along the full step</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    efEnergy        = kineticEnergy;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> factor = 1./(1.+0.9784671*kineticEnergy); <span class="comment">//0.9784671 = 1/(2*m_e)</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    eps0            = eloss/kineticEnergy0;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    epsm            = eps0/(1.-0.5*eps0);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> temp   = 0.3*(1 -factor*(1.-0.333333*factor))*eps0*eps0;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    efStep          = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>*(1.+temp);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="comment">// compute elastic mfp, first transport mfp, screening parameter, and G1 (with Mott-correction</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="comment">// if it was requested by the user)</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">fLambda1</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac89f6edb92868d772811035e07d49a3c">GetTransportMeanFreePath</a>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">particle</a>, efEnergy);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="comment">// s/lambda_el</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> lambdan=0.;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>&gt;0.0) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    lambdan=efStep/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">fLambda0</a>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="keywordflow">if</span> (lambdan&lt;=1.0e-12) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">fIsNoScatteringInMSC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="comment">// first moment: 2.* lambdan *scrA*((1.+scrA)*log(1.+1./scrA)-1.);</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> Qn1 = lambdan *<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="comment">// sample scattering angles</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="comment">// new direction, relative to the orriginal one is in {uss,vss,wss}</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> cosTheta1 = 1.0, sinTheta1 = 0.0, cosTheta2 = 1.0, sinTheta2 = 0.0;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> cosPhi1   = 1.0, sinPhi1   = 0.0, cosPhi2   = 1.0, sinPhi2   = 0.0;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> uss       = 0.0, vss       = 0.0, wss       = 1.0;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> x_coord   = 0.0, y_coord   = 0.0, z_coord   = 1.0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> u2 = 0.0, v2 = 0.0;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="comment">// if we are above the upper grid limit with lambdaxG1=true-length/first-trans-mfp</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="comment">// =&gt; izotropic distribution: lambG1_max =7.992 but set it to 7</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">if</span> (0.5*Qn1 &gt; 7.0){</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    cosTheta1 = 1.-2.*<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>();</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    sinTheta1 = std::sqrt((1.-cosTheta1)*(1.+cosTheta1));</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    cosTheta2 = 1.-2.*<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>();</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    sinTheta2 = std::sqrt((1.-cosTheta2)*(1.+cosTheta2));</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;     <span class="comment">// sample 2 scattering cost1, sint1, cost2 and sint2 for half path</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> lekin  = <a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(efEnergy);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> pt2    = efEnergy*(efEnergy+2.0*CLHEP::electron_mass_c2);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> beta2  = pt2/(pt2+CLHEP::electron_mass_c2*CLHEP::electron_mass_c2);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;     <span class="comment">// backup GS angular dtr pointer (kinetic energy and delta index in case of Mott-correction)</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;     <span class="comment">// if the first was an msc sampling (the same will be used if the second is also an msc step)</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;     <a class="code" href="../../df/d6e/structG4GoudsmitSaundersonTable_1_1GSMSCAngularDtr.html">G4GoudsmitSaundersonTable::GSMSCAngularDtr</a> *gsDtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#abe302bce7537dc7036cb11d827505004">G4int</a> mcEkinIdx    = -1;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#abe302bce7537dc7036cb11d827505004">G4int</a> mcDeltIdx    = -1;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> transfPar = 0.;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#adc66322b5328e4c3ed3038bc9f19f6f1">G4bool</a> isMsc = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a4f0cee95adbf9bf1e10dced21e6d65ee">Sampling</a>(0.5*lambdan, 0.5*Qn1, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>, cosTheta1, sinTheta1, lekin, beta2,</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                       <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac65577da8ca624dfeea91faeb501f0df">currentMaterialIndex</a>, &amp;gsDtr, mcEkinIdx, mcDeltIdx, transfPar,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                       <span class="keyword">true</span>);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;     <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">fGSTable</a>-&gt;<a class="code" href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a4f0cee95adbf9bf1e10dced21e6d65ee">Sampling</a>(0.5*lambdan, 0.5*Qn1, <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>, cosTheta2, sinTheta2, lekin, beta2,</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac65577da8ca624dfeea91faeb501f0df">currentMaterialIndex</a>, &amp;gsDtr, mcEkinIdx, mcDeltIdx, transfPar, !isMsc);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;     <span class="keywordflow">if</span> (cosTheta1+cosTheta2==2.) { <span class="comment">// no scattering happened</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>)</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;           <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">fIsNoScatteringInMSC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;     }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="comment">// sample 2 azimuthal angles</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> phi1 = <a class="code" href="../../d8/df2/G4SIunits_8hh.html#a4cbb5c4d46f05bf0db49503fb906cb34">CLHEP::twopi</a>*<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>();</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  sinPhi1 = std::sin(phi1);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  cosPhi1 = std::cos(phi1);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> phi2 = <a class="code" href="../../d8/df2/G4SIunits_8hh.html#a4cbb5c4d46f05bf0db49503fb906cb34">CLHEP::twopi</a>*<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  sinPhi2 = std::sin(phi2);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  cosPhi2 = std::cos(phi2);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// compute final direction realtive to z-dir</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  u2  = sinTheta2*cosPhi2;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  v2  = sinTheta2*sinPhi2;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> u2p = cosTheta1*u2 + sinTheta1*cosTheta2;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  uss  = u2p*cosPhi1 - v2*sinPhi1;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  vss  = u2p*sinPhi1 + v2*cosPhi1;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  wss  = cosTheta1*cosTheta2 - sinTheta1*u2;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="comment">// set new direction (is scattering frame)</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">fTheNewDirection</a>.set(uss,vss,wss);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">// set the fTheZPathLenght if we don&#39;t sample displacement and</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">// we should do everything at the step-limit-phase before we return</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">fIsNoDisplace</a> &amp;&amp; <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="comment">// in optimized-mode if the current-safety &gt; current-range we do not use dispalcement</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">fIsNoDisplace</a>)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="comment">// Compute final position</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  Qn1 *=  <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">fMCtoQ1</a>;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7da3cc8c1e26a662323f1b0ef823809c">gIsUseAccurate</a>) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;     <span class="comment">// correction parameter</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> par =1.;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;     <span class="keywordflow">if</span>(Qn1&lt;0.7) par = 1.;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Qn1&lt;7.0) par = -0.031376*Qn1+1.01356;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;     <span class="keywordflow">else</span> par = 0.79;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;     <span class="comment">// Moments with energy loss correction</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;     <span class="comment">// --first the uncorrected (for energy loss) values of gamma, eta, a1=a2=0.5*(1-eta), delta</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;     <span class="comment">// gamma = G_2/G_1 based on G2 computed from A by using the Wentzel DCS form of G2</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> loga   = <a class="code" href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a>(1.0+1.0/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> gamma  = 6.0*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>*(1.0 + <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)*(loga*(1.0 + 2.0*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>) - 2.0)/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">fG1</a>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;     gamma *= <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">fMCtoG2PerG1</a>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;     <span class="comment">// sample eta from p(eta)=2*eta i.e. P(eta) = eta_square ;-&gt; P(eta) = rand --&gt; eta = sqrt(rand)</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> eta    = std::sqrt(<a class="code" href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a>());</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> eta1   = 0.5*(1 - eta);  <span class="comment">// used  more than once</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;     <span class="comment">// 0.5 +sqrt(6)/6 = 0.9082483;</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;     <span class="comment">// 1/(4*sqrt(6))  = 0.1020621;</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;     <span class="comment">// (4-sqrt(6)/(24*sqrt(6))) = 0.026374715</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;     <span class="comment">// delta = 0.9082483-(0.1020621-0.0263747*gamma)*Qn1 without energy loss cor.</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> delta  = 0.9082483-(0.1020621-0.0263747*gamma)*Qn1;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;     <span class="comment">// compute alpha1 and alpha2 for energy loss correction</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> temp1 = 2.0 + tau;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> temp  = (2.0+tau*temp1)/((tau+1.0)*temp1);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;     <span class="comment">//Take logarithmic dependence</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;     temp = temp - (tau+1.0)/((tau+2.0)*(loga*(1.0+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)-1.0));</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;     temp = temp * epsm;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;     temp1 = 1.0 - temp;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;     delta = delta + 0.40824829*(eps0*(tau+1.0)/((tau+2.0)*</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;             (loga*(1.0+<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)-1.0)*(loga*(1.0+2.0*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">fScrA</a>)-2.0)) - 0.25*temp*temp);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> b      = eta*delta;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> c      = eta*(1.0-delta);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;     <span class="comment">//Calculate transport direction cosines:</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;     <span class="comment">// ut,vt,wt is the final position divided by the true step length</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> w1v2 = cosTheta1*v2;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> ut   = b*sinTheta1*cosPhi1 + c*(cosPhi1*u2 - sinPhi1*w1v2) + eta1*uss*temp1;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> vt   = b*sinTheta1*sinPhi1 + c*(sinPhi1*u2 + cosPhi1*w1v2) + eta1*vss*temp1;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> wt   = eta1*(1+temp) +       b*cosTheta1 +  c*cosTheta2    + eta1*wss*temp1;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;     <span class="comment">// long step correction</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;     ut *=par;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;     vt *=par;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;     wt *=par;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;     <span class="comment">// final position relative to the pre-step point in the scattering frame</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;     <span class="comment">// ut = x_f/s so needs to multiply by s</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;     x_coord = ut*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;     y_coord = vt*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;     z_coord = wt*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>){</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;       <span class="comment">// We sample in the step limit so set fTheZPathLenght = transportDistance</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;       <span class="comment">// and lateral displacement (x_coord,y_coord,z_coord-transportDistance)</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;       <span class="comment">//Calculate transport distance</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;       <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> transportDistance  = std::sqrt(x_coord*x_coord+y_coord*y_coord+z_coord*z_coord);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;       <span class="comment">// protection</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;       <span class="keywordflow">if</span>(transportDistance&gt;<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          transportDistance = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;       <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = transportDistance;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;     }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;     <span class="comment">// else:: we sample in the DoIt so</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;     <span class="comment">//       the fTheZPathLenght was already set and was taken as transport along zet</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;     <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>.set(x_coord,y_coord,z_coord-<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;     <span class="comment">// compute zz = &lt;z&gt;/tPathLength</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;     <span class="comment">// s -&gt; true-path-length</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;     <span class="comment">// z -&gt; geom-path-length:: when PRESTA is used z =(def.) &lt;z&gt;</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;     <span class="comment">// r -&gt; lateral displacement = s/2 sin(theta)  =&gt; x_f = r cos(phi); y_f = r sin(phi)</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> zz = 0.0;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>){</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="comment">// We sample in the step limit so set fTheZPathLenght = transportDistance</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="comment">// and lateral displacement (x_coord,y_coord,z_coord-transportDistance)</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keywordflow">if</span>(Qn1&lt;0.1) { <span class="comment">// use 3-order Taylor approximation of (1-exp(-x))/x around x=0</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;          zz = 1.0 - Qn1*(0.5 - Qn1*(0.166666667 - 0.041666667*Qn1)); <span class="comment">// 1/6 =0.166..7 ; 1/24=0.041..</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          zz = (1.-<a class="code" href="../../d0/dcc/G4Exp_8hh.html#a224eb86aa032b59b4fa6398ea1eb566a">G4Exp</a>(-Qn1))/Qn1;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="comment">// we sample in the DoIt so</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="comment">// the fTheZPathLenght was already set and was taken as transport along zet</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        zz = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>/<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;     }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> rr = (1.-zz*zz)/(1.-wss*wss); <span class="comment">// s^2 &gt;= &lt;z&gt;^2+r^2  :: where r^2 = s^2/4 sin^2(theta)</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;     <span class="keywordflow">if</span>(rr &gt;= 0.25) rr = 0.25;            <span class="comment">// (1-&lt;z&gt;^2/s^2)/sin^2(theta) &gt;= r^2/(s^2 sin^2(theta)) = 1/4 must hold</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;     <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> rperp = <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>*std::sqrt(rr);  <span class="comment">// this is r/sint</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;     x_coord  = rperp*uss;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;     y_coord  = rperp*vss;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;     z_coord  = zz*<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">fTheTrueStepLenght</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;     <span class="keywordflow">if</span>(<a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">fIsEverythingWasDone</a>){</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;       <a class="code" href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a> transportDistance = std::sqrt(x_coord*x_coord + y_coord*y_coord + z_coord*z_coord);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;       <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a> = transportDistance;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;     }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;     <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">fTheDisplacementVector</a>.set(x_coord,y_coord,z_coord- <a class="code" href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">fTheZPathLenght</a>);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassG4MaterialCutsCouple_html_a46a21e5876859b24c702d7bd61aa8723"><div class="ttname"><a href="../../d9/dc9/classG4MaterialCutsCouple.html#a46a21e5876859b24c702d7bd61aa8723">G4MaterialCutsCouple::GetMaterial</a></div><div class="ttdeci">const G4Material * GetMaterial() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dff/G4MaterialCutsCouple_8hh_source.html#l00149">G4MaterialCutsCouple.hh:149</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ae30e3a4f6c8f643d195f2d65410ef514"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae30e3a4f6c8f643d195f2d65410ef514">G4GoudsmitSaundersonMscModel::fTheNewDirection</a></div><div class="ttdeci">G4ThreeVector fTheNewDirection</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00250">G4GoudsmitSaundersonMscModel.hh:250</a></div></div>
<div class="ttc" id="aclassG4VEmModel_html_a35474c08f31b0e8d40fcb95b22068236"><div class="ttname"><a href="../../d3/dc1/classG4VEmModel.html#a35474c08f31b0e8d40fcb95b22068236">G4VEmModel::LowEnergyLimit</a></div><div class="ttdeci">G4double LowEnergyLimit() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d59/G4VEmModel_8hh_source.html#l00612">G4VEmModel.hh:612</a></div></div>
<div class="ttc" id="aG4SIunits_8hh_html_a60e2c8909c5361ab2436856d3d7d9f7e"><div class="ttname"><a href="../../d8/df2/G4SIunits_8hh.html#a60e2c8909c5361ab2436856d3d7d9f7e">nm</a></div><div class="ttdeci">static constexpr double nm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df2/G4SIunits_8hh_source.html#l00111">G4SIunits.hh:111</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_af0609d7b56476370d63f4c0e0fd23758"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af0609d7b56476370d63f4c0e0fd23758">G4GoudsmitSaundersonMscModel::geombig</a></div><div class="ttdeci">G4double geombig</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00202">G4GoudsmitSaundersonMscModel.hh:202</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ae5a41d2d61e6f24460c3d691a2ed4886"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae5a41d2d61e6f24460c3d691a2ed4886">G4GoudsmitSaundersonMscModel::charge</a></div><div class="ttdeci">G4int charge</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00220">G4GoudsmitSaundersonMscModel.hh:220</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_ad6478b61c17da3935a41df21931062f1"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#ad6478b61c17da3935a41df21931062f1">G4VMscModel::ComputeSafety</a></div><div class="ttdeci">G4double ComputeSafety(const G4ThreeVector &amp;position, G4double limit=DBL_MAX)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00236">G4VMscModel.hh:236</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_a6e98e87f5d6a109938468f2830e93431"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a6e98e87f5d6a109938468f2830e93431">G4GoudsmitSaundersonTable::GetMoliereBc</a></div><div class="ttdeci">G4double GetMoliereBc(G4int matindx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh_source.html#l00122">G4GoudsmitSaundersonTable.hh:122</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a327a88a1c13bed2a6dd376f09963e5ee"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a327a88a1c13bed2a6dd376f09963e5ee">G4GoudsmitSaundersonMscModel::fMCtoQ1</a></div><div class="ttdeci">G4double fMCtoQ1</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00242">G4GoudsmitSaundersonMscModel.hh:242</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_aa8f39452436597a0358d6d5a22b411b8"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa8f39452436597a0358d6d5a22b411b8">G4GoudsmitSaundersonMscModel::fr</a></div><div class="ttdeci">G4double fr</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00200">G4GoudsmitSaundersonMscModel.hh:200</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a272359d551edaf0eee77e485607af8ad"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a272359d551edaf0eee77e485607af8ad">G4GoudsmitSaundersonMscModel::fIsFirstRealStep</a></div><div class="ttdeci">G4bool fIsFirstRealStep</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00260">G4GoudsmitSaundersonMscModel.hh:260</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a3e5b9a35af1ce864f7d36c232da71256"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3e5b9a35af1ce864f7d36c232da71256">G4GoudsmitSaundersonMscModel::tgeom</a></div><div class="ttdeci">G4double tgeom</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00206">G4GoudsmitSaundersonMscModel.hh:206</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a0e9e06adbca1fb660a8934c64b0008dd"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0e9e06adbca1fb660a8934c64b0008dd">G4GoudsmitSaundersonMscModel::par1</a></div><div class="ttdeci">G4double par1</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00208">G4GoudsmitSaundersonMscModel.hh:208</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a5b929b4a540635e9a850a1f330a70dfa"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b929b4a540635e9a850a1f330a70dfa">G4GoudsmitSaundersonMscModel::fZeff</a></div><div class="ttdeci">G4double fZeff</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00218">G4GoudsmitSaundersonMscModel.hh:218</a></div></div>
<div class="ttc" id="aG4Pow_8hh_html"><div class="ttname"><a href="../../df/db6/G4Pow_8hh.html">G4Pow.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_afdb6037f27b8a2e863ff1c04f006cd05"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdb6037f27b8a2e863ff1c04f006cd05">G4GoudsmitSaundersonMscModel::SampleScattering</a></div><div class="ttdeci">virtual G4ThreeVector &amp; SampleScattering(const G4ThreeVector &amp;, G4double safety)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00880">G4GoudsmitSaundersonMscModel.cc:880</a></div></div>
<div class="ttc" id="aG4Electron_8hh_html"><div class="ttname"><a href="../../d6/d69/G4Electron_8hh.html">G4Electron.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ac65577da8ca624dfeea91faeb501f0df"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac65577da8ca624dfeea91faeb501f0df">G4GoudsmitSaundersonMscModel::currentMaterialIndex</a></div><div class="ttdeci">G4int currentMaterialIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00221">G4GoudsmitSaundersonMscModel.hh:221</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html">G4VMscModel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00066">G4VMscModel.hh:66</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_acae58563f338bc90293fb73284f315cd"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acae58563f338bc90293fb73284f315cd">G4GoudsmitSaundersonMscModel::currentRange</a></div><div class="ttdeci">G4double currentRange</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00198">G4GoudsmitSaundersonMscModel.hh:198</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_adf07a51e4ad0b2b98777b1632d8bbbef"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#adf07a51e4ad0b2b98777b1632d8bbbef">G4GoudsmitSaundersonTable::GetMoliereXc2</a></div><div class="ttdeci">G4double GetMoliereXc2(G4int matindx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh_source.html#l00124">G4GoudsmitSaundersonTable.hh:124</a></div></div>
<div class="ttc" id="aclassG4ParticleDefinition_html"><div class="ttname"><a href="../../d5/d38/classG4ParticleDefinition.html">G4ParticleDefinition</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d12/G4ParticleDefinition_8hh_source.html#l00072">G4ParticleDefinition.hh:72</a></div></div>
<div class="ttc" id="aG4GoudsmitSaundersonTable_8hh_html"><div class="ttname"><a href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh.html">G4GoudsmitSaundersonTable.hh</a></div></div>
<div class="ttc" id="aclassG4IonisParamMat_html_a93f8394221b85fc063ba355b0a99a886"><div class="ttname"><a href="../../d6/d69/classG4IonisParamMat.html#a93f8394221b85fc063ba355b0a99a886">G4IonisParamMat::GetZeffective</a></div><div class="ttdeci">G4double GetZeffective() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d29/G4IonisParamMat_8hh_source.html#l00130">G4IonisParamMat.hh:130</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a8e28f34faea2aba8c2c9cf964ad5dba4"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e28f34faea2aba8c2c9cf964ad5dba4">G4GoudsmitSaundersonMscModel::fIsWasOnBoundary</a></div><div class="ttdeci">G4bool fIsWasOnBoundary</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00259">G4GoudsmitSaundersonMscModel.hh:259</a></div></div>
<div class="ttc" id="aG4Exp_8hh_html"><div class="ttname"><a href="../../d0/dcc/G4Exp_8hh.html">G4Exp.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html">G4GoudsmitSaundersonTable</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh_source.html#l00083">G4GoudsmitSaundersonTable.hh:83</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a5b542be7cec7d369810ebfca6b1255a9"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b542be7cec7d369810ebfca6b1255a9">G4GoudsmitSaundersonMscModel::fParticleChange</a></div><div class="ttdeci">G4ParticleChangeForMSC * fParticleChange</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00227">G4GoudsmitSaundersonMscModel.hh:227</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a64c8133d1fc62dc58148c163622d4123"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a64c8133d1fc62dc58148c163622d4123">G4GoudsmitSaundersonMscModel::Initialise</a></div><div class="ttdeci">virtual void Initialise(const G4ParticleDefinition *, const G4DataVector &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00254">G4GoudsmitSaundersonMscModel.cc:254</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a0f68e6a113b58712c64501fcd5a99d2c"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a0f68e6a113b58712c64501fcd5a99d2c">G4VMscModel::dtrl</a></div><div class="ttdeci">G4double dtrl</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00178">G4VMscModel.hh:178</a></div></div>
<div class="ttc" id="aG4Types_8hh_html_a30e1bdd7ba7cabef2ffe0e2560bfb2f5"><div class="ttname"><a href="../../de/d29/G4Types_8hh.html#a30e1bdd7ba7cabef2ffe0e2560bfb2f5">G4double</a></div><div class="ttdeci">double G4double</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d29/G4Types_8hh_source.html#l00075">G4Types.hh:75</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a2af7f0c2bd13a5b31d4a8e7ccc687aee"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a2af7f0c2bd13a5b31d4a8e7ccc687aee">G4VMscModel::facrange</a></div><div class="ttdeci">G4double facrange</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00174">G4VMscModel.hh:174</a></div></div>
<div class="ttc" id="aG4Types_8hh_html_adc66322b5328e4c3ed3038bc9f19f6f1"><div class="ttname"><a href="../../de/d29/G4Types_8hh.html#adc66322b5328e4c3ed3038bc9f19f6f1">G4bool</a></div><div class="ttdeci">bool G4bool</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d29/G4Types_8hh_source.html#l00078">G4Types.hh:78</a></div></div>
<div class="ttc" id="aG4GSPWACorrections_8hh_html"><div class="ttname"><a href="../../d5/dd0/G4GSPWACorrections_8hh.html">G4GSPWACorrections.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a9e467b325d1a8d5265219c6932440253"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9e467b325d1a8d5265219c6932440253">G4GoudsmitSaundersonMscModel::par3</a></div><div class="ttdeci">G4double par3</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00210">G4GoudsmitSaundersonMscModel.hh:210</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a94982fe9993810f1a2d82d93328502c5"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a94982fe9993810f1a2d82d93328502c5">G4GoudsmitSaundersonMscModel::fMCtoScrA</a></div><div class="ttdeci">G4double fMCtoScrA</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00241">G4GoudsmitSaundersonMscModel.hh:241</a></div></div>
<div class="ttc" id="aG4MscStepLimitType_8hh_html_a803174723dad550db3c7e4048e78c8b1a9561f7b73ec8f83e13780ddf70c0b9c5"><div class="ttname"><a href="../../d6/dec/G4MscStepLimitType_8hh.html#a803174723dad550db3c7e4048e78c8b1a9561f7b73ec8f83e13780ddf70c0b9c5">fUseSafetyPlus</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dec/G4MscStepLimitType_8hh_source.html#l00050">G4MscStepLimitType.hh:50</a></div></div>
<div class="ttc" id="aG4ThreeVector_8hh_html_a8a40941423af41c97f26abe9ccfe2bdd"><div class="ttname"><a href="../../d8/dbe/G4ThreeVector_8hh.html#a8a40941423af41c97f26abe9ccfe2bdd">G4ThreeVector</a></div><div class="ttdeci">CLHEP::Hep3Vector G4ThreeVector</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dbe/G4ThreeVector_8hh_source.html#l00041">G4ThreeVector.hh:41</a></div></div>
<div class="ttc" id="aG4SIunits_8hh_html_a4cbb5c4d46f05bf0db49503fb906cb34"><div class="ttname"><a href="../../d8/df2/G4SIunits_8hh.html#a4cbb5c4d46f05bf0db49503fb906cb34">twopi</a></div><div class="ttdeci">static constexpr double twopi</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df2/G4SIunits_8hh_source.html#l00075">G4SIunits.hh:75</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_af988cae764d49c9d98b8e9695a0e8d55"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af988cae764d49c9d98b8e9695a0e8d55">G4GoudsmitSaundersonMscModel::theManager</a></div><div class="ttdeci">G4LossTableManager * theManager</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00225">G4GoudsmitSaundersonMscModel.hh:225</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a5b4111bcb256cb6d08457ec5526fcc2b"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5b4111bcb256cb6d08457ec5526fcc2b">G4GoudsmitSaundersonMscModel::firstStep</a></div><div class="ttdeci">G4bool firstStep</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00223">G4GoudsmitSaundersonMscModel.hh:223</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a9ee52a80bda0ee6cb649c2456ea68ef0"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9ee52a80bda0ee6cb649c2456ea68ef0">G4GoudsmitSaundersonMscModel::geomlimit</a></div><div class="ttdeci">G4double geomlimit</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00203">G4GoudsmitSaundersonMscModel.hh:203</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a2c0f2785a378171f0230bc1103e8ced8"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a2c0f2785a378171f0230bc1103e8ced8">G4VMscModel::ComputeGeomLimit</a></div><div class="ttdeci">G4double ComputeGeomLimit(const G4Track &amp;, G4double &amp;presafety, G4double limit)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00254">G4VMscModel.hh:254</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a3c50fd12bc52ac742c680d649ae6c1e7"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3c50fd12bc52ac742c680d649ae6c1e7">G4GoudsmitSaundersonMscModel::fIsUsePWACorrection</a></div><div class="ttdeci">G4bool fIsUsePWACorrection</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00233">G4GoudsmitSaundersonMscModel.hh:233</a></div></div>
<div class="ttc" id="aG4EmParameters_8hh_html"><div class="ttname"><a href="../../d4/d30/G4EmParameters_8hh.html">G4EmParameters.hh</a></div></div>
<div class="ttc" id="aG4MscStepLimitType_8hh_html_a803174723dad550db3c7e4048e78c8b1ad4dc6dff8e78fa177567a42c154116e0"><div class="ttname"><a href="../../d6/dec/G4MscStepLimitType_8hh.html#a803174723dad550db3c7e4048e78c8b1ad4dc6dff8e78fa177567a42c154116e0">fUseDistanceToBoundary</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dec/G4MscStepLimitType_8hh_source.html#l00051">G4MscStepLimitType.hh:51</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a2158148859cd37125d8f58997a53509f"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2158148859cd37125d8f58997a53509f">G4GoudsmitSaundersonMscModel::fLambda1</a></div><div class="ttdeci">G4double fLambda1</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00237">G4GoudsmitSaundersonMscModel.hh:237</a></div></div>
<div class="ttc" id="aclassG4ParticleChangeForMSC_html_ab9fc294e979f3289b1ff49d41b4ad47a"><div class="ttname"><a href="../../d7/d2c/classG4ParticleChangeForMSC.html#ab9fc294e979f3289b1ff49d41b4ad47a">G4ParticleChangeForMSC::ProposeMomentumDirection</a></div><div class="ttdeci">void ProposeMomentumDirection(const G4ThreeVector &amp;Pfinal)</div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_aef7531a031d113e10570d33ec80bd1fd"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aef7531a031d113e10570d33ec80bd1fd">G4GoudsmitSaundersonMscModel::fPWACorrection</a></div><div class="ttdeci">G4GSPWACorrections * fPWACorrection</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00231">G4GoudsmitSaundersonMscModel.hh:231</a></div></div>
<div class="ttc" id="aclassG4Material_html_ad50823f82efe0e1798ac4e34d6829828"><div class="ttname"><a href="../../d5/de4/classG4Material.html#ad50823f82efe0e1798ac4e34d6829828">G4Material::GetIndex</a></div><div class="ttdeci">size_t GetIndex() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc8/G4Material_8hh_source.html#l00261">G4Material.hh:261</a></div></div>
<div class="ttc" id="aclassG4DynamicParticle_html_a8e748b292817a46bc4f7e2ad2fdad2bc"><div class="ttname"><a href="../../d7/d5c/classG4DynamicParticle.html#a8e748b292817a46bc4f7e2ad2fdad2bc">G4DynamicParticle::GetKineticEnergy</a></div><div class="ttdeci">G4double GetKineticEnergy() const</div></div>
<div class="ttc" id="aclassG4VEmModel_html_a76749999644bdee227e1c27db9e823d1"><div class="ttname"><a href="../../d3/dc1/classG4VEmModel.html#a76749999644bdee227e1c27db9e823d1">G4VEmModel::HighEnergyLimit</a></div><div class="ttdeci">G4double HighEnergyLimit() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d59/G4VEmModel_8hh_source.html#l00605">G4VEmModel.hh:605</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_aa7cced1d3f2f63626f2c1af963e06863"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#aa7cced1d3f2f63626f2c1af963e06863">G4GoudsmitSaundersonTable::Initialise</a></div><div class="ttdeci">void Initialise(G4double lownergylimit, G4double highenergylimit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/G4GoudsmitSaundersonTable_8cc_source.html#l00166">G4GoudsmitSaundersonTable.cc:166</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_ae65c331bb91c0ceaa7e62a95a2befff5"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#ae65c331bb91c0ceaa7e62a95a2befff5">G4VMscModel::facgeom</a></div><div class="ttdeci">G4double facgeom</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00175">G4VMscModel.hh:175</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a4270c1e89c1911e92de24d930881138e"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4270c1e89c1911e92de24d930881138e">G4GoudsmitSaundersonMscModel::fG1</a></div><div class="ttdeci">G4double fG1</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00239">G4GoudsmitSaundersonMscModel.hh:239</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_abbcfdfc97e9345da7ca7f1e20e0d4e4a"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abbcfdfc97e9345da7ca7f1e20e0d4e4a">G4GoudsmitSaundersonMscModel::fIsUseMottCorrection</a></div><div class="ttdeci">G4bool fIsUseMottCorrection</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00234">G4GoudsmitSaundersonMscModel.hh:234</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ad77ba4a828bd1aeaa2c0e4358c55e88d"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad77ba4a828bd1aeaa2c0e4358c55e88d">G4GoudsmitSaundersonMscModel::mass</a></div><div class="ttdeci">G4double mass</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00213">G4GoudsmitSaundersonMscModel.hh:213</a></div></div>
<div class="ttc" id="aG4StepStatus_8hh_html_aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f"><div class="ttname"><a href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a1565288cd0fba4d03a602033d4030b9f">fGeomBoundary</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d2e/G4StepStatus_8hh_source.html#l00053">G4StepStatus.hh:53</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a74d0f20f6c9d895fc08e8c37135176cd"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a74d0f20f6c9d895fc08e8c37135176cd">G4VMscModel::GetRange</a></div><div class="ttdeci">G4double GetRange(const G4ParticleDefinition *part, G4double kineticEnergy, const G4MaterialCutsCouple *couple)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00282">G4VMscModel.hh:282</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_a2bbac730b3592079b08aa522b7464c08"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a2bbac730b3592079b08aa522b7464c08">G4GoudsmitSaundersonTable::SingleScattering</a></div><div class="ttdeci">G4double SingleScattering(G4double lambdaval, G4double scra, G4double lekin, G4double beta2, G4int matindx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/G4GoudsmitSaundersonTable_8cc_source.html#l00514">G4GoudsmitSaundersonTable.cc:514</a></div></div>
<div class="ttc" id="aG4SIunits_8hh_html_a95b12ad94a86320bdf0a38c3e67ad604"><div class="ttname"><a href="../../d8/df2/G4SIunits_8hh.html#a95b12ad94a86320bdf0a38c3e67ad604">mm</a></div><div class="ttdeci">static constexpr double mm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df2/G4SIunits_8hh_source.html#l00114">G4SIunits.hh:114</a></div></div>
<div class="ttc" id="aclassG4Material_html"><div class="ttname"><a href="../../d5/de4/classG4Material.html">G4Material</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc8/G4Material_8hh_source.html#l00120">G4Material.hh:120</a></div></div>
<div class="ttc" id="aclassG4VEmModel_html_a451a8533c04280ef903052c654328902"><div class="ttname"><a href="../../d3/dc1/classG4VEmModel.html#a451a8533c04280ef903052c654328902">G4VEmModel::IsMaster</a></div><div class="ttdeci">G4bool IsMaster() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d59/G4VEmModel_8hh_source.html#l00696">G4VEmModel.hh:696</a></div></div>
<div class="ttc" id="aRandomize_8hh_html_a292914b2bf82aa2222afdd57c39609d1"><div class="ttname"><a href="../../dc/de9/Randomize_8hh.html#a292914b2bf82aa2222afdd57c39609d1">G4UniformRand</a></div><div class="ttdeci">#define G4UniformRand()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de9/Randomize_8hh_source.html#l00052">Randomize.hh:52</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a370b5cbccbbb384607400c528aade1e7"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a370b5cbccbbb384607400c528aade1e7">G4VMscModel::skin</a></div><div class="ttdeci">G4double skin</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00177">G4VMscModel.hh:177</a></div></div>
<div class="ttc" id="aclassG4Pow_html"><div class="ttname"><a href="../../de/d0f/classG4Pow.html">G4Pow</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/G4Pow_8hh_source.html#l00055">G4Pow.hh:55</a></div></div>
<div class="ttc" id="aclassG4DynamicParticle_html_a43d8d4d455904da067b031e60f46c220"><div class="ttname"><a href="../../d7/d5c/classG4DynamicParticle.html#a43d8d4d455904da067b031e60f46c220">G4DynamicParticle::GetDefinition</a></div><div class="ttdeci">G4ParticleDefinition * GetDefinition() const</div></div>
<div class="ttc" id="aclassG4VEmModel_html_a51adf718819d0e4194e5b003f6b7f0c4"><div class="ttname"><a href="../../d3/dc1/classG4VEmModel.html#a51adf718819d0e4194e5b003f6b7f0c4">G4VEmModel::SetCurrentCouple</a></div><div class="ttdeci">void SetCurrentCouple(const G4MaterialCutsCouple *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d59/G4VEmModel_8hh_source.html#l00451">G4VEmModel.hh:451</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_aff7737c4ceee8f5f193301fcaf396a11"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aff7737c4ceee8f5f193301fcaf396a11">G4GoudsmitSaundersonMscModel::par2</a></div><div class="ttdeci">G4double par2</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00209">G4GoudsmitSaundersonMscModel.hh:209</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_a4f0cee95adbf9bf1e10dced21e6d65ee"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a4f0cee95adbf9bf1e10dced21e6d65ee">G4GoudsmitSaundersonTable::Sampling</a></div><div class="ttdeci">G4bool Sampling(G4double lambdaval, G4double qval, G4double scra, G4double &amp;cost, G4double &amp;sint, G4double lekin, G4double beta2, G4int matindx, GSMSCAngularDtr **gsDtr, G4int &amp;mcekini, G4int &amp;mcdelti, G4double &amp;transfPar, G4bool isfirst)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/G4GoudsmitSaundersonTable_8cc_source.html#l00212">G4GoudsmitSaundersonTable.cc:212</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a884d80e9485723510bf7b6aed43b6b9e"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a884d80e9485723510bf7b6aed43b6b9e">G4GoudsmitSaundersonMscModel::ComputeTrueStepLength</a></div><div class="ttdeci">virtual G4double ComputeTrueStepLength(G4double geomStepLength)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00835">G4GoudsmitSaundersonMscModel.cc:835</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a3df868431631edc329befeb06c443d4c"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a3df868431631edc329befeb06c443d4c">G4GoudsmitSaundersonMscModel::G4GoudsmitSaundersonMscModel</a></div><div class="ttdeci">G4GoudsmitSaundersonMscModel(const G4String &amp;nam=&quot;GoudsmitSaunderson&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00163">G4GoudsmitSaundersonMscModel.cc:163</a></div></div>
<div class="ttc" id="aclassG4Pow_html_a1606c8b5588e4236b12b03470dbf3b06"><div class="ttname"><a href="../../de/d0f/classG4Pow.html#a1606c8b5588e4236b12b03470dbf3b06">G4Pow::GetInstance</a></div><div class="ttdeci">static G4Pow * GetInstance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d31/G4Pow_8cc_source.html#l00056">G4Pow.cc:56</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a96991d7a68ab47137a08962d53b1aa98"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a96991d7a68ab47137a08962d53b1aa98">G4GoudsmitSaundersonMscModel::fLambda0</a></div><div class="ttdeci">G4double fLambda0</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00236">G4GoudsmitSaundersonMscModel.hh:236</a></div></div>
<div class="ttc" id="aG4StepStatus_8hh_html_aa791f7281bd5358ced7457dc2c3daa75"><div class="ttname"><a href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75">G4StepStatus</a></div><div class="ttdeci">G4StepStatus</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d2e/G4StepStatus_8hh_source.html#l00048">G4StepStatus.hh:48</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ad5df18621e1f02205aaf3b14d7aa84d5"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad5df18621e1f02205aaf3b14d7aa84d5">G4GoudsmitSaundersonMscModel::currentKinEnergy</a></div><div class="ttdeci">G4double currentKinEnergy</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00197">G4GoudsmitSaundersonMscModel.hh:197</a></div></div>
<div class="ttc" id="aclassG4Material_html_a8acdb1b96f971b091d8dfaa4c998346d"><div class="ttname"><a href="../../d5/de4/classG4Material.html#a8acdb1b96f971b091d8dfaa4c998346d">G4Material::GetIonisation</a></div><div class="ttdeci">G4IonisParamMat * GetIonisation() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc8/G4Material_8hh_source.html#l00226">G4Material.hh:226</a></div></div>
<div class="ttc" id="aclassG4StepPoint_html"><div class="ttname"><a href="../../df/d47/classG4StepPoint.html">G4StepPoint</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9e/G4StepPoint_8hh_source.html#l00067">G4StepPoint.hh:67</a></div></div>
<div class="ttc" id="aG4StepStatus_8hh_html_aa791f7281bd5358ced7457dc2c3daa75a8375e7611f8dfb67c4e088f311afc082"><div class="ttname"><a href="../../d1/d2e/G4StepStatus_8hh.html#aa791f7281bd5358ced7457dc2c3daa75a8375e7611f8dfb67c4e088f311afc082">fUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d2e/G4StepStatus_8hh_source.html#l00065">G4StepStatus.hh:65</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_aa5a764c9fe2cecfa79939f956ef84c25"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa5a764c9fe2cecfa79939f956ef84c25">G4GoudsmitSaundersonMscModel::tlimitminfix2</a></div><div class="ttdeci">G4double tlimitminfix2</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00211">G4GoudsmitSaundersonMscModel.hh:211</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_af6cfcd49f2934ffb38e35bf8c15da7d0"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#af6cfcd49f2934ffb38e35bf8c15da7d0">G4GoudsmitSaundersonTable::SetOptionMottCorrection</a></div><div class="ttdeci">void SetOptionMottCorrection(G4bool val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh_source.html#l00131">G4GoudsmitSaundersonTable.hh:131</a></div></div>
<div class="ttc" id="aclassG4DynamicParticle_html"><div class="ttname"><a href="../../d7/d5c/classG4DynamicParticle.html">G4DynamicParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dab/G4DynamicParticle_8hh_source.html#l00072">G4DynamicParticle.hh:72</a></div></div>
<div class="ttc" id="aRandomize_8hh_html"><div class="ttname"><a href="../../dc/de9/Randomize_8hh.html">Randomize.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a2ff941d9b59dfa44163c1d036d96341d"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a2ff941d9b59dfa44163c1d036d96341d">G4GoudsmitSaundersonMscModel::fMCtoG2PerG1</a></div><div class="ttdeci">G4double fMCtoG2PerG1</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00243">G4GoudsmitSaundersonMscModel.hh:243</a></div></div>
<div class="ttc" id="anamespaceG4InuclParticleNames_html_a6e517fd44afc752751635505062dea27"><div class="ttname"><a href="../../db/d32/namespaceG4InuclParticleNames.html#a6e517fd44afc752751635505062dea27">G4InuclParticleNames::isElectron</a></div><div class="ttdeci">G4bool isElectron(G4int ityp)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/G4InuclParticleNames_8hh_source.html#l00083">G4InuclParticleNames.hh:83</a></div></div>
<div class="ttc" id="aclassG4GSPWACorrections_html"><div class="ttname"><a href="../../dd/d45/classG4GSPWACorrections.html">G4GSPWACorrections</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dd0/G4GSPWACorrections_8hh_source.html#l00061">G4GSPWACorrections.hh:61</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a7ebf1fa9cf19d4b0416b2b4ca7421d59"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7ebf1fa9cf19d4b0416b2b4ca7421d59">G4GoudsmitSaundersonMscModel::GetTransportMeanFreePathOnly</a></div><div class="ttdeci">G4double GetTransportMeanFreePathOnly(const G4ParticleDefinition *, G4double)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00423">G4GoudsmitSaundersonMscModel.cc:423</a></div></div>
<div class="ttc" id="aG4Exp_8hh_html_a224eb86aa032b59b4fa6398ea1eb566a"><div class="ttname"><a href="../../d0/dcc/G4Exp_8hh.html#a224eb86aa032b59b4fa6398ea1eb566a">G4Exp</a></div><div class="ttdeci">G4double G4Exp(G4double initial_x)</div><div class="ttdoc">Exponential Function double precision.</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dcc/G4Exp_8hh_source.html#l00182">G4Exp.hh:182</a></div></div>
<div class="ttc" id="aG4Track_8hh_html"><div class="ttname"><a href="../../d2/d83/G4Track_8hh.html">G4Track.hh</a></div></div>
<div class="ttc" id="aclassG4GSPWACorrections_html_adb8b21defb84149a64fa08a2aa7a9255"><div class="ttname"><a href="../../dd/d45/classG4GSPWACorrections.html#adb8b21defb84149a64fa08a2aa7a9255">G4GSPWACorrections::GetPWACorrectionFactors</a></div><div class="ttdeci">void GetPWACorrectionFactors(G4double logekin, G4double beta2, G4int matindx, G4double &amp;corToScr, G4double &amp;corToQ1, G4double &amp;corToG2PerG1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d93/G4GSPWACorrections_8cc_source.html#l00081">G4GSPWACorrections.cc:81</a></div></div>
<div class="ttc" id="aG4GoudsmitSaundersonMscModel_8hh_html"><div class="ttname"><a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh.html">G4GoudsmitSaundersonMscModel.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_acbf3eb70119f07e5b7d9fa045667965c"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#acbf3eb70119f07e5b7d9fa045667965c">G4GoudsmitSaundersonMscModel::InitialiseLocal</a></div><div class="ttdeci">virtual void InitialiseLocal(const G4ParticleDefinition *p, G4VEmModel *masterModel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00302">G4GoudsmitSaundersonMscModel.cc:302</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_af9f313ceedd3b3013723cc8a3e70cd08"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#af9f313ceedd3b3013723cc8a3e70cd08">G4GoudsmitSaundersonMscModel::fTheTransportDistance</a></div><div class="ttdeci">G4double fTheTransportDistance</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00246">G4GoudsmitSaundersonMscModel.hh:246</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a41c07d0a7c17fba9dce36d071d5c2bbc"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a41c07d0a7c17fba9dce36d071d5c2bbc">G4GoudsmitSaundersonMscModel::fTheTrueStepLenght</a></div><div class="ttdeci">G4double fTheTrueStepLenght</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00245">G4GoudsmitSaundersonMscModel.hh:245</a></div></div>
<div class="ttc" id="aG4Log_8hh_html"><div class="ttname"><a href="../../db/dfe/G4Log_8hh.html">G4Log.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_abb8f243baab6fc9990e7e5db6fc1f8a6"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#abb8f243baab6fc9990e7e5db6fc1f8a6">G4GoudsmitSaundersonMscModel::fIsEverythingWasDone</a></div><div class="ttdeci">G4bool fIsEverythingWasDone</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00255">G4GoudsmitSaundersonMscModel.hh:255</a></div></div>
<div class="ttc" id="aclassG4Step_html_abf249a440580353af39c451b956a3123"><div class="ttname"><a href="../../d9/d7a/classG4Step.html#abf249a440580353af39c451b956a3123">G4Step::GetPreStepPoint</a></div><div class="ttdeci">G4StepPoint * GetPreStepPoint() const</div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_a254f0b3dbe00ed848487074e6c656c63"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a254f0b3dbe00ed848487074e6c656c63">G4GoudsmitSaundersonTable::ComputeScatteringPowerCorrection</a></div><div class="ttdeci">G4double ComputeScatteringPowerCorrection(const G4MaterialCutsCouple *matcut, G4double ekin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/G4GoudsmitSaundersonTable_8cc_source.html#l00611">G4GoudsmitSaundersonTable.cc:611</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a748872bf7f725a7c0e18f2150bd2b05d"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a748872bf7f725a7c0e18f2150bd2b05d">G4GoudsmitSaundersonMscModel::SampleMSC</a></div><div class="ttdeci">void SampleMSC()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00925">G4GoudsmitSaundersonMscModel.cc:925</a></div></div>
<div class="ttc" id="aclassG4Track_html_a2b0222eb822b6b55224e379fd5813100"><div class="ttname"><a href="../../d1/d33/classG4Track.html#a2b0222eb822b6b55224e379fd5813100">G4Track::GetMaterialCutsCouple</a></div><div class="ttdeci">const G4MaterialCutsCouple * GetMaterialCutsCouple() const</div></div>
<div class="ttc" id="astructG4GoudsmitSaundersonTable_1_1GSMSCAngularDtr_html"><div class="ttname"><a href="../../df/d6e/structG4GoudsmitSaundersonTable_1_1GSMSCAngularDtr.html">G4GoudsmitSaundersonTable::GSMSCAngularDtr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh_source.html#l00092">G4GoudsmitSaundersonTable.hh:92</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_afff18354ea9648121bc4089bd22077ff"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afff18354ea9648121bc4089bd22077ff">G4GoudsmitSaundersonMscModel::rangeinit</a></div><div class="ttdeci">G4double rangeinit</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00201">G4GoudsmitSaundersonMscModel.hh:201</a></div></div>
<div class="ttc" id="aG4PhysicsTable_8hh_html"><div class="ttname"><a href="../../d1/d4b/G4PhysicsTable_8hh.html">G4PhysicsTable.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a031d7e2fbc91141c08b57a5f232b6e1b"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a031d7e2fbc91141c08b57a5f232b6e1b">G4GoudsmitSaundersonMscModel::lambdalimit</a></div><div class="ttdeci">G4double lambdalimit</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00204">G4GoudsmitSaundersonMscModel.hh:204</a></div></div>
<div class="ttc" id="aG4Positron_8hh_html"><div class="ttname"><a href="../../d9/d5f/G4Positron_8hh.html">G4Positron.hh</a></div></div>
<div class="ttc" id="anamespaceG4INCL_1_1Math_html_a053a361bf37b11d9d1b3eba566dac26f"><div class="ttname"><a href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a053a361bf37b11d9d1b3eba566dac26f">G4INCL::Math::max</a></div><div class="ttdeci">T max(const T t1, const T t2)</div><div class="ttdoc">brief Return the largest of the two arguments</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d89/G4INCLGlobals_8hh_source.html#l00112">G4INCLGlobals.hh:112</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a1778149540068158b10e85a557342de2"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a1778149540068158b10e85a557342de2">G4GoudsmitSaundersonMscModel::taulim</a></div><div class="ttdeci">G4double taulim</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00214">G4GoudsmitSaundersonMscModel.hh:214</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a7f9a63eeafbb5782e787f6da7a223588"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7f9a63eeafbb5782e787f6da7a223588">G4GoudsmitSaundersonMscModel::fScrA</a></div><div class="ttdeci">G4double fScrA</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00238">G4GoudsmitSaundersonMscModel.hh:238</a></div></div>
<div class="ttc" id="aG4SIunits_8hh_html_aa515e5d787460f9c978a23bd22140482"><div class="ttname"><a href="../../d8/df2/G4SIunits_8hh.html#aa515e5d787460f9c978a23bd22140482">eV</a></div><div class="ttdeci">static constexpr double eV</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df2/G4SIunits_8hh_source.html#l00214">G4SIunits.hh:214</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a82642fc90fca0e907249d79e6292e770"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a82642fc90fca0e907249d79e6292e770">G4VMscModel::steppingAlgorithm</a></div><div class="ttdeci">G4MscStepLimitType steppingAlgorithm</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00184">G4VMscModel.hh:184</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a600e9b362c8f5e4925a5ef7c93691522"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a600e9b362c8f5e4925a5ef7c93691522">G4GoudsmitSaundersonMscModel::rndmEngineMod</a></div><div class="ttdeci">CLHEP::HepRandomEngine * rndmEngineMod</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00195">G4GoudsmitSaundersonMscModel.hh:195</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a8e8c1212bf8ceb848c6c5b2ea5228bed"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8e8c1212bf8ceb848c6c5b2ea5228bed">G4GoudsmitSaundersonMscModel::fTheZPathLenght</a></div><div class="ttdeci">G4double fTheZPathLenght</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00247">G4GoudsmitSaundersonMscModel.hh:247</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_a6125bcf1649e2efd57b5a70b6acce545"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a6125bcf1649e2efd57b5a70b6acce545">G4GoudsmitSaundersonTable::SetOptionPWACorrection</a></div><div class="ttdeci">void SetOptionPWACorrection(G4bool val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc4/G4GoudsmitSaundersonTable_8hh_source.html#l00133">G4GoudsmitSaundersonTable.hh:133</a></div></div>
<div class="ttc" id="aG4PhysicalConstants_8hh_html"><div class="ttname"><a href="../../d4/d2b/G4PhysicalConstants_8hh.html">G4PhysicalConstants.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_aac9cd321f3ae4f9d362678aca961c2ce"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aac9cd321f3ae4f9d362678aca961c2ce">G4GoudsmitSaundersonMscModel::particle</a></div><div class="ttdeci">const G4ParticleDefinition * particle</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00226">G4GoudsmitSaundersonMscModel.hh:226</a></div></div>
<div class="ttc" id="aclassG4GSPWACorrections_html_abe44b021c1f92046e76261da4ea56e4d"><div class="ttname"><a href="../../dd/d45/classG4GSPWACorrections.html#abe44b021c1f92046e76261da4ea56e4d">G4GSPWACorrections::Initialise</a></div><div class="ttdeci">void Initialise()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d93/G4GSPWACorrections_8cc_source.html#l00111">G4GSPWACorrections.cc:111</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a0de90a47374946419b4f1d4d37521b3c"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a0de90a47374946419b4f1d4d37521b3c">G4GoudsmitSaundersonMscModel::ComputeTruePathLengthLimit</a></div><div class="ttdeci">virtual G4double ComputeTruePathLengthLimit(const G4Track &amp;track, G4double &amp;currentMinimalStep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00472">G4GoudsmitSaundersonMscModel.cc:472</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a8f9f5cba3f054410d4b9ef3187bd9cff"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a8f9f5cba3f054410d4b9ef3187bd9cff">G4GoudsmitSaundersonMscModel::Randomizetlimit</a></div><div class="ttdeci">G4double Randomizetlimit()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00280">G4GoudsmitSaundersonMscModel.hh:280</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ae8bfe11ee7e3e1eb5d2d80dcae5c6834"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae8bfe11ee7e3e1eb5d2d80dcae5c6834">G4GoudsmitSaundersonMscModel::~G4GoudsmitSaundersonMscModel</a></div><div class="ttdeci">virtual ~G4GoudsmitSaundersonMscModel()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00240">G4GoudsmitSaundersonMscModel.cc:240</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a6540d9e4f3ce8e6f0f1cecdc0be227fa"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a6540d9e4f3ce8e6f0f1cecdc0be227fa">G4VMscModel::GetEnergy</a></div><div class="ttdeci">G4double GetEnergy(const G4ParticleDefinition *part, G4double range, const G4MaterialCutsCouple *couple)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00302">G4VMscModel.hh:302</a></div></div>
<div class="ttc" id="aclassG4String_html"><div class="ttname"><a href="../../d5/d72/classG4String.html">G4String</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8b/examples_2extended_2parallel_2TopC_2ParN02_2AnnotatedFiles_2G4String_8hh_source.html#l00045">G4String.hh:45</a></div></div>
<div class="ttc" id="aG4Log_8hh_html_ae72e5c92ee3e3857a2617f563c9e0589"><div class="ttname"><a href="../../db/dfe/G4Log_8hh.html#ae72e5c92ee3e3857a2617f563c9e0589">G4Log</a></div><div class="ttdeci">G4double G4Log(G4double x)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/G4Log_8hh_source.html#l00229">G4Log.hh:229</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a9d10da21d2b8dc11665428a0fd55a4cc"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d10da21d2b8dc11665428a0fd55a4cc">G4GoudsmitSaundersonMscModel::fIsInsideSkin</a></div><div class="ttdeci">G4bool fIsInsideSkin</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00258">G4GoudsmitSaundersonMscModel.hh:258</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ae143fc0261a37150e3ffff83747ab28e"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae143fc0261a37150e3ffff83747ab28e">G4GoudsmitSaundersonMscModel::presafety</a></div><div class="ttdeci">G4double presafety</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00217">G4GoudsmitSaundersonMscModel.hh:217</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_a46dc2095f99aa583d34e0609a8223d4b"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#a46dc2095f99aa583d34e0609a8223d4b">G4VMscModel::GetParticleChangeForMSC</a></div><div class="ttdeci">G4ParticleChangeForMSC * GetParticleChangeForMSC(const G4ParticleDefinition *p=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/G4VMscModel_8cc_source.html#l00090">G4VMscModel.cc:90</a></div></div>
<div class="ttc" id="aclassG4EmParameters_html_a1d95771d48a26806a1bc223eec74367c"><div class="ttname"><a href="../../dc/d54/classG4EmParameters.html#a1d95771d48a26806a1bc223eec74367c">G4EmParameters::Instance</a></div><div class="ttdeci">static G4EmParameters * Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d31/G4EmParameters_8cc_source.html#l00069">G4EmParameters.cc:69</a></div></div>
<div class="ttc" id="aG4DynamicParticle_8hh_html"><div class="ttname"><a href="../../d3/dab/G4DynamicParticle_8hh.html">G4DynamicParticle.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ae4132d7075d870497622b7029bcd8d78"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ae4132d7075d870497622b7029bcd8d78">G4GoudsmitSaundersonMscModel::gIsOptimizationOn</a></div><div class="ttdeci">static G4bool gIsOptimizationOn</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00263">G4GoudsmitSaundersonMscModel.hh:263</a></div></div>
<div class="ttc" id="aclassG4Track_html_a9c38785aa1341e6bd9a268e49cb32884"><div class="ttname"><a href="../../d1/d33/classG4Track.html#a9c38785aa1341e6bd9a268e49cb32884">G4Track::GetStep</a></div><div class="ttdeci">const G4Step * GetStep() const</div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a4ed169a1645d6e1daa9e88d0a9f7d2f8"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a4ed169a1645d6e1daa9e88d0a9f7d2f8">G4GoudsmitSaundersonMscModel::fGSTable</a></div><div class="ttdeci">G4GoudsmitSaundersonTable * fGSTable</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00230">G4GoudsmitSaundersonMscModel.hh:230</a></div></div>
<div class="ttc" id="aclassG4Track_html_a07133cbb02b55a84c77ceed42ad387c6"><div class="ttname"><a href="../../d1/d33/classG4Track.html#a07133cbb02b55a84c77ceed42ad387c6">G4Track::GetDynamicParticle</a></div><div class="ttdeci">const G4DynamicParticle * GetDynamicParticle() const</div></div>
<div class="ttc" id="aclassG4VEmModel_html"><div class="ttname"><a href="../../d3/dc1/classG4VEmModel.html">G4VEmModel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d59/G4VEmModel_8hh_source.html#l00103">G4VEmModel.hh:103</a></div></div>
<div class="ttc" id="aG4Types_8hh_html_abe302bce7537dc7036cb11d827505004"><div class="ttname"><a href="../../de/d29/G4Types_8hh.html#abe302bce7537dc7036cb11d827505004">G4int</a></div><div class="ttdeci">int G4int</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d29/G4Types_8hh_source.html#l00077">G4Types.hh:77</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a5cc6974c7e1e888a5b06a1396f5ed696"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a5cc6974c7e1e888a5b06a1396f5ed696">G4GoudsmitSaundersonMscModel::StartTracking</a></div><div class="ttdeci">void StartTracking(G4Track *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00464">G4GoudsmitSaundersonMscModel.cc:464</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a35fb40bdf6f5b04c990c811f60ac93d7"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a35fb40bdf6f5b04c990c811f60ac93d7">G4GoudsmitSaundersonMscModel::currentCouple</a></div><div class="ttdeci">const G4MaterialCutsCouple * currentCouple</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00228">G4GoudsmitSaundersonMscModel.hh:228</a></div></div>
<div class="ttc" id="aG4SystemOfUnits_8hh_html"><div class="ttname"><a href="../../da/d91/G4SystemOfUnits_8hh.html">G4SystemOfUnits.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ad46fe4e0e306f62759c70e32c3a6de49"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad46fe4e0e306f62759c70e32c3a6de49">G4GoudsmitSaundersonMscModel::ComputeGeomPathLength</a></div><div class="ttdeci">virtual G4double ComputeGeomPathLength(G4double truePathLength)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00783">G4GoudsmitSaundersonMscModel.cc:783</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a6460673256e87b9759684f431f575421"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a6460673256e87b9759684f431f575421">G4GoudsmitSaundersonMscModel::fIsSingleScattering</a></div><div class="ttdeci">G4bool fIsSingleScattering</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00254">G4GoudsmitSaundersonMscModel.hh:254</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a9d7198d67dd67dc48ca16ab59d40407e"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a9d7198d67dd67dc48ca16ab59d40407e">G4GoudsmitSaundersonMscModel::fIsNoDisplace</a></div><div class="ttdeci">G4bool fIsNoDisplace</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00257">G4GoudsmitSaundersonMscModel.hh:257</a></div></div>
<div class="ttc" id="aG4ParticleChangeForMSC_8hh_html"><div class="ttname"><a href="../../d3/d63/G4ParticleChangeForMSC_8hh.html">G4ParticleChangeForMSC.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_afdf80f208046dc78c2a4845fd22074d9"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#afdf80f208046dc78c2a4845fd22074d9">G4GoudsmitSaundersonMscModel::tlimit</a></div><div class="ttdeci">G4double tlimit</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00205">G4GoudsmitSaundersonMscModel.hh:205</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a65d86facbe89c41743f891b216b82d90"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a65d86facbe89c41743f891b216b82d90">G4GoudsmitSaundersonMscModel::SetParticle</a></div><div class="ttdeci">void SetParticle(const G4ParticleDefinition *p)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00268">G4GoudsmitSaundersonMscModel.hh:268</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a164d1072bc69d0e89d10d01face34461"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a164d1072bc69d0e89d10d01face34461">G4GoudsmitSaundersonMscModel::fIsMultipleSacettring</a></div><div class="ttdeci">G4bool fIsMultipleSacettring</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00253">G4GoudsmitSaundersonMscModel.hh:253</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_aa87c45a31c3edb131304ca710f1f39b7"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#aa87c45a31c3edb131304ca710f1f39b7">G4GoudsmitSaundersonMscModel::CrossSectionPerVolume</a></div><div class="ttdeci">virtual G4double CrossSectionPerVolume(const G4Material *, const G4ParticleDefinition *, G4double kineticEnergy, G4double cutEnergy=0.0, G4double maxEnergy=DBL_MAX)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00311">G4GoudsmitSaundersonMscModel.cc:311</a></div></div>
<div class="ttc" id="aclassG4LossTableManager_html_a2f26d6edfd1d62ac3a714ac9f6bd6b9c"><div class="ttname"><a href="../../d9/d78/classG4LossTableManager.html#a2f26d6edfd1d62ac3a714ac9f6bd6b9c">G4LossTableManager::Instance</a></div><div class="ttdeci">static G4LossTableManager * Instance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/G4LossTableManager_8cc_source.html#l00118">G4LossTableManager.cc:118</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonTable_html_a276fd7be0fe9c6517eb395d6418e13d0"><div class="ttname"><a href="../../d6/de3/classG4GoudsmitSaundersonTable.html#a276fd7be0fe9c6517eb395d6418e13d0">G4GoudsmitSaundersonTable::GetMottCorrectionFactors</a></div><div class="ttdeci">void GetMottCorrectionFactors(G4double logekin, G4double beta2, G4int matindx, G4double &amp;mcToScr, G4double &amp;mcToQ1, G4double &amp;mcToG2PerG1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/G4GoudsmitSaundersonTable_8cc_source.html#l00543">G4GoudsmitSaundersonTable.cc:543</a></div></div>
<div class="ttc" id="aclassG4Pow_html_acc4e5905a9f7978839b7c4f89a738d50"><div class="ttname"><a href="../../de/d0f/classG4Pow.html#acc4e5905a9f7978839b7c4f89a738d50">G4Pow::powA</a></div><div class="ttdeci">G4double powA(G4double A, G4double y) const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/G4Pow_8hh_source.html#l00241">G4Pow.hh:241</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_ad6a9fc1399bdc67fce0bf84a7ab60c91"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#ad6a9fc1399bdc67fce0bf84a7ab60c91">G4VMscModel::facsafety</a></div><div class="ttdeci">G4double facsafety</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00176">G4VMscModel.hh:176</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a102ee0534dcf08f34ce0ef39d70c7f25"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a102ee0534dcf08f34ce0ef39d70c7f25">G4GoudsmitSaundersonMscModel::fIsEndedUpOnBoundary</a></div><div class="ttdeci">G4bool fIsEndedUpOnBoundary</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00252">G4GoudsmitSaundersonMscModel.hh:252</a></div></div>
<div class="ttc" id="aclassG4Track_html"><div class="ttname"><a href="../../d1/d33/classG4Track.html">G4Track</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d83/G4Track_8hh_source.html#l00075">G4Track.hh:75</a></div></div>
<div class="ttc" id="aclassG4DataVector_html"><div class="ttname"><a href="../../de/d4e/classG4DataVector.html">G4DataVector</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/G4DataVector_8hh_source.html#l00049">G4DataVector.hh:49</a></div></div>
<div class="ttc" id="anamespaceG4INCL_1_1Math_html_a7e5b5673e84734625f5fa63987e78310"><div class="ttname"><a href="../../d1/dbe/namespaceG4INCL_1_1Math.html#a7e5b5673e84734625f5fa63987e78310">G4INCL::Math::min</a></div><div class="ttdeci">T min(const T t1, const T t2)</div><div class="ttdoc">brief Return the smallest of the two arguments</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d89/G4INCLGlobals_8hh_source.html#l00117">G4INCLGlobals.hh:117</a></div></div>
<div class="ttc" id="aclassG4ParticleDefinition_html_a803f7e0537bd1c3baa8a4c3ddb69c7f5"><div class="ttname"><a href="../../d5/d38/classG4ParticleDefinition.html#a803f7e0537bd1c3baa8a4c3ddb69c7f5">G4ParticleDefinition::GetPDGCharge</a></div><div class="ttdeci">G4double GetPDGCharge() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d12/G4ParticleDefinition_8hh_source.html#l00124">G4ParticleDefinition.hh:124</a></div></div>
<div class="ttc" id="aG4LossTableManager_8hh_html"><div class="ttname"><a href="../../db/d97/G4LossTableManager_8hh.html">G4LossTableManager.hh</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a7c2ba8f29691d5a7471e0f71fa41c657"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7c2ba8f29691d5a7471e0f71fa41c657">G4GoudsmitSaundersonMscModel::tausmall</a></div><div class="ttdeci">G4double tausmall</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00212">G4GoudsmitSaundersonMscModel.hh:212</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ad4b06543de0dbb02071f9031ad16af30"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ad4b06543de0dbb02071f9031ad16af30">G4GoudsmitSaundersonMscModel::fIsNoScatteringInMSC</a></div><div class="ttdeci">G4bool fIsNoScatteringInMSC</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00256">G4GoudsmitSaundersonMscModel.hh:256</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_ac89f6edb92868d772811035e07d49a3c"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#ac89f6edb92868d772811035e07d49a3c">G4GoudsmitSaundersonMscModel::GetTransportMeanFreePath</a></div><div class="ttdeci">G4double GetTransportMeanFreePath(const G4ParticleDefinition *, G4double)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d89/G4GoudsmitSaundersonMscModel_8cc_source.html#l00368">G4GoudsmitSaundersonMscModel.cc:368</a></div></div>
<div class="ttc" id="aclassG4VMscModel_html_ac85e2508fa24259a19b0735b60cc02b9"><div class="ttname"><a href="../../d0/d99/classG4VMscModel.html#ac85e2508fa24259a19b0735b60cc02b9">G4VMscModel::ConvertTrueToGeom</a></div><div class="ttdeci">G4double ConvertTrueToGeom(G4double &amp;tLength, G4double &amp;gLength)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d61/G4VMscModel_8hh_source.html#l00244">G4VMscModel.hh:244</a></div></div>
<div class="ttc" id="anamespaceG4InuclParticleNames_html_a5712b6fd75643c96893b8ccba2c866bea9ccbad167e57928ae157f0033c2f44bc"><div class="ttname"><a href="../../db/d32/namespaceG4InuclParticleNames.html#a5712b6fd75643c96893b8ccba2c866bea9ccbad167e57928ae157f0033c2f44bc">G4InuclParticleNames::sp</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/G4InuclParticleNames_8hh_source.html#l00062">G4InuclParticleNames.hh:62</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a574642924c669d5bf14cf39b5dcd3739"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a574642924c669d5bf14cf39b5dcd3739">G4GoudsmitSaundersonMscModel::fTheDisplacementVector</a></div><div class="ttdeci">G4ThreeVector fTheDisplacementVector</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00249">G4GoudsmitSaundersonMscModel.hh:249</a></div></div>
<div class="ttc" id="aclassG4GoudsmitSaundersonMscModel_html_a7da3cc8c1e26a662323f1b0ef823809c"><div class="ttname"><a href="../../d9/d3b/classG4GoudsmitSaundersonMscModel.html#a7da3cc8c1e26a662323f1b0ef823809c">G4GoudsmitSaundersonMscModel::gIsUseAccurate</a></div><div class="ttdeci">static G4bool gIsUseAccurate</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/G4GoudsmitSaundersonMscModel_8hh_source.html#l00262">G4GoudsmitSaundersonMscModel.hh:262</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
