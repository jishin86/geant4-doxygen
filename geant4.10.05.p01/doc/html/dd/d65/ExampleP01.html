<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example P01</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example P01 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="P01_s1"></a>
General description</h1>
<p>This example shows how to store produced hits in a file using the 'reflection' technique for persistency provided by the Reflex tool included in ROOT. The Reflex tool allows to create a dictionary for the hit class, making then possible to save hit objects in a .root file. The general simulation setup (geometry, physics list, user actions, etc...) is taken from ExampleN02.</p>
<p>The provided makefile produces two executables: 'exampleP01' and 'readHits'. The first one is the actual Geant4 simulation application with hits persistency. The second one, is just a simple 'reader' for the produced .root file (you need to specify the name of the .root file as argument).</p>
<h1><a class="anchor" id="P01_s2"></a>
Building and running the example</h1>
<p>This examples requires the ROOT toolkit of version 6 to be installed. The provided CMake file checks for the existence of the package and its version. Once the CMake configuration has been succesfully done, the two executables for this example (exampleP01, readHits) should be built using make (in your CMake build directory): </p><pre class="fragment">make 
</pre><p>When the example is run (using the provided run.mac macro file) ten events are generated and the produced hits will be stored in the hits.root file. In addition, the hits will be printed out on the screen so one can then compare them with the 'reader' output.</p>
<p>In order to read the persistified hits, a small 'reader' application has been implemented. It can be run in the following way:</p>
<pre class="fragment">&lt;my_binary_directory&gt;/readHits hits.root
</pre><p>where the argument is the name of the file to be read. All the hits saved in that file will be then read and printed on the screen.</p>
<p>In addition to that the readHits.C ROOT macro file is provides, which illustrates how one can read the hits file directly from the ROOT prompt.</p>
<h1><a class="anchor" id="P01_s3"></a>
Remark on dictionary generation</h1>
<p>The dictionary is generated by ${ROOTSYS}/bin/genreflex tool. The header file including headers for all the classes we want to generate the dictionary for should be given as argument. Additionally, a so called selection file (xml) should be provided (with -s flag) to the genreflex tool (see the GNUmakefile). The role of this file is to specify which classes we want to generate the dictionary for. The selection file for our dictionary is in xml/ directory. Please refer to genreflex manual for more details concerning the usage of that tool. <br  />
</p>
<p>Concerning generating dictionary for the Geant4 objects, there are also two technical remarks that need to be made here. The Reflex tool requires all the templated classes to be explicitely used somewhere in the included header files in order for the generation of the dictionary to be possible. For those templated classes for which it is not the case, the problem can be very easily solved by instaciating them in the headerfile which is given to genreflex (see includes/ExP01Classes.hh) as argument. The second remark is that there is an unfortunate clash of names as far as <a class="el" href="../../d5/d72/classG4String.html">G4String</a> class is concerned. The header of <a class="el" href="../../d5/d72/classG4String.html">G4String</a> class defines __G4String which happens to be the name of a variable used within the generated dictionary code. The solution for that is to do #undef __G4String in <a class="el" href="../../d9/d26/ExP01Classes_8hh.html" title="Declaration of the classes for generating dictionaries.">include/ExP01Classes.hh</a> file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
