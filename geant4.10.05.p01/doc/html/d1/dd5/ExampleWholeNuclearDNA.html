<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example wholeNuclearDNA</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example wholeNuclearDNA </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>For any question, please contact: <br  />
C. Villagrasa <br  />
email: <a href="#" onclick="location.href='mai'+'lto:'+'car'+'me'+'n.v'+'il'+'lag'+'ra'+'sa@'+'ir'+'sn.'+'fr'; return false;">carme<span style="display: none;">.nosp@m.</span>n.vi<span style="display: none;">.nosp@m.</span>llagr<span style="display: none;">.nosp@m.</span>asa@<span style="display: none;">.nosp@m.</span>irsn.<span style="display: none;">.nosp@m.</span>fr</a> <br  />
 This example is provided by the Geant4-DNA collaboration Any report or published results obtained using the Geant4-DNA software and the <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> geometry given in the Geom_DNA example shall cite the following Geant4-DNA collaboration publications: <br  />
[1] NIM B 298 (2013) 47-54 <br  />
[2] Med. Phys. 37 (2010) 4692-4708 [3] Phys. Med. 31 (2015) 861-874</dd></dl>
<h1><a class="anchor" id="wholenucleardna_s1"></a>
INTRODUCTION</h1>
<p>The wholenucleardna example offers the basic tools to simulate the track structure of different charge particles within a simplified geometrical model of the <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> molecule contained in a cell nucleus. In this example, the <a class="el" href="../../dc/d5b/classDetectorConstruction.html" title="Simple detector construction with a box volume placed in a world.">DetectorConstruction</a> file contains the placement of the 6 Gbp (base-pairs) of a human cell respecting five compaction levels in the structure of the <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> molecule: double helix, nucleosome, chromatin fiber, simple chromatin fiber loop and complex chromatin fiber loops. These complex chromatin fiber loops are then used to fill the chromosome territories using a constant density (~30-31 kbp/µm3. Even though this geometry defines different volumes for the <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> base, the back-bone region or the histone proteins, the material filling all these volumes in the simulation is liquid water ("G4_WATER")</p>
<p>In order to simulate all the energy transfer points of the track at nanometric level, the Geant4-DNA physics processes and models are used. These processes and models are further described at: <a href="http://geant4-dna.org">http://geant4-dna.org</a></p>
<h1><a class="anchor" id="wholenucleardna_s2"></a>
GEOMETRY SET-UP</h1>
<p>As indicated in the introduction, the whole <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> molecule contained in a human cell with 5 different compaction levels is described in this geometry. In order to place the complex chromatin loops in each of the 43 chromosome territories, the files called "chromo-number.dat" are needed. These 43 chromosome territories are then placed in an ellipsoid that has the typical dimensions of a human fibroblast cell nucleus. All the volumes in the geometry are made of liquid water (G4_WATER material) despite of what they geometrically represent. <a class="el" href="../../de/d20/classParticles.html">Particles</a> are shot from a random (x,y)position covering the main central part of the cell nucleus and at z=2.99 µm from the center of the nucleus. This value allows the primary particle to be either inside the cell nucleus, either not far from the entrance surface so its energy loss before the cell nucleus entrance is negligible.</p>
<p>WARNING: By default, the bases are not built. To build the whole geometry, set the flag fBuildBases in <a class="el" href="../../dc/d5b/classDetectorConstruction.html" title="Simple detector construction with a box volume placed in a world.">DetectorConstruction</a> to true.</p>
<h1><a class="anchor" id="wholenucleardna_s3"></a>
SET-UP</h1>
<p>Make sure G4LEDATA points to the low energy electromagnetic data files.</p>
<p>The variable G4ANALYSIS_USE must be set to 1.</p>
<p>The code can be compiled with gmake.</p>
<h1><a class="anchor" id="wholenucleardna_s4"></a>
HOW TO RUN THE EXAMPLE</h1>
<p>In normal mode, without interactivity:</p>
<blockquote class="doxtable">
<p>wholeNuclearDNA </p>
</blockquote>
<p>In interactive mode, run:</p>
<blockquote class="doxtable">
<p>wholeNuclearDNA -gui -out </p>
</blockquote>
<p>The -gui option launches a user interface for interactivity The -out option create a root file (can be changed for other format). This option may also take argument to set the name of the file (name of the application by default):</p>
<blockquote class="doxtable">
<p>wholeNuclearDNA -gui -out MyFile </p>
</blockquote>
<p>The macro wholenucleardna.in is executed by default. A proton of 0.1 MeV is shot. This energy has been chosen because only a few minutes are needed for the proton to lose all its energy and thus the event to finish. Nevertheless, one should keep in mind that for this energy, protons do not traverse the whole cell nucleus width.</p>
<p>Visualization (DAWN) is not activated by default in wholenucleardna.mac. To get visualization, make sure to uncomment the #/control/execute vis.mac. We would like to warn the users that the time to visualize the whole <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> structure is extremely long.</p>
<p>To build the whole geometry, set the flag fBuildBases in <a class="el" href="../../dc/d5b/classDetectorConstruction.html" title="Simple detector construction with a box volume placed in a world.">DetectorConstruction</a> to true.</p>
<h1><a class="anchor" id="wholenucleardna_s5"></a>
PHYSICS</h1>
<p>This example uses the Geant4-DNA processes, using the <a class="el" href="../../da/df0/classG4EmDNAPhysics.html">G4EmDNAPhysics</a> constructor as in the dnaphysics example.</p>
<h1><a class="anchor" id="wholenucleardna_s6"></a>
SIMULATION OUTPUT AND RESULT ANALYSIS</h1>
<p>The output results consist in a wholenucleardna.root file, containing only the information about the energy transfers located in the backbone region of the <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> double helix. Both strands are distinguished with different flags (1 or 2):</p><ul>
<li>the type of particle for the current step</li>
<li>the type of process for the current step</li>
<li>the flag of the strand (1 or 2)</li>
<li>the track position of the current energy transfer (in nanometers)</li>
<li>the energy deposit corresponding to the energy transfer (in eV)</li>
<li>the total energy loss along the current step (in eV)</li>
<li>the step length (in nm)</li>
</ul>
<p>This file can be easily analyzed using for example the provided ROOT macro file plot.C; to do so : be sure to have ROOT installed on your machine be sure to be in the directory containing the ROOT files created by wholenucleardna copy plot.C into this directory from there, launch ROOT by typing root under your ROOT session, type in : .X plot.C to execute the macro file alternatively you can type directly under your session : root plot.C</p>
<p>The naming scheme on the displayed ROOT plots can be seen in the SteppingAction.cc file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
