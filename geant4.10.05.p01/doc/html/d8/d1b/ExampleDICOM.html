<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example DICOM</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example DICOM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The DICOM application has been originally developed by the Geant4 users: <br  />
Louis Archambault,(1)Luc Beaulieu, (2)Vincent Hubert-Tremblay.</p>
<ul>
<li>(1) Centre Hospitalier Universitaire de Quebec (CHUQ), <br  />
Hotel-Dieu de Quebec, departement de Radio-oncologie <br  />
11 cote du palais. Quebec, QC, Canada, G1R 2J6 <br  />
tel (418) 525-4444 #6720 <br  />
fax (418) 691 5268 <br  />
web : thomson.phy.ulaval.ca/phys_med <br  />
</li>
<li>(2) Universite Laval, Quebec (QC) Canada</li>
</ul>
<p>And it has been deeply reviewed by Pedro Arce in December 2007. <br  />
Very small changes by Stephane Chauvie in January 2008. <br  />
Stephane Chauvie, Oct 2009: changed Physics list; changes in DICOM read. <br  />
Stephane Chauvie and Andrea Armando; June 2010 adapted for reading whatever DICOM file <br  />
Jonathan Madsen, Nov 2013: updated DICOM to utilize multithreading now available in Geant4.10 <br  />
</p>
<h1><a class="anchor" id="DICOM_s0"></a>
NEW DICOM READER BASED ON DCMTK</h1>
<p>A new way to read DICOM files has been implemented since release 10.3, to avoid the often problems found by users when reading DICOM files. It can also read RT structures in DICOM format as well as RT plans. This utility uses the DCMTK (<a href="http://dicom.offis.de/dcmtk.php.en">http://dicom.offis.de/dcmtk.php.en</a>).</p>
<h1><a class="anchor" id="DICOM_s1"></a>
NEW DICOM HEAD Project</h1>
<p>A new DICOM Digital Head included by S. Guatelli (<a href="#" onclick="location.href='mai'+'lto:'+'sus'+'an'+'na@'+'uo'+'w.e'+'du'+'.au'; return false;">susan<span style="display: none;">.nosp@m.</span>na@u<span style="display: none;">.nosp@m.</span>ow.ed<span style="display: none;">.nosp@m.</span>u.au</a>) and V. Giacometti. Available since Geant4 10.4. The Digital model is documented in: Giacometti, V., Guatelli, S., Bazalova-Carter, M., Rosenfeld, A.B., Schulte, R.W., "Development of a high resolution voxelised head phantom for medical physics applications", (2017) Physica Medica, 33, pp. 182-188.</p>
<h1><a class="anchor" id="DICOM_s2"></a>
Introduction</h1>
<p>This example serves first to convert a DICOM file to a simple ASCII file, where the Hounsfield numbers are converted to materials and densities so that it can be used by GEANT4. It serves also to create a GEANT4 geometry based on the DICOM file information using the <a class="el" href="../../d6/da1/classG4PhantomParameterisation.html">G4PhantomParameterisation</a>.</p>
<p>You can find the phantom reproduced in the image PhantomCT.jpg. In the application the phantom is placed on a table.</p>
<h1><a class="anchor" id="DICOM_s3a"></a>
Installation OLD:</h1>
<ul>
<li>A standard Geant4 example GNUmakefile is provided <br  />
</li>
<li>Compile it with 'make'/'gmake'</li>
<li>A standard Geant4 example CMakeLists.txt is provided</li>
<li>Configure via cmake with 'cmake -DGeant4_DIR=/path_to_geant4_install/lib/Geant4-x.x.x /path/to/DICOM/source' then make</li>
</ul>
<h1><a class="anchor" id="DICOM_s3b"></a>
Installation NEW:</h1>
<p>You have to download and install DCMTK, see <a href="http://dicom.offis.de/dcmtk.php.en">http://dicom.offis.de/dcmtk.php.en</a> . At least you need version 3.6.1 or newer; the important thing is that you make sure it contains the dcmrt package. Then define the enviromental variable DCMTK_BASE_DIR to point to the directory where you have installed it. And to run it, you have to add to the enviromental variable LD_LIBRARY_PATH the path ${DCMTK_BASE_DIR}/lib (i.e. export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${DCMTK_BASE_DIR}/lib )</p>
<p>Then you have to set the enviromental variable DICOM_USE_DCMTK to 1.</p><ul>
<li>A standard Geant4 example GNUmakefile is provided, but have to uncomment the line <pre class="fragment">#DICOM_USE_DCMTK := true                                                             
</pre></li>
<li>Compile it with 'make'/'gmake'</li>
<li>A standard Geant4 example CMakeLists.txt is provided</li>
<li>Configure via cmake with <pre class="fragment"> 'cmake -DGeant4_DIR=/path_to_geant4_install/lib/Geant4-x.x.x \ 
        -DDCMTK_DIR=/path_to_dcmtk_install /path/to/DICOM/source' 
</pre> then make</li>
</ul>
<h1><a class="anchor" id="DICOM_s3c"></a>
CMake installation and inheriting from DICOM</h1>
<ul>
<li>Set the CMAKE_INSTALL_PREFIX (typically use the same install prefix as the Geant4 distribution)</li>
<li>Install the project</li>
<li>Installation will install libraries + DICOMConfig.cmake + other config files<ul>
<li>if DCMTK is enabled, will also install dicomReader library + icomReaderConfig.cmake and it's other config files</li>
</ul>
</li>
<li>In the new Geant4 application, add "find_package(DICOM REQUIRED)" to CMakeLists.txt<ul>
<li>(optionally) add "set(DICOM_DIR ${Geant4_DIR} CACHE PATH "Path to DICOM installation config files") to CMakeLists.txt
   - add "include_directories(${DICOM_INCLUDE_DIRS}) and link target to ${DICOM_LIBRARIES}</li>
<li>if DCMTK is enabled, DICOMConfig.cmake will include the DCMTK and dicomReader installations, i.e. there is not need for "find_package(dicomReader)" or "find_package(DCMTK)"</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="DICOM_s4"></a>
Run the example:</h1>
<ul>
<li>To run the environment variable G4LEDATA needs to be set, pointing to the low energy data base, and the G4LEVELGAMMADATA pointing to the PhotonEvaporation data base</li>
<li>batch mode: <pre class="fragment">DICOM run.mac 
</pre></li>
<li>interactive mode: <pre class="fragment">DICOM
</pre> the file vis.mac is read in order to visualise the phantom with OpenGL, DAWN or VRML</li>
<li>Environment variables:<ul>
<li>DICOM_CHANGE_MATERIAL_DENSITY<ul>
<li>set to the minimum density difference before making a separate material</li>
<li>e.g. if DenseBone is from &gt; 1.496 to &lt;= 1.654 and DICOM_CHANGE_MATERIAL_DENSITY=0.079 then DenseBone would be separated into DenseBone &gt; 1.496 to &lt;= 1.575 and DenseBone &gt; 1.575 to &lt;= 1.654</li>
</ul>
</li>
<li>DICOM_PARTIAL_PARAM<ul>
<li>set to 1 to build the partial build instead of regular or nested construction (see section 9)</li>
</ul>
</li>
<li>DICOM_NESTED_PARAM<ul>
<li>set to 1 to build the nested construction (see section 9; overridden by DICOM_PARTIAL_PARAM)</li>
</ul>
</li>
<li>DICOM_NTHREADS<ul>
<li>To set the number of threads (when G4MULTITHREADED is defined via GEANT4_BUILD_MULTITHREADED=ON during Geant4 source build)</li>
<li>Needs to be set to the number of desired threads, e.g. DICOM_NTHREADS=8 (default is 4 threads)</li>
</ul>
</li>
<li>DICOM_USE_HEAD<ul>
<li>set to 1 (export DICOM_USE_HEAD=1) to use the digital head phantom documented in Giacometti, V., Guatelli, S., Bazalova-Carter, M., Rosenfeld, A.B., Schulte, R.W., "Development of a high resolution voxelised head phantom for medical physics applications", (2017) Physica Medica, 33, pp. 182-188. To use this option, the DICOM library needs to be downloaded. This is distributed with the other Geant4 data files on the Geant4 Download site. For convenience of use, it is suggested to have the DICOM library directory in the DICOM Geant4 extended example or in the directory containing the DICOM executable. When using this option, 1) export DICOM_USE_HEAD=1 2) export DICOM_PATH=path/to/DICOM1.1/DICOM_HEAD - to use the full DICOM HEAD project or export DICOM_PATH=path/to/DICOM1.1/DICOM_HEAD_TEST - to use 4 DICOM files of the DICOM HEAD project. This option is useful for testing purposes. 3) THE DICOM_HEAD uses the OLD version of the Metadata files (see point 4a) Note 1: The Conversion of Hounsfield numbers to materials (point 5) is not used. The material is associated to the voxel in the Detector Construction without using the calibration curve.This happens because the DICOM project has already been segmented and cleaned from artefacts (see publication).</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="DICOM_s5"></a>
Metadata file:</h1>
<p>The old version of "Data.dat" is found in "Data.dat.old", when the project is configured with DICOM_USE_DCMTK=OFF, "Data.dat.old" is copied into the binary directory at "Data.dat".</p><ul>
<li>i.e. cp ${PROJECT_SOURCE_DIR}/Data.dat.old ${PROJECT_BINARY_DIR}/Data.dat</li>
</ul>
<p>The new version of "Data.dat" is found in "Data.dat.new", when the project is configured with DICOM_USE_DCMTK=ON, "Data.dat.new" is copied into the binary directory as "Data.dat".</p><ul>
<li>i.e. cp ${PROJECT_SOURCE_DIR}/Data.dat.new ${PROJECT_BINARY_DIR}/Data.dat</li>
</ul>
<h1><a class="anchor" id="DICOM_s5a"></a>
Metadata file, OLD version:</h1>
<p>The file Data.dat has the following information</p><ul>
<li>A line with the compression value (used only to create the .g4dcm and .g4dcmb, not to read it)</li>
<li>A line with the number of files</li>
<li>A line for each file name (to these names it will be added the suffix .dcm to read the DICOM files in their original format, and the suffix .g4dcm to read the text files that contain the DICOM information where the Hounsfield numbers have been converted to material and densities)</li>
</ul>
<p>In case you want to convert DICOM files to text files, it must have the following lines:</p><ul>
<li>The number of materials you want to use</li>
<li>A line for each material describing its name and the upper bound of the density interval. The materials should be described in increasing order of density. The voxels with a density between 0. and the first upper bound will be assigned to the first material, those with a density between the first upper bound and the second upper bound will be assigned to the second material, etc.</li>
</ul>
<h1><a class="anchor" id="DICOM_s5b"></a>
Metadata file, NEW version (based on DCMTK):</h1>
<p>As for the previous version, a Data.dat file has to be defined to manage the conversion options. The format of this file is though quite different from the previous version. The format of this file is based on tags (similary to the ASCII geometry files). The following tags should be used:</p>
<h2><a class="anchor" id="DICOM_s5b_sub1"></a>
:COMPRESSION level</h2>
<p>Where "level" is the number of voxels that will be merged into one in the X and Y dimen- sions. The Hounsfield numbers of the voxels merged are averaged to give the resulting value for the new voxel.<br  />
Example: </p><pre class="fragment">:COMPRESSION 4 
</pre><p> 4 X 4 voxels will be merged, so that the number of voxels in X and Y dimensions will be reduced by a factor 4</p>
<h2><a class="anchor" id="DICOM_s5b_sub2"></a>
:FILE file_name</h2>
<p>These are the list of files (one line per file) in DICOM format that will be treated. They can be of modality CT, RTSTRUCT or RTPLAN (the code will automatically detect its modality and treat it correspondingly).<br  />
Example: </p><pre class="fragment">:FILE 1.dcm
:FILE 2.dcm
:FILE 3.dcm
</pre><h2><a class="anchor" id="DICOM_s5b_sub3"></a>
:CT2D  Hounsfield_number density</h2>
<p>These sets of value pairs build the calibration curve (linearly interpolating between them). In other words, each Hounsfield number is given a material density using a function that is built interpolating between this list of value pairs.<br  />
Example: </p><pre class="fragment">:CT2D -5000 0. 
:CT2D -1000 0.01 
:CT2D -400 0.602 
:CT2D  300 1.145 
:CT2D 2000 1.856
</pre><h2><a class="anchor" id="DICOM_s5b_sub4"></a>
:MATE material_name upper_bound_of_material_Hounsfield_number_interval</h2>
<p>This serves for the Hounsfield number to material name conversion. The voxels with a Hounsfield number between 0. and the first upper bound will be assigned to the first material, those with a Hounsfiled number between the first upper bound and the second upper bound will be assigned to the second material, etc.<br  />
Example: </p><pre class="fragment">:MATE G4_AIR -800
:MATE G4_LUNG_ICRP -145
:MATE G4_ADIPOSE_TISSUE_ICRP -60
:MATE G4_WATER 0
</pre><p>Alternatively to the use of :MATE, you can use the :MATE_DENS </p>
<h2><a class="anchor" id="DICOM_s5b_sub5"></a>
:MATE_DENS material_name upper_bound_of_material_density_interval</h2>
<p>This serves for the material density to material name conversion. The voxels with a density between 0. and the first upper bound will be assigned to the first material, those with a density between the first upper bound and the second upper bound will be assigned to the second material, etc.<br  />
Example: </p><pre class="fragment">:MATE_DENS G4_AIR 0.207
:MATE_DENS G4_LUNG_ICRP 0.919
:MATE_DENS G4_ADIPOSE_TISSUE_ICRP 0.979
:MATE_DENS G4_WATER 1.01
</pre><p>We recommend the use of :MATE instead of :MATE_DENS as this is the way is used more often in the literature.</p>
<h2><a class="anchor" id="DICOM_s5b_sub6"></a>
:FILE_OUT file_name</h2>
<p>Name of output file containing the DICOM information in ASCII format</p>
<h1><a class="anchor" id="DICOM_s6"></a>
Conversion of Hounsfield numbers to materials:</h1>
<p>After reading the name of files from Data.dat, if a file .dcm is found, then it looks for the corresponding .g4dcm file and if not found creates it. Each file corresponds to a Z slice. The Z slices will be merged at runtime to form a unique patient volume; therefore the different slices have to be contiguous in Z.</p>
<p>The DICOM images pixel values represent CT (Hounsfield) numbers and they should be converted, first, to a given density and then to a material type. The relation between CT number and density is more or less linear. The file CT2Density.dat contains the calibration curve to convert CT (Hounsfield) number to physical density The assignment of material densities to materials is done following the information from the file Data.dat (see below). In this case we have used:</p>
<pre>
           #####################################################
           #     Density Range                   Material      #
           #---------------------------------------------------#
           #       mg/cm3                            -         #
           #---------------------------------------------------#
           #  [ 0.    , 0.207 )                 Air            #
           #  [ 0.207 , 0.481 )                 Lungs (inhale) #
           #  [ 0.481 , 0.919 )                 Lungs (exhale) #
           #  [ 0.919 , 0.979 )                 Adipose        #
           #  [ 0.979 , 1.004 )                 Breast         #
           #  [ 1.004 , 1.043 )                 Phantom        #
           #  [ 1.043 , 1.109 )                 Liver          #
           #  [ 1.109 , 1.113 )                 Muscle         #
           #  [ 1.113 , 1.496 )                 Trabecular Bone#
           #  [ 1.496 , 1.654 ]                 Dense Bone     #
           #####################################################
</pre><p>Data taken from the International Commission on Radiation Units and measurements (ICRU) report 46 was used to build the materials (lung, liver, breast, bones, ...)</p>
<h1><a class="anchor" id="DICOM_s7"></a>
Splitting materials in density intervals:</h1>
<p>In the class <a class="el" href="../../d8/d5f/classDicomDetectorConstruction.html">DicomDetectorConstruction</a>, it is defined a density interval</p>
<pre class="fragment">G4double densityDiff = 0.1;
</pre><p>This means that the voxels of each material will be grouped in density intervals of 0.1 g/cm3 and a new material will be created for each group of voxels.</p>
<h1><a class="anchor" id="DICOM_s8"></a>
Voxel colouring:</h1>
<p>The file Colormap.dat defines the colour that will be assigned to the voxels of each material.</p>
<h1><a class="anchor" id="DICOM_s9"></a>
DICOM file formats:</h1>
<p>The DICOM files are converted to a simple text format. You may create your own file with the following format (see e.g. 14196616.g4dcm):</p>
<ul>
<li>A line with the number of materials</li>
<li>A line for each material with its index and name (the same name of materials that you construct as <a class="el" href="../../d5/de4/classG4Material.html">G4Material</a>'s)</li>
<li>A line with the number of voxels in X, Y and Z</li>
<li>A line with the minimum and maximum extension in X (mm)</li>
<li>A line with the minimum and maximum extension in Y (mm)</li>
<li>A line with the minimum and maximum extension in Z (mm)</li>
<li>A number of lines containing the nVoxelX*nVoxelY*nVoxelZ material indices (one per voxel)</li>
<li>A number of lines containing the nVoxelX*nVoxelY*nVoxelZ material densities (one per voxel)</li>
</ul>
<p>As commented before the DICOM files (.dcm) are assumed to describe one Z slice per file, and therefore the GEANT4 text files (.g4dcm) created from them have also one unique Z slice per file. Nevertheless if you create your own .g4dcm file you may include as many Z slices as desired. In any case you have to respect the rule that the Z slices must be contiguous.</p>
<p>The same information is also used to fill a file in binary format, that contains the same information as the text format. Its name ends in .g4dcmb, instead of .g4dcm .</p>
<h1><a class="anchor" id="DICOM_s10"></a>
Choosing different parameterisation/navigation options:</h1>
<p>There are four possible ways in GEANT4 to treat the navigation in regular voxelised volumes:</p>
<ol type="1">
<li>The 3D optimisation with G4SmartVoxel: a 3D grid is built, so that the location of voxels is fast, but it requires a lot of memory</li>
<li>Using G4NestedParameterisation. The search is done hierarchically in X, Y and Z. It is fast and does not require big memory</li>
<li>Using G4PhantomParameterisation/G4RegularNavigation: an special algorithm to navigate in regular voxelised geometries (see GEANT4 doc). This is the fastest way without any extra memory requirement (and it is the default in this example). It includes an option (default) to skip frontiers between voxels when they have the same material. When using this option at each step the energy is all deposited in the last voxel; for properly distribution of the dose (=energy/volume) the G4PSDoseDeposit_RegNav scorer can be used (see below)</li>
</ol>
<p>Obsolete option:</p><ol type="1">
<li>The 1D optimisation . It will be very slow because each time a track exits a voxel it has to loop to all other voxels to know which one it may enter</li>
</ol>
<p>You can select among the four options in the following way:</p>
<ul>
<li>By default the example will run with <a class="el" href="../../d7/d97/classG4RegularNavigation.html">G4RegularNavigation</a></li>
<li>To use the first option at RegularDicomDetectorConstruction.cc you just have to set <pre class="fragment">patient_phys-&gt;SetRegularStructureId(0);
</pre></li>
<li>To use the second option (Nested Parameterisation) you must set the enviromental variable DICOM_NESTED_PARAM to 1</li>
<li>To use the final, obsolete 1D-option, apart from the change above at RegularDicomDetectorConstructio\ n.cc you need to replace (i.e. use kUndefined) <pre class="fragment">G4PVParameterised* patient_phys 
  = new G4PVParameterised("Patient",voxel_logic,container_logic,
                          kXAxis, nVoxelX*nVoxelY*nVoxelZ, param);
</pre> by <pre class="fragment">G4PVParameterised * patient_phys 
  = new G4PVParameterised("Patient",voxel_logic,container_logic,
                          kUndefined, nVoxelX*nVoxelY*nVoxelZ, param);
</pre></li>
</ul>
<p>Note also you must <em>not</em> set the enviromental variable DICOM_NESTED_PARAM.</p>
<h1><a class="anchor" id="DICOM_s11"></a>
Calculating dose in phantom voxels for regular navigation</h1>
<p>As mentioned above the regular navigation has the option to keip voxel frontiers when two voxels share the same material, what can make the CPU time several times smaller. But this option makes that all energy deposited is computed in the last voxel, instead of distributing it along the voxels traversed. To properly calculate the dose in each voxel the G4PSDoseDeposit_RegNav scorer can be used.</p>
<p>It takes into account the fact that, when the particle travels through the voxels it looses energy and therefore the energy lost per length (dEdx) is bigger and also the effect of the multiple scattering is bigger. The algorithm to make this correction is an iterative one, as the step length increase due multiple scattering (that converts the geometrical step length in what we will call the true step length) and the energy loss are correlated. It works in the folloing way: first the total true step length is distributed among the voxels proportionally to their geometrical step length; with these values it is calculated one voxel after another the value of dEdx and then the value of the kinetic energy at the entrance of each voxel; with these values it is calculated the geometrical to true step corrections due to multiple scattering for each voxel; finally these new values are used to recalculate the energy lost in each voxel. It has been demonstrated for dose in a water phantom and in a real phantom that the two-step iteration described is enough to reproduce the dose calcualted when no skipping of voxel frontiers is done.</p>
<p>This scorer is implemented in this examples if the regular navigation option is chosen. It is triggered at the method RegularDicomDetectorConstruction::ConstructPhantom() by the call </p><pre class="fragment">SetScorer(voxel_logic);
</pre><h1><a class="anchor" id="DICOM_s12"></a>
Output</h1>
<p>dicom.out is produced running the macro file run.mac. It has 2 columns: the first is the number of voxel (ordered in x,y,z) and the second the dose there deposited (in Gy) It is produced, as an example, with a compression value of 32</p>
<h1><a class="anchor" id="DICOM_s13"></a>
Partial phantom</h1>
<p>It is possible to create a partial phantom, that is the intersection of a phantom with a volume. You may define the volume with the command</p>
<pre class="fragment">/dicom/intersectWithUserVolume 0. 0. 0. 45.*deg 0. 0. TUBE 0. 150. 100.
</pre><p>where the first three arguments are its position, its second three arguments are the rotation around the global X, Y and Z axis and the rest of the parameters are the same that you use to build a solid using the ASCII geometry format</p>
<p>Alternatively you can intersect the phantom with an existing Geant4 volume with the command</p>
<pre class="fragment">/dicom/intersectWithG4Volume VOLUME_NAME
</pre><p>The job will create an ASCII file names "phantom.g4pdcm" containing the partial phantom. To read this file all what is needed is to set the enviromental variable DICOM_PARTIAL_PARAM to 1</p>
<h1><a class="anchor" id="DICOM_s14"></a>
Visualisation</h1>
<p>The Geant4 drivers are not meant for visualizing millions of voxel and visualising the DICOM geometries can be very computationally demanding. The users may want to visualise each DICOM slice separately or use higher compression values when visualising a part of DICOM project. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
