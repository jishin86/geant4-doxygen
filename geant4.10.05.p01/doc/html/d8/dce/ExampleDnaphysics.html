<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example dnaphysics</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example dnaphysics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>S. Incerti (a, *), V. Ivantchenko (b), M. Karamitros (a) <br  />
a. Centre d'Etudes Nucleaires de Bordeaux-Gradignan <br  />
(CENBG), IN2P3 / CNRS / Bordeaux 1 University, 33175 Gradignan, France <br  />
b. G4AI Ltd., UK e-mail:<a href="#" onclick="location.href='mai'+'lto:'+'inc'+'er'+'ti@'+'ce'+'nbg'+'.i'+'n2p'+'3.'+'fr'; return false;">incer<span style="display: none;">.nosp@m.</span>ti@c<span style="display: none;">.nosp@m.</span>enbg.<span style="display: none;">.nosp@m.</span>in2p<span style="display: none;">.nosp@m.</span>3.fr</a> <br  />
 </dd></dl>
<h1><a class="anchor" id="dnaphysics_s1"></a>
INTRODUCTION.</h1>
<p><br  />
</p>
<p>The dnaphysics example shows how to simulate track structures in liquid water using the Geant4-DNA physics processes and models.</p>
<p>Below 1 MeV, Geant4-DNA models are used while, above this energy, <a class="el" href="../../de/d99/classG4EmStandardPhysics__option4.html">G4EmStandardPhysics_option4</a> models are used.</p>
<p>The Geant4-DNA processes and models are further described at: <a href="http://geant4-dna.org">http://geant4-dna.org</a></p>
<p>Any report or published results obtained using the Geant4-DNA software shall cite the following Geant4-DNA collaboration publications: Med. Phys. 45, e722-e739 (2018) Phys. Med. 31 (2015) 861-874 Med. Phys. 37 (2010) 4692-4708 Int. J. Model. Simul. Sci. Comput. 1 (2010) 157â€“178</p>
<h1><a class="anchor" id="dnaphysics_s2"></a>
GEOMETRY SET-UP</h1>
<p>The geometry is a 100-micron side cube (World) made of liquid water (G4_WATER material). <a class="el" href="../../de/d20/classParticles.html">Particles</a> are shot from the center of the volume.</p>
<p>The variable density feature of materials is illustrated.</p>
<p>Material can be changed directly in dna.mac macro file.</p>
<h1><a class="anchor" id="dnaphysics_s3"></a>
SET-UP</h1>
<p>Make sure $G4LEDATA points to the low energy electromagnetic data files.</p>
<p>The code can be compiled with cmake.</p>
<p>It works in MT mode.</p>
<h1><a class="anchor" id="dnaphysics_s4"></a>
HOW TO RUN THE EXAMPLE</h1>
<p><br  />
</p>
<p>In interactive mode, run:</p>
<pre class="fragment">./dnaphysics
</pre><p>In batch, the macro dnaphysics.in can be used. It shows how to shoot different particle types.</p>
<p>The combination of <a class="el" href="../../de/d99/classG4EmStandardPhysics__option4.html">G4EmStandardPhysics_option4</a> and Geant4-DNA models in the World is activated thanks to the following UI command in dnaphysics.in:</p>
<pre class="fragment">/process/em/AddDNARegion World DNA_Opt0
</pre><p>For now, only the "DNA_Opt0" configuration is allowed.</p>
<h1><a class="anchor" id="dnaphysics_s5"></a>
PHYSICS</h1>
<p>This example shows:</p><ul>
<li>how to use the Geant4-DNA models, which are activated automatically at low energy, below 1 MeV, and <a class="el" href="../../de/d99/classG4EmStandardPhysics__option4.html">G4EmStandardPhysics_option4</a> models above (look at the PhysicsList.cc file)</li>
<li>how to count and save occurrences of processes (look at the SteppingAction.cc file)</li>
</ul>
<p>Alternatively, the direct usage of Geant4-DNA physics constructors is also shown in comment in the PhysicsList.cc file.</p>
<h1><a class="anchor" id="dnaphysics_s6"></a>
SIMULATION OUTPUT AND RESULT ANALYSIS</h1>
<p><br  />
</p>
<p>The output results consists in a dna.root file, containing for each simulation step:</p><ul>
<li>the type of particle for the current step</li>
<li>the type of process for the current step</li>
<li>the track position of the current step (in nanometers)</li>
<li>the energy deposit along the current step (in eV)</li>
<li>the step length (in nm)</li>
<li>the total energy loss along the current step (in eV)</li>
<li>the kinetic energy at PreStepPoint</li>
<li>the cos of the scattering angle</li>
<li>the event ID</li>
<li>the track ID</li>
<li>the parent track ID</li>
<li>the step number</li>
</ul>
<p>This file can be easily analyzed using for example the provided ROOT macro file plot.C; to do so : be sure to have ROOT installed on your machine be sure to be in the directory containing the ROOT files created by dnaphysics copy plot.C into this directory from there, launch ROOT by typing root under your ROOT session, type in : .X plot.C to execute the macro file alternatively you can type directly under your session : root plot.C</p>
<p>The naming scheme on the displayed ROOT plots is as follows (see SteppingAction.cc):</p>
<p>This is the same naming scheme as in the "microdosimetry" advanced example.</p>
<ul>
<li>particles: <br  />
gamma : 0 <br  />
 e- : 1 <br  />
 proton : 2 <br  />
hydrogen : 3 <br  />
alpha : 4 <br  />
alpha+ : 5 <br  />
helium : 6 <br  />
<br  />
</li>
<li>processes: <br  />
 eCapture 1 <br  />
(only if one uses <a class="el" href="../../dc/d47/classG4EmDNAPhysicsActivator.html">G4EmDNAPhysicsActivator</a> in <a class="el" href="../../d2/daa/classPhysicsList.html">PhysicsList</a>)</li>
</ul>
<p>e-_G4DNAElectronSolvation 10 <br  />
e-_G4DNAElastic 11 <br  />
e-_G4DNAExcitation 12 <br  />
e-_G4DNAIonisation 13 <br  />
e-_G4DNAAttachment 14 <br  />
e-_G4DNAVibExcitation 15 <br  />
msc 110 <br  />
CoulombScat 120 <br  />
eIoni 130 <br  />
 <br  />
 proton_G4DNAElastic 21 <br  />
proton_G4DNAExcitation 22 <br  />
proton_G4DNAIonisation 23 <br  />
proton_G4DNAChargeDecrease 24 <br  />
msc 210 <br  />
CoulombScat 220 <br  />
hIoni 230 <br  />
nuclearStopping 240 <br  />
 <br  />
 hydrogen_G4DNAElastic 31 <br  />
hydrogen_G4DNAExcitation 32 <br  />
hydrogen_G4DNAIonisation 33 <br  />
hydrogen_G4DNAChargeIncrease 35 <br  />
 <br  />
 alpha_G4DNAElastic 41 <br  />
alpha_G4DNAExcitation 42 <br  />
alpha_G4DNAIonisation 43 <br  />
alpha_G4DNAChargeDecrease 44 <br  />
msc 410 <br  />
CoulombScat 420 <br  />
ionIoni 430 <br  />
nuclearStopping 440 <br  />
 <br  />
 alpha+_G4DNAElastic 51 <br  />
alpha+_G4DNAExcitation 52 <br  />
alpha+_G4DNAIonisation 53 <br  />
alpha+_G4DNAChargeDecrease 54 <br  />
alpha+_G4DNAChargeIncrease 55 <br  />
msc 510 <br  />
CoulombScat 520 <br  />
hIoni 530 <br  />
nuclearStopping 540 <br  />
 helium_G4DNAElastic 61 <br  />
helium_G4DNAExcitation 62 <br  />
helium_G4DNAIonisation 63 <br  />
helium_G4DNAChargeIncrease 65 <br  />
 <br  />
 GenericIon_G4DNAIonisation 73 <br  />
msc 710 <br  />
CoulombScat 720 <br  />
ionIoni 730 <br  />
nuclearStopping 740 <br  />
 <br  />
 </p><hr  />
<p>Should you have any enquiry, please do not hesitate to contact: <a href="#" onclick="location.href='mai'+'lto:'+'inc'+'er'+'ti@'+'ce'+'nbg'+'.i'+'n2p'+'3.'+'fr'; return false;">incer<span style="display: none;">.nosp@m.</span>ti@c<span style="display: none;">.nosp@m.</span>enbg.<span style="display: none;">.nosp@m.</span>in2p<span style="display: none;">.nosp@m.</span>3.fr</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
