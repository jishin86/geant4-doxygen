<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example neuron</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example neuron </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Authors</dt><dd>M. Batmunkh *(a,b), O.V. Belov *(a) <br  />
(a) Laboratory of Radiation Biology, Joint Institute for Nuclear Research (JINR), 6 Joliot-Curie St., 141980 Dubna, Moscow Region, Russia <br  />
(b) Division of Natural Sciences, National University of Mongolia (NUM), 1 University St., 210646 Ulaanbaatar, Mongolia <br  />
 Corresponding authors, email to <a href="#" onclick="location.href='mai'+'lto:'+'bat'+'mu'+'nkh'+'@j'+'inr'+'.r'+'u'; return false;">batmu<span style="display: none;">.nosp@m.</span>nkh@<span style="display: none;">.nosp@m.</span>jinr.<span style="display: none;">.nosp@m.</span>ru</a>, <a href="#" onclick="location.href='mai'+'lto:'+'dem'+'@j'+'inr'+'.r'+'u'; return false;">dem@j<span style="display: none;">.nosp@m.</span>inr.<span style="display: none;">.nosp@m.</span>ru</a> <br  />
 Paper: O.V. Belov, M. Batmunkh, S. Incerti, O. Lkhagva. Radiation damage to <br  />
neuronal cells: Simulating the energy deposition and water radiolysis <br  />
in a small neural network. Physica Medica. 2016. 32. 1510-1520. <br  />
 </dd></dl>
<h1><a class="anchor" id="neuron_s1"></a>
INTRODUCTION</h1>
<p><br  />
</p>
<p>The NEURON example allows for the modelling of neuron cell irradiation, including physical, physico-chemical and chemical processes (eg. production of oxidative radical species in the vicinity of neurons). It uses realistic geometrical models of neurons generated from a standardized SWC file representing neuron morphology.</p>
<p>A typical neuron cell is composed of a cell body (soma), a single axon, a dendritic tree, and thousands of dendritic spines. In the example, individual compartments of a neuron cell are simulated by spherical and cylindrical voxels. The soma is represented by combination of several spheres, while the dendritic tree is described with combinations of cylinders. Each voxel is represented as interconnection of two tracing points of the neuron model.</p>
<p>A standardized neuromorphometric format (SWC) is an output file representing individual neuron morphology generated by digitally tracing tools based on 3D confocal microscopy images. In the SWC file, different numerical markers (e.g. from 1 to 6) describe different types of tracing points: <br  />
</p><ul>
<li>1 - soma</li>
<li>2 - axon</li>
<li>3 - apical dendrite</li>
<li>4 - basal dendrite</li>
<li>5+ - custom (5 – spines, 6 – terminals, etc.). Details are available in the <a class="el" href="../../dd/d2b/classNeuronLoadDataFile.html">NeuronLoadDataFile</a> class.</li>
</ul>
<p>In order to simulate a neural network, user can create his own file containing a combination of several individual neurons (see NeuralNETWORK.dat sample file describing a network of 10 pyramidal neurons).</p>
<p>Geant4-DNA models are activated in the neuron model, which is declared as a <a class="el" href="../../d1/d35/classG4Region.html">G4Region</a>. Geant4 condensed EM models are used outside the neuron structure.</p>
<p>The example package contains:</p><ul>
<li>source files (src, include, <a class="el" href="../../d1/de3/neuron_8cc.html" title="Implementation of the neuron example.">neuron.cc</a>)</li>
<li>README</li>
<li>.in, plotDend.C and visualization macro files</li>
<li>GranuleCell-Nr2.CNG.swc (Sample file describing a single granule neuron is loaded by default)</li>
<li>NeuralNETWORK.dat (Sample file describing a network of 10 pyramidal neurons)</li>
</ul>
<p>To run the example: see <a class="el" href="../../d5/db6/Exampleneuron.html#neuron_s5">HOW TO RUN THE EXAMPLE</a> of this README To simulation output: see <a class="el" href="../../d5/db6/Exampleneuron.html#neuron_s6">SIMULATION OUTPUT AND RESULT ANALYSIS</a> of this README</p>
<p>The code can be compiled with cmake. It works in MT mode.</p>
<h1><a class="anchor" id="neuron_s2"></a>
GEOMETRY SET-UP</h1>
<p>The geometry is cube (World) made of galactic material. Before computation, user loads a standardized SWC file of a neuron and generates a bounding volume and a homogeneous spherical medium of liquid water. Dimensions of the target volume are automatically extrapolated using SWC file describing 3D coordinates of a neuron. The homogeneous medium contains volumes of neuronal cell and a bounding slice. The side cube (World) is again represented as overall dimensions of neuronal cell that is equal to the diameter of the homogeneous medium.</p>
<p>The construction of whole geometry of neuron morphology is set in the <a class="el" href="../../dc/d5b/classDetectorConstruction.html" title="Simple detector construction with a box volume placed in a world.">DetectorConstruction</a> class.</p>
<p>User can choose between single-neuron simulation and modelling a neural network. Single-neuron simulation is set by default. To switch simulation to neural network, the following command should be used: </p><blockquote class="doxtable">
<p>./neuron -network FileName.dat </p>
</blockquote>
<h1><a class="anchor" id="neuron_s3"></a>
EVENT: THE PRIMARY GENERATOR</h1>
<p>The primary kinematic consists of a single particle starting at the random positions on the sphere surface. Then, the particle beam is directed towards the bounding slice volume, and traverses the individual neurons (default option). The type of the particle and its energy are set in the <a class="el" href="../../d7/d27/classPrimaryGeneratorAction.html" title="The primary generator action class with particle gun.">PrimaryGeneratorAction</a> class, and can be changed via the G4 build-in commands of <a class="el" href="../../dc/ded/classG4ParticleGun.html">G4ParticleGun</a> class. <br  />
 We included the following options for particle directions:</p>
<p>a) <a class="el" href="../../de/d20/classParticles.html">Particles</a> are directed to "square" on the XY plane of bounding slice (or YZ, XZ) </p><blockquote class="doxtable">
<p>./neuron -mac myMacro.mac -sXY </p>
</blockquote>
<p>b) <a class="el" href="../../de/d20/classParticles.html">Particles</a> are directed to "disk" on the XY plane of bounding slice (or YZ, XZ) </p><blockquote class="doxtable">
<p>./neuron -mac myMacro.mac -dXY </p>
</blockquote>
<p>c) <a class="el" href="../../de/d20/classParticles.html">Particles</a> are directed towards the bounding slice (default option) </p><blockquote class="doxtable">
<p>./neuron -mac myMacro.mac </p>
</blockquote>
<h1><a class="anchor" id="neuron_s4"></a>
PHYSICS</h1>
<p>The following options of physical and chemical processes are included: Default Livermore physics </p><blockquote class="doxtable">
<p>./neuron -mac myMacro.mac </p>
</blockquote>
<p>a) Livermore + DNAphysics with extended Rudd ionisation model. </p><blockquote class="doxtable">
<p>./neuron -mac myMacro.mac -dnaliv </p>
</blockquote>
<p>b) Livermore + DNAPhysics + DNAChemistry </p><blockquote class="doxtable">
<p>./neuron -mac myMacro.mac -dnachemON </p>
</blockquote>
<p>c) Combination of DNA- and Livermore- physics with hadronic physics. </p><blockquote class="doxtable">
<p>./neuron -mac myMacro.mac -dnahad </p>
</blockquote>
<p>NOTE, that it requires more memory or computing resources when chemistry is ON (b) and also long computational time when dnaphysics activated. Conversely, it can works faster when default.</p>
<p>Look at the src/PhyscisList.cc files.</p>
<h1><a class="anchor" id="neuron_s5"></a>
HOW TO RUN THE EXAMPLE</h1>
<p><br  />
</p>
<p>To get help, run:</p>
<blockquote class="doxtable">
<p>./neuron -h </p>
</blockquote>
<p>In visualization and interactive mode, run: </p><blockquote class="doxtable">
<p>./neuron -gui </p>
</blockquote>
<p>( OGL used by default)</p>
<p>or you may use your own visualization driver, for instance: </p><blockquote class="doxtable">
<p>./neuron -vis "DAWNFILE" </p>
</blockquote>
<p>"GranuleCell-Nr2.CNG.swc" is the default file and it should be placed into same directory as the executable. You can download it here: <a href="http://neuromorpho.org/neuron_info.jsp?neuron_name=GranuleCell-Nr2">http://neuromorpho.org/neuron_info.jsp?neuron_name=GranuleCell-Nr2</a> You can change neuron`s file name using the following command:</p>
<blockquote class="doxtable">
<p>./neuron -gui -swc newFileName.swc </p>
</blockquote>
<p>In batch mode , run:</p>
<blockquote class="doxtable">
<p>./neuron(.exe) [-mac neuron.in] [-mt numberofThreads] ./neuron -mac ../neuron.in -mt 3 &gt; neuron.out </p>
</blockquote>
<p>To get visualization, make sure to uncomment the #/control/execute vis.mac line in the macro. User can start a visualization of the chemical track evolution in time and space using SetEndTime (default-10 ps) and SetVerbose setting in src/ActionInitialization.cc file.</p>
<h1><a class="anchor" id="neuron_s6"></a>
SIMULATION OUTPUT AND RESULT ANALYSIS</h1>
<p><br  />
</p>
<p>The simulation outputs appears in terminal display.</p><ul>
<li>the energy deposit in the bounding slice and each structure of neuron (in kiloelectronVolt)</li>
<li>the scored energy deposit within hitting compartment of neuron structure (in kiloelectronVolt)</li>
<li>the number of particles inside and outside neuron</li>
<li>the number of radiolytic species inside neuron when chemistry is activated</li>
</ul>
<p>The main output results are stored in OutputPerEvent.out file, containing for each event. Dend3DEdep.out, Axon3DEdep.out and Soma3DEdep.out files for given dose:</p><ul>
<li>the position (x, y, z in micrometre) of compartments traversed by particle track.</li>
<li>the Axon and Dendrite (basal and apical) distance of compartments from Soma (in micrometre).</li>
<li>the energy deposition in compartments (in kiloelectronVolt).</li>
<li>the dose deposition in compartments (in Gray).</li>
</ul>
<p>This file can be easily analysed using for example the provided ROOT macro file plotDend.C; to do so:</p><ul>
<li>be sure to have ROOT installed on your machine</li>
<li>be sure to be in the neuron directory</li>
<li>launch ROOT by typing root</li>
<li>under your ROOT session, type in : .X plotDend.C to execute the macro file</li>
<li>alternatively you can type directly under your session : root plotDend.C</li>
</ul>
<hr  />
<p>If you have any questions or wish to notify of updates and/or modification please contact: <a href="#" onclick="location.href='mai'+'lto:'+'bat'+'mu'+'nkh'+'@j'+'inr'+'.r'+'u'; return false;">batmu<span style="display: none;">.nosp@m.</span>nkh@<span style="display: none;">.nosp@m.</span>jinr.<span style="display: none;">.nosp@m.</span>ru</a>, <a href="#" onclick="location.href='mai'+'lto:'+'dem'+'@j'+'inr'+'.r'+'u'; return false;">dem@j<span style="display: none;">.nosp@m.</span>inr.<span style="display: none;">.nosp@m.</span>ru</a> <br  />
</p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
