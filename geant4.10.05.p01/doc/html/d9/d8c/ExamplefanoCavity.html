<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example fanoCavity</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example fanoCavity </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This program computes the dose deposited in an ionization chamber by a monoenergetic photon beam. The geometry of the chamber satisfies the conditions of charged particle equilibrium. Hence, under idealized conditions, the ratio of the dose deposited over the beam energy fluence must be equal to the mass_energy_transfer coefficient of the wall material.</p>
<p>E.Poon and al, Phys. Med. Biol. 50 (2005) 681 <br  />
 I.Kawrakow, Med. Phys. 27-3 (2000) 499 <br  />
 </p>
<h1><a class="anchor" id="ExamplefanoCavity_s1"></a>
GEOMETRY</h1>
<p>The chamber is modelized as a cylinder with a cavity in it.</p>
<p>6 parameters define the geometry :</p><ul>
<li>the material of the wall of the chamber</li>
<li>the radius of the chamber and the thickness of the wall</li>
<li>the material of the cavity</li>
<li>the radius and the thickness of the cavity</li>
</ul>
<p>Wall and cavity must be made of the same material, but with different density</p>
<p>All above parameters can be redifined via the UI commands built in <a class="el" href="../../d6/d1f/classDetectorMessenger.html" title="Messenger class that defines commands for DetectorConstruction.">DetectorMessenger</a> class </p><pre>
                    -----------------
                    |               |
                    | wall          |
                    |     -----     |
                    |     |   |     |
                    |     | &lt;-+-----+--- cavity
         ------&gt;    |     |   |     |
         ------&gt;    |     |   |     |
   beam     -------------------------------- cylinder axis
         ------&gt;    |     |   |     |
         ------&gt;    |     |   |     |
                    |     |   |     |
                    |     |   |     |
                    |     -----     |
                    |               |
                    |               |
                    -----------------</pre><pre></pre><h1><a class="anchor" id="ExamplefanoCavity_s2"></a>
BEAM</h1>
<p>Monoenergetic incident photon beam is uniformly distribued, perpendicular to the flat end of the chamber. The beam radius can be controled with an UI command built in <a class="el" href="../../d2/df6/classPrimaryGeneratorMessenger.html">PrimaryGeneratorMessenger</a>; the default is full wall chamber radius.</p>
<p>Beam regeneration : after each Compton interaction, the scattered photon is reset to its initial state, energy and direction. Consequently, interaction sites are uniformly distribued within the wall material.</p>
<p>This modification must be done in the ParticleChange of the final state of the Compton scattering interaction. Therefore, a specific model (<a class="el" href="../../d0/d6b/classMyKleinNishinaCompton.html">MyKleinNishinaCompton</a>) is assigned to the ComptonScattering process in <a class="el" href="../../d2/daa/classPhysicsList.html">PhysicsList</a>. <a class="el" href="../../d0/d6b/classMyKleinNishinaCompton.html">MyKleinNishinaCompton</a> inherites from <a class="el" href="../../db/d54/classG4KleinNishinaCompton.html">G4KleinNishinaCompton</a>; only the function SampleSecondaries() is overwritten.</p>
<h1><a class="anchor" id="ExamplefanoCavity_s3"></a>
PURPOSE OF THE PROGRAM</h1>
<p>The program computes the dose deposited in the cavity and the ratio Dose/Beam_energy_fluence. This ratio is compared to the mass_energy_transfer coefficient of the wall material.</p>
<p>The mass_energy_transfer coefficient needs :</p><ul>
<li>the photon total cross section, which is read from the PhysicsTables by <a class="el" href="../../de/dc4/classG4EmCalculator.html">G4EmCalculator</a> (see EndOfRunAction).</li>
<li>the average kinetic energy of charged secondaries generated in the wall during the run.</li>
</ul>
<p>The program needs high statistic to reach precision on the computed dose. The UI command /testem/event/printModulo allows to survey the convergence of the kineticEnergy and dose calculations.</p>
<p>In addition, to increase the program efficiency, the secondary particles which have no chance to reach the cavity are immediately killed (see StackinAction). This feature can be switched off by an UI command (see <a class="el" href="../../d1/ddf/classStackingMessenger.html">StackingMessenger</a>).</p>
<p>The simplest way to study the effect of e- tracking parameters on dose deposition is to use the command /testem/stepMax.</p>
<h1><a class="anchor" id="ExamplefanoCavity_s4"></a>
PHYSICS</h1>
<p>The physics lists contains the standard electromagnetic processes, with few modifications listed here.</p>
<ul>
<li>Compton scattering : as explained above, the final state is modified in <a class="el" href="../../d0/d6b/classMyKleinNishinaCompton.html">MyKleinNishinaCompton</a> class. <br  />
<br  />
 In order to make the program more efficient, one can increase the Compton cross section via the function SetCSFactor(factor) and its associated UI command. Default is factor=1000.</li>
<li>Bremsstrahlung : Fano conditions imply no energy transfer via bremsstrahlung radiation. Therefore this process is not registered in the physics list. However, it is always possible to include it. See <a class="el" href="../../d7/d78/classPhysListEmStandard.html">PhysListEmStandard</a> class.</li>
<li>Ionisation : In order to have same stopping power in wall and cavity, one must cancel the density correction term in the dedx formula. This is done in a specific MollerBhabha model (<a class="el" href="../../d3/d54/classMyMollerBhabhaModel.html">MyMollerBhabhaModel</a>) which inherites from <a class="el" href="../../d5/dda/classG4MollerBhabhaModel.html">G4MollerBhabhaModel</a>. <br  />
<br  />
 To prevent explicit generation of delta-rays, the default production threshold (i.e. cut) is set to 10 km (CSDA condition). <br  />
<br  />
 The finalRange of the step function is set to 10 um, which more on less correspond to a tracking cut in water of about 20 keV. See emOptions. Once again, the above parameters can be controled via UI commands.</li>
<li>Multiple scattering : is switched in single Coulomb scattering mode near boundaries. This is selected via EM options in <a class="el" href="../../d2/daa/classPhysicsList.html">PhysicsList</a>, and can be controled with UI commands.</li>
<li>All PhysicsTables are built with 100 bins per decade. <br  />
</li>
</ul>
<h1><a class="anchor" id="ExamplefanoCavity_s5"></a>
HISTOGRAMS</h1>
<p>fanoCavity has several predefined 1D histograms :</p><ul>
<li>1 : emission point of e+-</li>
<li>2 : energy spectrum of e+-</li>
<li>3 : theta distribution of e+-</li>
<li>4 : emission point of e+- hitting cavity</li>
<li>5 : energy spectrum of e+- when entering in cavity</li>
<li>6 : theta distribution of e+- before enter in cavity</li>
<li>7 : theta distribution of e+- at first step in cavity <br  />
</li>
<li>8 : track segment of e+- in cavity</li>
<li>9 : step size of e+- in wall</li>
<li>10 : step size of e+- in cavity</li>
<li>11 : energy deposit in cavity per track <br  />
</li>
</ul>
<p>The histograms are managed by G4AnalysisManager class and its messenger. The histos can be individually activated with the command : </p><pre class="fragment">/analysis/h1/set id nbBins  valMin valMax unit 
</pre><p> where unit is the desired unit for the histo (MeV or keV, deg or mrad, etc..)</p>
<p>One can control the name of the histograms file with the command: </p><pre class="fragment">/analysis/setFileName  name  (default fanoCavity)
</pre><p>It is possible to choose the format of the histogram file : root(default), xml, hbook. See HistoManager.hh</p>
<p>It is also possible to print selected histograms on an ascii file: </p><pre class="fragment">/analysis/h1/setAscii id
</pre><p> All selected histos will be written on a file name.ascii (default fanocavity)</p>
<h1><a class="anchor" id="ExamplefanoCavity_s6"></a>
HOW TO START ?</h1>
<ul>
<li>Execute fanoCavity in 'batch' mode from macro files <pre class="fragment">% fanoCavity   run01.mac
</pre></li>
<li>Execute fanoCavity in 'interactive mode' with visualization <pre class="fragment">% fanoCavity
....
Idle&gt; type your commands
....
Idle&gt; exit
</pre> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
