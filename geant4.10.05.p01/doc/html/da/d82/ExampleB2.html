<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example B2</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example B2 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example simulates a simplified fixed target experiment.</p>
<h1><a class="anchor" id="B2_s1"></a>
GEOMETRY DEFINITION</h1>
<p>The setup consists of a target followed by six chambers of increasing transverse size at defined instances from the target. These chambers are located in a region called the Tracker region. Their shape are cylinders, constructed as simple cylinders (in <a class="el" href="../../db/dff/classB2aDetectorConstruction.html" title="Detector construction class to define materials, geometry and global uniform magnetic field.">B2aDetectorConstruction</a>) and as parametrised volumes (in <a class="el" href="../../de/d1d/classB2bDetectorConstruction.html" title="Detector construction class to define materials, geometry and global uniform magnetic field.">B2bDetectorConstruction</a>), see also <a class="el" href="../../d1/d85/classB2bChamberParameterisation.html" title="A parameterisation that describes a series of boxes along Z.">B2bChamberParameterisation</a> class.</p>
<p>In addition, a global, uniform, and transverse magnetic field can be applied using <a class="el" href="../../d9/d64/classG4GlobalMagFieldMessenger.html">G4GlobalMagFieldMessenger</a>, instantiated in <a class="el" href="../../db/dff/classB2aDetectorConstruction.html#aeab7a62b90b3c3941ee524696cd11cbf">B2aDetectorConstruction::ConstructSDandField</a> with a non zero field value, or via interactive commands. For example: </p><pre class="fragment">/globalField/setValue 0.2 0 0 tesla
</pre><p> An instance of the <a class="el" href="../../d3/d52/classB2TrackerSD.html" title="B2Tracker sensitive detector class.">B2TrackerSD</a> class is created and associated with each logical chamber volume (in B2a) and with the one <a class="el" href="../../da/dc4/classG4LogicalVolume.html">G4LogicalVolume</a> associated with <a class="el" href="../../de/ded/classG4PVParameterised.html">G4PVParameterised</a> (in B2b).</p>
<p>One can change the materials of the target and the chambers interactively via the commands defined in <a class="el" href="../../df/de6/classB2aDetectorMessenger.html" title="Messenger class that defines commands for B2aDetectorConstruction.">B2aDetectorMessenger</a> (or <a class="el" href="../../d4/d01/classB2bDetectorMessenger.html" title="Messenger class that defines commands for B2bDetectorConstruction.">B2bDetectorMessenger</a>). For example: </p><pre class="fragment">/B2/det/setTargetMaterial G4_WATER
/B2/det/setChamberMaterial G4_Ar
</pre><h1><a class="anchor" id="B2_s2"></a>
PHYSICS LIST</h1>
<p>The particle's type and the physic processes which will be available in this example are set in the FTFP_BERT physics list. This physics list requires data files for electromagnetic and hadronic processes. See more on installation of the datasets in <a href="http://geant4.web.cern.ch/geant4/UserDocumentation/UsersGuides/InstallationGuide/html/ch03s03.html">Geant4 Installation Guide, Chapter 3.3: Note On Geant4 Datasets </a>. The following datasets: G4LEDATA, G4LEVELGAMMADATA, G4SAIDXSDATA and G4ENSDFSTATEDATA are mandatory for this example.</p>
<p>In addition, the build-in interactive command: </p><pre class="fragment">/process/(in)activate processName
</pre><p> allows the user to activate/inactivate the processes one by one.</p>
<h1><a class="anchor" id="B2_s3"></a>
ACTION INITALIZATION</h1>
<p>A newly introduced class, <a class="el" href="../../d8/ddd/classB2ActionInitialization.html" title="Action initialization class.">B2ActionInitialization</a>, instantiates and registers to Geant4 kernel all user action classes.</p>
<p>While in sequential mode the action classes are instatiated just once, via invoking the method: <a class="el" href="../../d8/ddd/classB2ActionInitialization.html#a3360f8d018a5dc5d613b034894823eae">B2ActionInitialization::Build()</a> in multi-threading mode the same method is invoked for each thread worker and so all user action classes are defined thread-local.</p>
<p>A run action class is instantiated both thread-local and global that's why its instance is created also in the method <a class="el" href="../../d8/ddd/classB2ActionInitialization.html#a701f0f4058bcc1c416d99c2b99884d6e">B2ActionInitialization::BuildForMaster()</a> which is invoked only in multi-threading mode.</p>
<h1><a class="anchor" id="B2_s4"></a>
PRIMARY GENERATOR</h1>
<p>The primary generator action class employs the <a class="el" href="../../dc/ded/classG4ParticleGun.html">G4ParticleGun</a>. The primary kinematics consists of a single particle which hits the target perpendicular to the entrance face. The type of the particle and its energy can be changed via the G4 built-in commands of the <a class="el" href="../../dc/ded/classG4ParticleGun.html">G4ParticleGun</a> class.</p>
<h1><a class="anchor" id="B2_s5"></a>
RUNS and EVENTS</h1>
<p>A run is a set of events.</p>
<p>The user has control:</p><ul>
<li>at Begin and End of each run (class <a class="el" href="../../d8/d69/classB2RunAction.html" title="Run action class.">B2RunAction</a>)</li>
<li>at Begin and End of each event (class <a class="el" href="../../d7/d97/classB2EventAction.html" title="Event action class.">B2EventAction</a>)</li>
<li>at Begin and End of each track (class <a class="el" href="../../d3/df4/classTrackingAction.html">TrackingAction</a>, not used here)</li>
<li>at End of each step (class <a class="el" href="../../d8/db9/classSteppingAction.html">SteppingAction</a>, not used here)</li>
</ul>
<p>The event number is written to the log file every requested number of events in <a class="el" href="../../d7/d97/classB2EventAction.html#a3690cfacda75bf4247607106d7b4c506">B2EventAction::BeginOfEventAction()</a> and <a class="el" href="../../d7/d97/classB2EventAction.html#ac26728206a09ba5b9902528fbc33075d">B2EventAction::EndOfEventAction()</a>. Moreover, for the first 100 events and every 100 events thereafter information about the number of stored trajectories in the event is printed as well as the number of hits stored in the <a class="el" href="../../dc/d91/classG4VHitsCollection.html">G4VHitsCollection</a>.</p>
<p>The run number is printed at <a class="el" href="../../d8/d69/classB2RunAction.html#a5c135769b56fc277b39d2db067045018">B2RunAction::BeginOfRunAction()</a>, where the <a class="el" href="../../d4/daa/classG4RunManager.html">G4RunManager</a> is also informed how to SetRandomNumberStore for storing initial random number seeds per run or per event. <br  />
</p>
<h1><a class="anchor" id="B2_s6"></a>
USER LIMITS</h1>
<p>This example also illustrates how to introduce tracking constraints like maximum step length, minimum kinetic energy etc. via the <a class="el" href="../../d9/d11/classG4UserLimits.html">G4UserLimits</a> class and associated <a class="el" href="../../d2/d9f/classG4StepLimiter.html">G4StepLimiter</a> and <a class="el" href="../../d3/dd8/classG4UserSpecialCuts.html">G4UserSpecialCuts</a> processes. <br  />
 See <a class="el" href="../../db/dff/classB2aDetectorConstruction.html" title="Detector construction class to define materials, geometry and global uniform magnetic field.">B2aDetectorConstruction</a> (or <a class="el" href="../../de/d1d/classB2bDetectorConstruction.html" title="Detector construction class to define materials, geometry and global uniform magnetic field.">B2bDetectorConstruction</a>).</p>
<p>The maximum step limit in the tracker region can be set by the interactive command (see <a class="el" href="../../df/de6/classB2aDetectorMessenger.html" title="Messenger class that defines commands for B2aDetectorConstruction.">B2aDetectorMessenger</a>, <a class="el" href="../../d4/d01/classB2bDetectorMessenger.html" title="Messenger class that defines commands for B2bDetectorConstruction.">B2bDetectorMessenger</a> classes). For example:</p>
<pre class="fragment">/B2/det/stepMax 1.0 mm
</pre><h1><a class="anchor" id="B2_s7"></a>
DETECTOR RESPONSE</h1>
<p>A HIT is a step per step record of all the information needed to simulate and analyse the detector response.</p>
<p>In this example the Tracker chambers are considered to be the detector. Therefore, the chambers are declared 'sensitive detectors' (SD) in the <a class="el" href="../../db/dff/classB2aDetectorConstruction.html" title="Detector construction class to define materials, geometry and global uniform magnetic field.">B2aDetectorConstruction</a> (or <a class="el" href="../../de/d1d/classB2bDetectorConstruction.html" title="Detector construction class to define materials, geometry and global uniform magnetic field.">B2bDetectorConstruction</a>) class. They are associated with an instance of the <a class="el" href="../../d3/d52/classB2TrackerSD.html" title="B2Tracker sensitive detector class.">B2TrackerSD</a> class.</p>
<p>Then, a Hit is defined as a set of 4 informations per step, inside the chambers, namely:</p><ul>
<li>the track identifier (an integer),</li>
<li>the chamber number,</li>
<li>the total energy deposit in this step, and</li>
<li>the position of the energy deposit.</li>
</ul>
<p>A given hit is an instance of the class <a class="el" href="../../db/d9f/classB2TrackerHit.html" title="Tracker hit class.">B2TrackerHit</a> which is created during the tracking of a particle, step by step, in the method <a class="el" href="../../d3/d52/classB2TrackerSD.html#a2abdbcd10b1224c103ffc2976cf4a091">B2TrackerSD::ProcessHits()</a>. This hit is inserted in a HitsCollection.</p>
<p>The HitsCollection is printed at the end of each event (via the method <a class="el" href="../../d3/d52/classB2TrackerSD.html#aa6aaa84ce43a518dcbd61791239f2060">B2TrackerSD::EndOfEvent()</a>), under the control of the command: </p><pre class="fragment">/hits/verbose 2
</pre><hr  />
<p>The following paragraphs are common to all basic examples</p>
<h1><a class="anchor" id="B2_A"></a>
VISUALISATION</h1>
<p>The visualization manager is set via the <a class="el" href="../../df/d51/classG4VisExecutive.html">G4VisExecutive</a> class in the main () function in <a class="el" href="../../dd/d04/exampleB2a_8cc.html" title="Main program of the B2a example.">exampleB2a.cc</a> (or exampleB2b.cc). <br  />
 The initialisation of the drawing is done via a set of /vis/ commands in the macro vis.mac. This macro is automatically read from the main function when the example is used in interactive running mode.</p>
<p>By default, vis.mac opens an OpenGL viewer (/vis/open OGL). The user can change the initial viewer by commenting out this line and instead uncommenting one of the other /vis/open statements, such as HepRepFile or DAWNFILE (which produce files that can be viewed with the HepRApp and DAWN viewers, respectively). Note that one can always open new viewers at any time from the command line. For example, if you already have a view in, say, an OpenGL window with a name "viewer-0", then </p><pre class="fragment">/vis/open DAWNFILE
</pre><p> then to get the same view </p><pre class="fragment">/vis/viewer/copyView viewer-0
</pre><p> or to get the same view <em>plus</em> scene-modifications </p><pre class="fragment">/vis/viewer/set/all viewer-0
</pre><p> then to see the result </p><pre class="fragment">/vis/viewer/flush
</pre><p>The DAWNFILE, HepRepFile drivers are always available (since they require no external libraries), but the OGL driver requires that the Geant4 libraries have been built with the OpenGL option.</p>
<p>For more information on visualization, including information on how to install and run DAWN, OpenGL and HepRApp, see the visualization tutorials, for example,<br  />
</p><ul>
<li><a href="http://geant4.slac.stanford.edu/Presentations/vis/G4OpenGLTutorial/G4OpenGLTutorial.html">OpenGL Tutorial </a></li>
<li><a href="http://geant4.slac.stanford.edu/Presentations/vis/G4DAWNTutorial/G4DAWNTutorial.html">DAWN Tutorial </a></li>
<li><a href="http://geant4.slac.stanford.edu/Presentations/vis/G4HepRAppTutorial/G4HepRAppTutorial.html">HepRApp Tutorial </a></li>
</ul>
<p>The tracks are automatically drawn at the end of each event, accumulated for all events and erased at the beginning of the next run.</p>
<h1><a class="anchor" id="B2_B"></a>
USER INTERFACES</h1>
<p>The user command interface is set via the <a class="el" href="../../d1/d6d/classG4UIExecutive.html">G4UIExecutive</a> class in the main () function in <a class="el" href="../../dd/d04/exampleB2a_8cc.html" title="Main program of the B2a example.">exampleB2a.cc</a> The selection of the user command interface is then done automatically according to the Geant4 configuration or it can be done explicitly via the third argument of the <a class="el" href="../../d1/d6d/classG4UIExecutive.html">G4UIExecutive</a> constructor (see <a class="el" href="../../dd/d04/exampleB2a_8cc.html" title="Main program of the B2a example.">exampleB2a.cc</a>).</p>
<h1><a class="anchor" id="B2_C"></a>
HOW TO RUN</h1>
<ul>
<li>Execute exampleB2a in the 'interactive mode' with visualization <pre class="fragment">% exampleB2a
and type in the commands from run1.mac line by line:  
Idle&gt; /tracking/verbose 1 
Idle&gt; /run/beamOn 1
Idle&gt; ...
Idle&gt; exit
</pre> or <pre class="fragment">Idle&gt; /control/execute run1.mac
....
Idle&gt; exit
</pre></li>
<li>Execute exampleB2a in the 'batch' mode from macro files (without visualization) <pre class="fragment">% exampleB2a run2.mac
% exampleB2a exampleB2.in &gt; exampleB2.out
</pre> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
