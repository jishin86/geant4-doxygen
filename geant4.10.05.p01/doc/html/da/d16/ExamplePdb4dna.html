<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Geant4: Example pdb4dna</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Geant4
   &#160;<span id="projectnumber">10.05.p01</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example pdb4dna </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>E. Delage, Y. Perrot, Q.T. Pham <br  />
Laboratoire de Physique Corpusculaire de Clermont-Ferrand <br  />
CNRS/IN2P2 - Clermont University, France</dd></dl>
<p>This example is provided by the Geant4-DNA collaboration.</p>
<p>These processes and models are further described at: <a href="http://geant4-dna.org">http://geant4-dna.org</a></p>
<p>Any report or published results obtained using the Geant4-DNA software shall cite the following Geant4-DNA collaboration publications: Phys. Med. 31 (2015) 861-874 Med. Phys. 37 (2010) 4692-4708</p>
<h1><a class="anchor" id="pdb4dna_s1"></a>
A brief description</h1>
<p>The PDB4DNA example simulates energy deposits in a target volume generated from a PDB file representing <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> geometry. Position of energy deposits are used to compute strand breaks in the <a class="el" href="../../da/d19/namespaceDNA.html">DNA</a> geometry. Geant4-DNA processes are used.</p>
<p>The example package contains:</p><ul>
<li>source files (src, include, <a class="el" href="../../d9/d82/pdb4dna_8cc.html" title="Main program of the pdb4dna example.">pdb4dna.cc</a>)</li>
<li>README</li>
<li>.in, analysis.C and visualization macro files</li>
<li>1ZBB.pdb (di nucleosome is loaded by default)</li>
</ul>
<p>To run the example: see section 4 of this README To analyze output: see section 6 of this README</p>
<h1><a class="anchor" id="pdb4dna_s2"></a>
Set-up</h1>
<p>The geometry is a 1000 angstrom side cube (World) made of galactic material. Before a computation, user loads a PDB file and generates a target volume (the bounding volume) of liquid water, which dimensions are extrapolated from PDB file atom 3D coordinates.</p>
<h1><a class="anchor" id="pdb4dna_s3"></a>
Some main features</h1>
<pre class="fragment">| MESSENGER LIST |
-----------------------------------------------------------------
[1] Load a PDB file (The default atoms visualization is done by sphere that are parametrized with the van der Waals radius). \n
CPK coloring. \n
- Hydrogen(H) =&gt; white sphere,
- Carbon(C) =&gt; gray sphere,
- Oxygen(O) =&gt; red sphere,
- Nitrogen(N) =&gt; dark blue sphere,
- Sulfur(S) =&gt; yellow sphere,
- Phosphorus(P) =&gt; orange sphere,
- others/undefined =&gt; pink sphere. \n
/PDB4DNA/det/loadPDB filename.pdb
-----------------------------------------------------------------
[2] Build only a bounding volume for computation and draw it : \n
/PDB4DNA/det/buildBoundingV
-----------------------------------------------------------------
[3] Draw Atoms :  /PDB4DNA/det/drawAtoms \n
[4] Draw Nucleotids (sphere representing nucleotids) :  /PDB4DNA/det/drawNucleotides \n
[5] Draw Residues : /PDB4DNA/det/drawResidues \n
- Base =&gt; blue sphere,Sugar =&gt; yellow sphere,Phosphate =&gt; red sphere. \n
Spheres are linked by cylinders

[6] Draw Atoms with bounding volume : /PDB4DNA/det/drawAtomsWithBounding \n
[7] Draw Nucleotides with bounding volume : /PDB4DNA/det/drawNucleotidesWithBounding \n
[8] Draw Residues with bounding volume : /PDB4DNA/det/drawResiduesWithBounding \n
-----------------------------------------------------------------
[9] Set energy treshold to compute SSB : /PDB4DNA/event/setEnergyThres 8.22 eV (default value set to 8.22 eV) \n
[10] Set distance treshlod to compute DSB : /PDB4DNA/event/setDistanceThres 10    (default value set to 10) \n

Notes: \n
[1] is mandatory for visualization and simulation. \n
[2] is needed for simulation. \n
</pre><h1><a class="anchor" id="pdb4dna_s4"></a>
How to run the example.</h1>
<p>To get help, run:</p>
<blockquote class="doxtable">
<p>./pdb4dna(.exe) -h </p>
</blockquote>
<p>In interactive mode, run:</p>
<blockquote class="doxtable">
<p>./pdb4dna(.exe) -gui </p>
</blockquote>
<p>"1ZBB.pdb" is the default file and it should be placed into same directory as the executable. You can download it here: <br  />
<a href="http://www.rcsb.org/pdb/download/downloadFile.do?fileFormat=pdb&compression=NO&structureId=1ZBB">http://www.rcsb.org/pdb/download/downloadFile.do?fileFormat=pdb&amp;compression=NO&amp;structureId=1ZBB</a></p>
<p>In batch mode , run:</p>
<blockquote class="doxtable">
<p>./pdb4dna(.exe) [-mac pdb4dna.in] [-mt numberofThreads] <br  />
</p>
</blockquote>
<p>To get visualization, make sure to uncomment the #/control/execute vis.mac line in the macro.</p>
<h1><a class="anchor" id="pdb4dna_s5"></a>
The physics</h1>
<p>This example shows how to use the Geant4-DNA processes from constructor</p>
<p>Look at the PhyscisList.cc file.</p>
<h1><a class="anchor" id="pdb4dna_s6"></a>
Simulation output</h1>
<p>The output results consists in a pdb.root file, containing for each event: <br  />
</p><ul>
<li>the energy deposit in the bounding box (in electronVolt) <br  />
</li>
<li>the number of single strand break (SSB) <br  />
</li>
<li>the number of double strand break (DSB) <br  />
 This file can be easily analyzed using for example the provided ROOT macro file analysis.C; to do so : <br  />
 be sure to have ROOT installed on your machine <br  />
 be sure to be in the example directory <br  />
 launch ROOT by typing root <br  />
 under your ROOT session, type in : .X analysis.C to execute the macro file <br  />
 alternatively you can type directly under your session : root analysis.C <br  />
 </li>
</ul>
<h1><a class="anchor" id="pdb4dna_s7"></a>
Contacts</h1>
<p>If you have any questions or wish to notify of updates and/or modification please contact: <br  />
 E. Delage (geometry and visualization referee) at <a href="#" onclick="location.href='mai'+'lto:'+'del'+'ag'+'e@c'+'le'+'rmo'+'nt'+'.in'+'2p'+'3.f'+'r'; return false;">delag<span style="display: none;">.nosp@m.</span>e@cl<span style="display: none;">.nosp@m.</span>ermon<span style="display: none;">.nosp@m.</span>t.in<span style="display: none;">.nosp@m.</span>2p3.f<span style="display: none;">.nosp@m.</span>r</a> <br  />
Y. Perrot (physics and simulation referee) at <a href="#" onclick="location.href='mai'+'lto:'+'per'+'ro'+'t@c'+'le'+'rmo'+'nt'+'.in'+'2p'+'3.f'+'r'; return false;">perro<span style="display: none;">.nosp@m.</span>t@cl<span style="display: none;">.nosp@m.</span>ermon<span style="display: none;">.nosp@m.</span>t.in<span style="display: none;">.nosp@m.</span>2p3.f<span style="display: none;">.nosp@m.</span>r</a></p>
<p>-&mdash;&gt; Acknowledgments :</p>
<p>Jean Orloff (LPC, Clermont-Ferrand, France) for 3D rotation implementation, Michel Maire (G4AI) for /extended/geometry/transforms example, Laurent Garnier (LAL, Orsay, France) for Qt visualisation. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
